# model updates

The contracts were updated to a new major version and so we need to propagate some of the new features into the application's model. I want to make this change as minimal as possible, so what do we need to do?

One feature in this new release was multi pools. Multi-pools make it so that there is a new data structure `pools` that has pool data. We need to track this in the model.

The other major feature is the addition of a liquidity token. This liquidity token is the user's effective position, so it needs to be added to the model. This position will then replace the current "position" code.

The model current tracks reserves in the pool and assumes it to be the user's position, but now it will be liquidity token of the pool which has the controller match the user. Propagating these changes will allow us to fold a lot of raw reserve values, token stuff, and derived values into a single object that can be tracked better (pool info).

When pools are created they initialize global pool state. Position info is derived based on the liquidity tokens, so that would need to be tracked separately.

Since new liquidity tokens are created in `init`, we can fetch the original position creator from an event from the DFMM contract or from the token itself. That might be useful if a user only has a liquidity token?

I want to try to reduce the model as much as possible, which can happen since all of the pool stuff is encapsulated within its global state and liquidity token state.

We kind of need to index the token balance mapping and then just derive info as needed?

We could track the pool state and lp token balance state as it changes, and derive all needed info.

We also don't need to have "spot" fields if we have a series for the data, good suggestion from waylon. 