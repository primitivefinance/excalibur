(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[    102173,       2338]
NotebookOptionsPosition[     95417,       2237]
NotebookOutlinePosition[     96014,       2257]
CellTagsIndexPosition[     95971,       2254]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Gaussian", " ", "CDF"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"gaussianCDF", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"CDF", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"0", ",", " ", "1"}], "]"}], ",", " ", "x"}], "]"}]}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Gaussian", " ", "PPF"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"gaussianPPF", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Quantile", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"0", ",", " ", "1"}], "]"}], ",", " ", "x"}], 
     "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.9084674257813168`*^9, 3.908467481719372*^9}, {
  3.9084675216212587`*^9, 3.908467546038982*^9}, {3.90846757908879*^9, 
  3.908467614530884*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"c490899a-2f5d-40ab-a7d1-a5c9dca8c853"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["L", "X"], "[", 
    RowBox[{"x_", ",", "S_"}], "]"}], ":=", 
   FractionBox["x", 
    RowBox[{"1", "-", 
     RowBox[{"gaussianCDF", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox["S", "K"], "]"}], "\[Sigma]"], "+", 
       RowBox[{
        FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["L", "Y"], "[", 
    RowBox[{"y_", ",", "S_"}], "]"}], ":=", 
   FractionBox["y", 
    RowBox[{"K", "*", 
     RowBox[{"gaussianCDF", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox["S", "K"], "]"}], "\[Sigma]"], "-", 
       RowBox[{
        FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"y_", ",", "S_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "Y"], "[", 
     RowBox[{"y", ",", "S"}], "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"gaussianCDF", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"Log", "[", 
          FractionBox["S", "K"], "]"}], "\[Sigma]"], "+", 
        RowBox[{
         FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Y", "[", 
    RowBox[{"x_", ",", "S_"}], "]"}], ":=", 
   RowBox[{"K", "*", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{"x", ",", "S"}], "]"}], "*", 
    RowBox[{"gaussianCDF", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox["S", "K"], "]"}], "\[Sigma]"], "-", 
      RowBox[{
       FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["P", "X"], "[", 
    RowBox[{"x_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"K", "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"gaussianPPF", "[", 
        RowBox[{"1", "-", 
         FractionBox["x", "L"]}], "]"}], "*", "\[Sigma]"}], "-", 
      RowBox[{
       FractionBox["1", "2"], 
       SuperscriptBox["\[Sigma]", "2"]}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["P", "Y"], "[", 
    RowBox[{"y_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"K", "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"gaussianPPF", "[", 
        FractionBox["y", 
         RowBox[{"K", "*", "L"}]], "]"}], "*", "\[Sigma]"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       SuperscriptBox["\[Sigma]", "2"]}]}], "]"}]}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.908467621608725*^9, 3.908467735863633*^9}, {
  3.9089759722512827`*^9, 3.908975998886648*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"0e5528a2-b8c6-467a-844e-8c7716a97af3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Constants", " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]", ":=", "0.5"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"K", ":=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Gamma]", ":=", "0.997"}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.9084680371821203`*^9, 3.908468094956563*^9}, {
  3.908470349190227*^9, 3.90847035824724*^9}, {3.908470640467009*^9, 
  3.908470651083271*^9}, {3.908962321915421*^9, 3.908962322267576*^9}, {
  3.908962366415097*^9, 3.9089623671545897`*^9}, {3.908962417752561*^9, 
  3.9089624186920137`*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"38327a6c-a04f-4af4-877c-b294ae062156"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", "X", " ", "value"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["x", "0"], ":=", "1"}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Initial", " ", "price"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["S", "0"], ":=", "1"}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Amount", " ", "of", " ", "Y", " ", "for", " ", "this", " ", "price", " ",
      "and", " ", "X"}], " ", "*)"}], "\n", 
   RowBox[{
    SubscriptBox["y", "0"], ":=", 
    RowBox[{"Y", "[", 
     RowBox[{
      SubscriptBox["x", "0"], ",", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"(*", " ", "Liquidity", " ", "*)"}], "\n", 
   RowBox[{
    SubscriptBox["L", "0"], ":=", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{
      SubscriptBox["x", "0"], ",", 
      SubscriptBox["S", "0"]}], "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.908468373546104*^9, 3.9084685799434233`*^9}, {
  3.9084686112036858`*^9, 3.908468612883589*^9}, {3.908468683308464*^9, 
  3.908468734474468*^9}, {3.90846994004578*^9, 3.908469951539794*^9}, {
  3.90847000421662*^9, 3.908470006749341*^9}, {3.909022679810102*^9, 
  3.909022681399785*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"7d969c2b-e997-401d-b15b-a40e313196bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Quck", " ", "sanity", " ", "checks"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<This should print 1: \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "X"], "[", 
      RowBox[{
       SubscriptBox["x", "0"], ",", 
       SubscriptBox["L", "0"]}], "]"}]}], "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<This should print 1: \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "Y"], "[", 
      RowBox[{
       SubscriptBox["y", "0"], ",", 
       SubscriptBox["L", "0"]}], "]"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.908962773200364*^9, 3.908962811041506*^9}, {
  3.908976008296489*^9, 3.9089760811257973`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"8a8b8903-b1b9-4e57-ae98-7ba26b8f5c79"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"This should print 1: \"\>", "\[InvisibleSpace]", "1.`"}],
  SequenceForm["This should print 1: ", 1.],
  Editable->False]], "Print",
 CellChangeTimes->{3.908976082572167*^9, 3.909025668931364*^9, 
  3.9102698961915703`*^9, 3.910276555933729*^9},
 CellLabel->
  "During evaluation of \
In[224]:=",ExpressionUUID->"a60caa90-4666-4dee-9d46-48319958a213"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"This should print 1: \"\>", "\[InvisibleSpace]", "1.`"}],
  SequenceForm["This should print 1: ", 1.],
  Editable->False]], "Print",
 CellChangeTimes->{3.908976082572167*^9, 3.909025668931364*^9, 
  3.9102698961915703`*^9, 3.9102765559353523`*^9},
 CellLabel->
  "During evaluation of \
In[224]:=",ExpressionUUID->"441ff41f-2daa-44d6-99ff-8f260c700e20"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Arb", " ", "calculations"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"arbX", "[", 
      RowBox[{"p_", ",", "x_", ",", "L_"}], "]"}], ":=", 
     FractionBox[
      RowBox[{
       RowBox[{"L", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"gaussianCDF", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"Log", "[", 
              FractionBox["p", "K"], "]"}], "\[Sigma]"], "+", 
            RowBox[{
             FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], ")"}]}], "-", 
       "x"}], 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "-", "1"}], ")"}], "*", 
        FractionBox[
         RowBox[{"1", "-", 
          RowBox[{"gaussianCDF", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"Log", "[", 
              FractionBox["p", "K"], "]"}], "\[Sigma]"], "+", 
            RowBox[{
             FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], 
         RowBox[{"1", "-", 
          RowBox[{"gaussianCDF", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"Log", "[", 
              FractionBox[
               SubscriptBox["S", "0"], "K"], "]"}], "\[Sigma]"], "+", 
            RowBox[{
             FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]]}]}]]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"arbY", "[", 
      RowBox[{"p_", ",", "y_", ",", "L_"}], "]"}], ":=", 
     FractionBox[
      RowBox[{
       RowBox[{"K", "*", "L", "*", 
        RowBox[{"gaussianCDF", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"Log", "[", 
            FractionBox["p", "K"], "]"}], "\[Sigma]"], "-", 
          RowBox[{
           FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], "-", "y"}], 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "-", "1"}], ")"}], 
        FractionBox[
         RowBox[{"gaussianCDF", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["p", "K"], "]"}], "\[Sigma]"], "-", 
           RowBox[{
            FractionBox["1", "2"], "\[Sigma]"}]}], "]"}], 
         RowBox[{"gaussianCDF", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox[
              SubscriptBox["S", "0"], "K"], "]"}], "\[Sigma]"], "-", 
           RowBox[{
            FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]]}]}]]}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{{3.908469869746161*^9, 3.908469874456465*^9}, {
   3.908469966460216*^9, 3.9084699673930483`*^9}, {3.908470014741447*^9, 
   3.908470016059868*^9}, {3.9084710978099003`*^9, 3.9084711295094557`*^9}, 
   3.9084711698900547`*^9, {3.90847120602601*^9, 3.908471247223518*^9}, {
   3.908471281448723*^9, 3.908471367082285*^9}, {3.908472297530381*^9, 
   3.908472410924035*^9}, {3.908472525967081*^9, 3.9084725263795347`*^9}, {
   3.908472647857041*^9, 3.908472655134634*^9}, {3.908472698618392*^9, 
   3.9084728617947607`*^9}, {3.908962247915147*^9, 3.908962248388301*^9}, {
   3.908962905421812*^9, 3.9089629062637444`*^9}, {3.9089645920566*^9, 
   3.90896459533709*^9}, {3.908976692229253*^9, 3.908976695880341*^9}, {
   3.908976844868556*^9, 3.908976846911487*^9}, {3.908978192545518*^9, 
   3.908978253726102*^9}, {3.908978660030653*^9, 3.9089786769258137`*^9}, {
   3.908978827103158*^9, 3.9089788397352858`*^9}, {3.9089788752737007`*^9, 
   3.908978875659925*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"1efdbee4-dd4b-4b95-89ef-b8a05144a40f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Test", " ", "a", " ", "value", " ", "that", " ", "we", " ", "got", " ", 
    "from", " ", "above", " ", "here"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"newPriceX", ":=", "0.8"}], ";"}], "\n", 
   RowBox[{"tenderX", ":=", 
    RowBox[{"arbX", "[", 
     RowBox[{"newPriceX", ",", 
      SubscriptBox["x", "0"], ",", 
      SubscriptBox["L", "0"]}], "]"}]}], "\n", 
   RowBox[{
   "Print", "[", "\"\<We are tendering the following amount of X:\>\"", "]"}],
    "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\) = \>\"", ",", " ", 
     "tenderX"}], "]"}], "\n", 
   RowBox[{
   "Print", "[", 
    "\"\<After applying the fee, we will have the following X \
reinvested:\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Xx"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", "\[CapitalDelta]"}]}], 
    ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(X\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Xx"], "[", "tenderX", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Swap", " ", "in", " ", "X", " ", "with", " ", "fee", " ", "chosen", " ", 
     "above"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]_", "]"}], ":=", 
    " ", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", "Xx"], "[", "\[CapitalDelta]", "]"}], ",", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"This", " ", "can", " ", "be", " ", "simplified"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Delta]", "Yx"], "[", "\[CapitalDelta]_", "]"}], ":=", 
    RowBox[{"K", "*", 
     RowBox[{
      SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]", "]"}], "*", 
     RowBox[{"gaussianCDF", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox[
          SubscriptBox["S", "0"], "K"], "]"}], "\[Sigma]"], "-", 
       RowBox[{
        FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]}], "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective amount of Y reinvested is:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Yx"], "[", "tenderX", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective amount of liquidity reinvested is:\>\"", 
    "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Lx"], "[", "tenderX", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{
   "Print", "[", "\"\<The amount of Y the user will receive\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "Y"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"K", "*", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "0"], "+", 
         RowBox[{
          SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]", "]"}]}], 
        ")"}], "*", 
       RowBox[{"gaussianCDF", "[", 
        RowBox[{
         RowBox[{"-", "\[Sigma]"}], "-", 
         RowBox[{"gaussianPPF", "[", 
          FractionBox[
           RowBox[{
            SubscriptBox["x", "0"], "+", "\[CapitalDelta]"}], 
           RowBox[{
            SubscriptBox["L", "0"], "+", 
            RowBox[{
             SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]", "]"}]}]],
           "]"}]}], "]"}]}], "-", 
      SubscriptBox["y", "0"]}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\) = \>\"", ",", " ", 
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "Y"], "[", "tenderX", "]"}]}]}], "]"}],
    "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective price the user paid is then:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(P\), \(eff\)]\) = \>\"", ",", " ", 
     FractionBox[
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "Y"], "[", "tenderX", "]"}]}], 
      "tenderX"]}], "]"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"What", " ", "are", " ", "the", " ", "liquidities"}], " ", "*)"}],
    "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new L using new X reserve:\>\"", "]"}], 
   "\n", 
   RowBox[{
    SubscriptBox["L", "givenX"], ":=", " ", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "0"], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "Xx"], "[", "tenderX", "]"}]}], ",", " ", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(givenX\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "givenX"]}], "]"}], "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new L using new Y reserve:\>\"", "]"}], 
   "\n", 
   RowBox[{
    SubscriptBox["L", "givenY"], ":=", 
    RowBox[{
     SubscriptBox["L", "Y"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["y", "0"], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "Yx"], "[", "tenderX", "]"}]}], ",", " ", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(givenY\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "givenY"]}], "]"}], "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new price given the new X reserve:\>\"", 
    "]"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Now", " ", "what", " ", "is", " ", "the", " ", 
     RowBox[{"price", "?", " ", "Should"}], " ", "be", " ", "0.9"}], " ", 
    "*)"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<S = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "X"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "0"], "+", "tenderX"}], ",", 
       SubscriptBox["L", "givenX"]}], "]"}]}], "]"}], "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new price given the new Y reserve:\>\"", 
    "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<S = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "Y"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "0"], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "Y"], "[", "tenderX", "]"}]}], ",", 
       SubscriptBox["L", "givenY"]}], "]"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.9084686067941647`*^9, 3.908468677383553*^9}, {
   3.908468740698229*^9, 3.9084689324869547`*^9}, {3.908469407393499*^9, 
   3.90846948258585*^9}, {3.9084697453831453`*^9, 3.908469751400042*^9}, {
   3.90847002453519*^9, 3.908470095084703*^9}, {3.90847012516411*^9, 
   3.90847012730599*^9}, {3.908470389531291*^9, 3.9084706207048197`*^9}, {
   3.908470657120466*^9, 3.9084706819852057`*^9}, {3.908470713721982*^9, 
   3.9084707434513493`*^9}, {3.908470775377922*^9, 3.908470779431653*^9}, {
   3.908470827127829*^9, 3.908470836810878*^9}, {3.908471144978223*^9, 
   3.908471148613662*^9}, {3.908471342374304*^9, 3.908471396516526*^9}, {
   3.908471492879197*^9, 3.908471515719439*^9}, {3.908472220030443*^9, 
   3.9084722939922533`*^9}, {3.908472406536892*^9, 3.9084724386581182`*^9}, {
   3.908472792423646*^9, 3.908472793603929*^9}, {3.908962003290093*^9, 
   3.908962037676124*^9}, {3.908962097133566*^9, 3.908962173336836*^9}, {
   3.90896220971637*^9, 3.908962215271048*^9}, {3.908962268479413*^9, 
   3.90896229916632*^9}, 3.9089623337569313`*^9, {3.908962379639881*^9, 
   3.908962388938654*^9}, {3.9089624572707443`*^9, 3.9089624721040583`*^9}, {
   3.908962510704714*^9, 3.908962524338188*^9}, {3.908962555054682*^9, 
   3.90896256203594*^9}, {3.908962820059133*^9, 3.908962898754694*^9}, {
   3.9089629575319777`*^9, 3.90896307969725*^9}, {3.9089631418064203`*^9, 
   3.908963173466034*^9}, {3.908963258525576*^9, 3.9089633224402733`*^9}, {
   3.908963367994213*^9, 3.908963461202013*^9}, {3.908963609379298*^9, 
   3.908963933535779*^9}, {3.908964139664143*^9, 3.9089641709875937`*^9}, {
   3.90896426104887*^9, 3.908964413991126*^9}, 3.908964543677549*^9, 
   3.908964586086096*^9, {3.908976159020768*^9, 3.908976159227566*^9}, {
   3.908976470413172*^9, 3.908976481004795*^9}, {3.908976522067993*^9, 
   3.908976654910138*^9}, {3.908976734310645*^9, 3.908976786321085*^9}, {
   3.908976970992345*^9, 3.908977362278446*^9}, {3.908977545063843*^9, 
   3.908977618765689*^9}, {3.90897787977813*^9, 3.908977904800407*^9}, {
   3.9090235637726593`*^9, 3.9090235739352627`*^9}, 3.909025650712202*^9},
 CellLabel->
  "In[228]:=",ExpressionUUID->"e81539e0-9c8f-4cc0-9aed-23ff71ff5ce5"],

Cell[CellGroupData[{

Cell[BoxData["\<\"We are tendering the following amount of X:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"42e60caf-1a29-4bbe-b936-7100a60eb6b7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(X\\)]\\) = \
\"\>", "\[InvisibleSpace]", "0.4417696624099112`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\) = ", 0.4417696624099112],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558070898*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"8a1f079c-1436-4198-9b93-bf0ec32daa63"],

Cell[BoxData["\<\"After applying the fee, we will have the following X \
reinvested:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.91027655807239*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"50aba783-7415-40cd-839a-e6f6092faa46"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(X\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.001325308987229735`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(X\)]\) = ", 0.001325308987229735],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.9102765580737343`*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"32e6938a-d6c0-4bb8-9abe-f9c2a2ebd4fd"],

Cell[BoxData["\<\"The effective amount of Y reinvested is:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.9102765580749826`*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"7da6e04c-283e-469a-9a13-4960ecac2c82"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(Y\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.001325308987229735`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = ", 0.001325308987229735],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558075989*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"c019ccf2-a4d8-4e34-9fd6-193905ebbdfa"],

Cell[BoxData["\<\"The effective amount of liquidity reinvested is:\"\>"], \
"Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558076964*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"79ae7000-f01f-4cd1-877c-9d16759ce0d6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(L\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.003302591274295945`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = ", 0.003302591274295945],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.9102765580779047`*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"5c439259-9b7f-425b-8cd2-f5079d9d5bbf"],

Cell[BoxData["\<\"The amount of Y the user will receive\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558078883*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"9297b731-6079-4122-bdf6-fe1d3dca478e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(Y\\)]\\) = \
\"\>", "\[InvisibleSpace]", "0.3933451858828546`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\) = ", 0.3933451858828546],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.9102765580798273`*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"5f6ee580-1096-4d87-9ce4-e85bdc82f31c"],

Cell[BoxData["\<\"The effective price the user paid is then:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558080797*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"19832e1d-782c-4114-9910-f4591149a725"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(P\\), \\(eff\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.8903852377211807`"}],
  SequenceForm["\!\(\*SubscriptBox[\(P\), \(eff\)]\) = ", 0.8903852377211807],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.9102765580817213`*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"b92947c4-2e01-4c11-9c50-3081d132e224"],

Cell[BoxData["\<\"Computing the new L using new X reserve:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558082696*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"97b9ed97-f081-45b7-9818-0a70c3bf9fca"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(givenX\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "2.495243192385952`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(L\), \(givenX\)]\) = ", 2.495243192385952],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558083611*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"0a71fbdd-7a5b-4f20-aaad-8db2a2df4b0f"],

Cell[BoxData["\<\"Computing the new L using new Y reserve:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558084566*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"41087c6e-c587-49ce-8bae-1c9e2608c571"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(givenY\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "2.495243192385952`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(L\), \(givenY\)]\) = ", 2.495243192385952],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558085453*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"6e7b6991-4569-4d60-9646-04aa5ee7eb3e"],

Cell[BoxData["\<\"Computing the new price given the new X reserve:\"\>"], \
"Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558086343*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"b93a08b5-824b-4045-ba0b-d4b3ccbdae1d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", "0.8000000000000002`"}],
  SequenceForm["S = ", 0.8000000000000002],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558087187*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"ffe5903d-d10f-43f8-95f2-1fe909779e27"],

Cell[BoxData["\<\"Computing the new price given the new Y reserve:\"\>"], \
"Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558088023*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"618e91cd-4561-4876-821f-06af1b46a8b8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", "0.7999999999999999`"}],
  SequenceForm["S = ", 0.7999999999999999],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558088873*^9},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"4278d801-00b2-443d-b6f8-9d59e1172cc9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Test", " ", "a", " ", "value", " ", "that", " ", "we", " ", "got", " ", 
    "from", " ", "above", " ", "here"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"newPriceY", ":=", "1.1"}], ";"}], "\n", 
   RowBox[{"tenderY", ":=", 
    RowBox[{"arbY", "[", 
     RowBox[{"newPriceY", ",", 
      SubscriptBox["y", "0"], ",", 
      RowBox[{
       SubscriptBox["L", "Y"], "[", 
       RowBox[{
        SubscriptBox["y", "0"], ",", 
        SubscriptBox["S", "0"]}], "]"}]}], "]"}]}], "\n", 
   RowBox[{
   "Print", "[", "\"\<We are tendering the following amount of Y:\>\"", "]"}],
    "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\) = \>\"", ",", " ", 
     "tenderY"}], "]"}], "\n", 
   RowBox[{
   "Print", "[", 
    "\"\<After applying the fee, we will have the following X \
reinvested:\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Yy"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", "\[CapitalDelta]"}]}], 
    ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Yy"], "[", "tenderY", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Swap", " ", "in", " ", "X", " ", "with", " ", "fee", " ", "chosen", " ", 
     "above"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Delta]", "Ly"], "[", "\[CapitalDelta]_", "]"}], ":=", 
    " ", 
    RowBox[{
     SubscriptBox["L", "Y"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", "Y"], "[", "\[CapitalDelta]", "]"}], ",", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"This", " ", "can", " ", "be", " ", "simplified"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Delta]", "Xy"], "[", "\[CapitalDelta]_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Ly"], "[", "\[CapitalDelta]", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"gaussianCDF", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"Log", "[", 
           FractionBox[
            SubscriptBox["S", "0"], "K"], "]"}], "\[Sigma]"], "+", 
         RowBox[{
          FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], ")"}]}]}], "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective amount of Y reinvested is:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(x\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Xy"], "[", "tenderY", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective amount of liquidity reinvested is:\>\"", 
    "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Ly"], "[", "tenderY", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{
   "Print", "[", "\"\<The amount of X the user will receive\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "X"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "0"], "+", 
         RowBox[{
          SubscriptBox["L", "Y"], "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Delta]", "Y"], "[", "\[CapitalDelta]", "]"}], ",", 
           SubscriptBox["S", "0"]}], "]"}]}], ")"}], "*", 
       RowBox[{"gaussianCDF", "[", 
        RowBox[{
         RowBox[{"-", "\[Sigma]"}], "-", 
         RowBox[{"gaussianPPF", "[", 
          FractionBox[
           RowBox[{
            SubscriptBox["y", "0"], "+", "\[CapitalDelta]"}], 
           RowBox[{"K", "*", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["L", "0"], "+", 
              RowBox[{
               SubscriptBox["L", "Y"], "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Delta]", "Y"], "[", "\[CapitalDelta]", "]"}],
                 ",", 
                SubscriptBox["S", "0"]}], "]"}]}], ")"}]}]], "]"}]}], "]"}]}],
       "-", 
      SubscriptBox["x", "0"]}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\) = \>\"", ",", " ", 
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "X"], "[", "tenderY", "]"}]}]}], "]"}],
    "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective price the user paid is then:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(P\), \(eff\)]\) = \>\"", ",", " ", 
     FractionBox[
      RowBox[{"-", "tenderY"}], 
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "X"], "[", "tenderY", "]"}]]}], "]"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"What", " ", "are", " ", "the", " ", "liquidities"}], " ", "*)"}],
    "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new L using new X reserve:\>\"", "]"}], 
   "\n", 
   RowBox[{
    SubscriptBox["L", "givenX"], ":=", " ", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "0"], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "Xx"], "[", "tenderY", "]"}]}], ",", " ", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(givenX\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "givenX"]}], "]"}], "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new L using new Y reserve:\>\"", "]"}], 
   "\n", 
   RowBox[{
    SubscriptBox["L", "givenY"], ":=", 
    RowBox[{
     SubscriptBox["L", "Y"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["y", "0"], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "Yy"], "[", "tenderY", "]"}]}], ",", " ", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(givenY\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "givenY"]}], "]"}], "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new price given the new X reserve:\>\"", 
    "]"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Now", " ", "what", " ", "is", " ", "the", " ", 
     RowBox[{"price", "?", " ", "Should"}], " ", "be", " ", "0.9"}], " ", 
    "*)"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<S = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "X"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "0"], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "X"], "[", "tenderY", "]"}]}], ",", 
       SubscriptBox["L", "givenX"]}], "]"}]}], "]"}], "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new price given the new Y reserve:\>\"", 
    "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<S = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "Y"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "0"], "+", "tenderY"}], ",", 
       SubscriptBox["L", "givenY"]}], "]"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQraARnnBB7q3jupDYdBDtLj83F0Sf2hdSBaJTXsu0
guieXUumgmgzwymzQLQk4/25ILrovO4iEG3sYrUJrC5pxn8QLXArnekikN65
TJ4dRPcnmQiDaIdf141AtN6D52B6+rGnsSB6zZbTcSB6XbPiebC6Wf8ugehL
giJ3QLTrCe2HILrYuvs1iN48ff9HEG1u3vsNRBssZP8OoptM/vUcl3/raOSX
tAxEi631OQSi+doaD4Noh2nbz4Hoc5LHLoJoJkWuayD6T9jnGyDaJtey6QSQ
PnJpfweITkoz6QfROh7np4HoVK1rc0D0ApnaBSAaAHwNpQQ=
  "],
 CellLabel->
  "In[256]:=",ExpressionUUID->"9bf9bebe-962a-46aa-86cc-a308ddbc4fb0"],

Cell[CellGroupData[{

Cell[BoxData["\<\"We are tendering the following amount of Y:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"6f6fcc7c-6c65-4011-a67a-c0f19f30e480"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(Y\\)]\\) = \
\"\>", "\[InvisibleSpace]", "0.1876414453748587`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\) = ", 0.1876414453748587],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.910276560234807*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"b4e1dc5c-2209-45ec-90d5-3e6526dd7fcf"],

Cell[BoxData["\<\"After applying the fee, we will have the following X \
reinvested:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.9102765602362213`*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"353b6d98-9f9a-4096-8438-850b48afda6a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(Y\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.0005629243361245765`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = ", 0.0005629243361245765],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.910276560237191*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"13c3838b-d12b-4848-abdf-8dc56f6a0f2f"],

Cell[BoxData["\<\"The effective amount of Y reinvested is:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.910276560238172*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"1ad8520b-1ac8-408d-8419-ee6633ff2c04"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(x\\)]\\) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"1.`", " ", 
    RowBox[{
     SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`", "]"}]}]}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(x\)]\) = ", 1. 
   Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.9102765602391443`*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"b3909044-43d5-4b44-be8b-64cc2ecaaecd"],

Cell[BoxData["\<\"The effective amount of liquidity reinvested is:\"\>"], \
"Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.910276560240152*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"2f6c6f97-3977-4368-8f1d-5fdce25729ce"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(L\\)]\\) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"2.4919406011116556`", " ", 
    RowBox[{
     SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`", "]"}]}]}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = ", 2.4919406011116556` 
   Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.910276560241096*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"30a122c1-ba91-46b3-95be-f05ca5080b0b"],

Cell[BoxData["\<\"The amount of X the user will receive\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.910276560242136*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"a762faa3-6304-492b-b678-3172e3abadaf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(X\\)]\\) = \
\"\>", "\[InvisibleSpace]", 
   TemplateBox[{
     RowBox[{"1", "-", 
       RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"Erfc", "[", 
           FractionBox[
            RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
              RowBox[{
                SqrtBox["2"], " ", 
                RowBox[{"InverseErfc", "[", 
                  FractionBox["2.3752828907497174`", 
                   RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}]], "]"}]}]}], 
            SqrtBox["2"]], "]"}], " ", 
         RowBox[{"(", 
           RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
             RowBox[{"2.4919406011116556`", " ", 
               RowBox[{
                 SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`", 
                 "]"}]}]}], ")"}]}]}], 
     RowBox[{"0", "\[LessEqual]", 
       FractionBox["1.1876414453748587`", 
        RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
          RowBox[{"2.4919406011116556`", " ", 
            RowBox[{
              SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`", 
              "]"}]}]}]], "\[LessEqual]", "1"}]},
    "ConditionalExpression"]}],
  SequenceForm["\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\) = ", 
   ConditionalExpression[
   1 + Rational[-1, 2] 
     Erfc[2^Rational[-1, 2] (0.5 - 2^Rational[1, 2] 
        InverseErfc[
         2.3752828907497174`/(2.4919406011116556` + 
          2.4919406011116556` 
           Subscript[$CellContext`\[Delta], $CellContext`Y][
            0.1876414453748587])])] (2.4919406011116556` + 
      2.4919406011116556` 
       Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]), 
    0 <= 1.1876414453748587`/(2.4919406011116556` + 
     2.4919406011116556` 
      Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]) <= 
    1]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.910276560243198*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"1a63a977-2718-44b5-9524-5801784b88bd"],

Cell[BoxData["\<\"The effective price the user paid is then:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.9102765602450666`*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"80e36e48-baf9-4ffe-8e67-bf06e25ec9c1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(P\\), \\(eff\\)]\\) = \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{
     RowBox[{"-", 
       FractionBox["0.1876414453748587`", 
        RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"Erfc", "[", 
              FractionBox[
               RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
                 RowBox[{
                   SqrtBox["2"], " ", 
                   RowBox[{"InverseErfc", "[", 
                    FractionBox["2.3752828907497174`", 
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}]], "]"}]}]}], 
               SqrtBox["2"]], "]"}], " ", 
            RowBox[{"(", 
              RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
                RowBox[{"2.4919406011116556`", " ", 
                  RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}], ")"}]}]}]]}], 
     RowBox[{"0", "\[LessEqual]", 
       FractionBox["1.1876414453748587`", 
        RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
          RowBox[{"2.4919406011116556`", " ", 
            RowBox[{
              SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`", 
              "]"}]}]}]], "\[LessEqual]", "1"}]},
    "ConditionalExpression"]}],
  SequenceForm["\!\(\*SubscriptBox[\(P\), \(eff\)]\) = ", 
   ConditionalExpression[(-0.1876414453748587)/(-1 + 
    Rational[1, 2] 
     Erfc[2^Rational[-1, 2] (0.5 - 2^Rational[1, 2] 
        InverseErfc[
         2.3752828907497174`/(2.4919406011116556` + 
          2.4919406011116556` 
           Subscript[$CellContext`\[Delta], $CellContext`Y][
            0.1876414453748587])])] (2.4919406011116556` + 
      2.4919406011116556` 
       Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587])),
     0 <= 1.1876414453748587`/(2.4919406011116556` + 
     2.4919406011116556` 
      Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]) <= 
    1]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.9102765602460938`*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"0fac9d51-3962-4b03-b432-f662f1fe7dba"],

Cell[BoxData["\<\"Computing the new L using new X reserve:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.910276560247786*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"dd9825d5-1937-44db-8c6b-a16eb3dfa0bd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(givenX\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "2.493343375120198`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(L\), \(givenX\)]\) = ", 2.493343375120198],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.9102765602486467`*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"9ac8c35d-e854-4ad0-be73-3633932e3c1e"],

Cell[BoxData["\<\"Computing the new L using new Y reserve:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.910276560249572*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"4452a3d4-7c61-4108-9624-a6158215bdc3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(givenY\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "2.493343375120198`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(L\), \(givenY\)]\) = ", 2.493343375120198],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.910276560250432*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"b57949ed-8f79-4887-975c-61b3d66e1e0c"],

Cell[BoxData["\<\"Computing the new price given the new X reserve:\"\>"], \
"Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.910276560251359*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"a6608637-099f-4cc3-9f6b-3c2d1991287b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", 
   TemplateBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
        RowBox[{"-", "0.125`"}], "-", 
        RowBox[{"0.7071067811865476`", " ", 
          RowBox[{"InverseErfc", "[", 
            RowBox[{"2", " ", 
              RowBox[{"(", 
                RowBox[{"1", "-", 
                  RowBox[{"0.2005339517168975`", " ", 
                    RowBox[{"Erfc", "[", 
                    FractionBox[
                    RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
                    RowBox[{
                    SqrtBox["2"], " ", 
                    RowBox[{"InverseErfc", "[", 
                    FractionBox["2.3752828907497174`", 
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}]], "]"}]}]}], 
                    SqrtBox["2"]], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}], ")"}]}]}], ")"}]}], "]"}]}]}]], 
     InterpretationBox[
      DynamicModuleBox[{Typeset`open = False}, 
       TemplateBox[{"Expression", 
         StyleBox[
          TagBox[
           TooltipBox["\"condition\"", 
            TagBox[
             RowBox[{
               RowBox[{"0", "\[LessEqual]", 
                 RowBox[{"1", "-", 
                   RowBox[{"0.2005339517168975`", " ", 
                    RowBox[{"Erfc", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"0.5`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{
                    SqrtBox["2"], " ", 
                    RowBox[{"InverseErfc", "[", 
                    FractionBox["2.3752828907497174`", 
                    RowBox[{
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}]], "]"}]}]}], 
                    SqrtBox["2"]], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}], ")"}]}]}], "\[LessEqual]", "1"}], "&&", 
               RowBox[{"0", "\[LessEqual]", 
                 FractionBox["1.1876414453748587`", 
                  RowBox[{
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}]], "\[LessEqual]", "1"}], "&&", 
               RowBox[{"0", "\[LessEqual]", 
                 FractionBox["1.1876414453748587`", 
                  RowBox[{
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}]], "\[LessEqual]", "1"}]}], Short[#, 7]& ]], 
           Annotation[#, 
            Short[
             And[
             0 <= 1 - 0.2005339517168975 
               Erfc[2^Rational[-1, 2] (0.5 - 2^Rational[1, 2] 
                  InverseErfc[
                   2.3752828907497174`/(2.4919406011116556` + 
                    2.4919406011116556` 
                    Subscript[$CellContext`\[Delta], $CellContext`Y][
                    0.1876414453748587])])] (2.4919406011116556` + 
                2.4919406011116556` 
                 Subscript[$CellContext`\[Delta], $CellContext`Y][
                  0.1876414453748587]) <= 1, 0 <= 
              1.1876414453748587`/(2.4919406011116556` + 
               2.4919406011116556` 
                Subscript[$CellContext`\[Delta], $CellContext`Y][
                 0.1876414453748587]) <= 1, 0 <= 
              1.1876414453748587`/(2.4919406011116556` + 
               2.4919406011116556` 
                Subscript[$CellContext`\[Delta], $CellContext`Y][
                 0.1876414453748587]) <= 1], 7], "Tooltip"]& ], 
          "IconizedCustomName", StripOnInput -> False], 
         GridBox[{{
            RowBox[{
              TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
              TagBox["And", "IconizedItem"]}]}, {
            RowBox[{
              TagBox["\"Byte count: \"", "IconizedLabel"], 
              "\[InvisibleSpace]", 
              TagBox["2552", "IconizedItem"]}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
          "Column", 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
         Dynamic[Typeset`open]}, "IconizedObject"]], 
      And[
      0 <= 1 - 0.2005339517168975 
        Erfc[2^Rational[-1, 2] (0.5 - 2^Rational[1, 2] 
           InverseErfc[
            2.3752828907497174`/(2.4919406011116556` + 
             2.4919406011116556` 
              Subscript[$CellContext`\[Delta], $CellContext`Y][
               0.1876414453748587])])] (2.4919406011116556` + 
         2.4919406011116556` 
          Subscript[$CellContext`\[Delta], $CellContext`Y][
           0.1876414453748587]) <= 1, 0 <= 
       1.1876414453748587`/(2.4919406011116556` + 
        2.4919406011116556` 
         Subscript[$CellContext`\[Delta], $CellContext`Y][
          0.1876414453748587]) <= 1, 0 <= 
       1.1876414453748587`/(2.4919406011116556` + 
        2.4919406011116556` 
         Subscript[$CellContext`\[Delta], $CellContext`Y][
          0.1876414453748587]) <= 1], SelectWithContents -> True, Selectable -> 
      False]},
    "ConditionalExpression"]}],
  SequenceForm["S = ", 
   ConditionalExpression[
   E^(-0.125 - 0.7071067811865476 
     InverseErfc[
      2 (1 - 0.2005339517168975 
        Erfc[2^Rational[-1, 2] (0.5 - 2^Rational[1, 2] 
           InverseErfc[
            2.3752828907497174`/(2.4919406011116556` + 
             2.4919406011116556` 
              Subscript[$CellContext`\[Delta], $CellContext`Y][
               0.1876414453748587])])] (2.4919406011116556` + 
         2.4919406011116556` 
          Subscript[$CellContext`\[Delta], $CellContext`Y][
           0.1876414453748587]))]), 
    And[0 <= 
     1 - 0.2005339517168975 
      Erfc[2^Rational[-1, 2] (0.5 - 2^Rational[1, 2] 
         InverseErfc[
          2.3752828907497174`/(2.4919406011116556` + 
           2.4919406011116556` 
            Subscript[$CellContext`\[Delta], $CellContext`Y][
             0.1876414453748587])])] (2.4919406011116556` + 
       2.4919406011116556` 
        Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]) <= 
     1, 0 <= 1.1876414453748587`/(2.4919406011116556` + 
      2.4919406011116556` 
       Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]) <= 
     1, 0 <= 1.1876414453748587`/(2.4919406011116556` + 
      2.4919406011116556` 
       Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]) <= 
     1]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.910276560252762*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"11fcbe35-8a4b-4b34-a759-393173e6ae11"],

Cell[BoxData["\<\"Computing the new price given the new Y reserve:\"\>"], \
"Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.9102765602598658`*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"6e6abc84-54b8-415f-9ece-b225215e3755"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", "1.1`"}],
  SequenceForm["S = ", 1.1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.9102765602607107`*^9},
 CellLabel->
  "During evaluation of \
In[256]:=",ExpressionUUID->"60c6f703-3ec0-434f-9a6d-b513d5efb793"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"L", "[", 
    RowBox[{"K_", ",", " ", "\[Sigma]_", ",", " ", "\[Tau]_"}], "]"}], ":=", 
   FractionBox["x", 
    RowBox[{"1", "-", 
     RowBox[{"gaussianCDF", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox["S", "K"], "]"}], 
        RowBox[{"\[Sigma]", " ", "*", " ", 
         RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]], "+", 
       RowBox[{
        FractionBox["1", "2"], "\[Sigma]", "*", 
        RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]}], "]"}]}]]}], ";"}]], "Code",
 CellChangeTimes->{{3.909284232761074*^9, 3.909284311581963*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"4b5af426-135f-4a74-9da3-771d1103714c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"k", ",", "v", ",", "\[Tau]"}], "]"}], ",", " ", "\[Tau]"}], 
   "]"}], "]"}]], "Code",
 CellChangeTimes->{{3.90928432250084*^9, 3.909284333437564*^9}, {
  3.909284512486307*^9, 3.909284540209017*^9}, {3.909284603343576*^9, 
  3.909284612257375*^9}, {3.90928530943178*^9, 3.90928533290548*^9}, {
  3.909285423256996*^9, 3.909285426149007*^9}},
 CellLabel->
  "In[2298]:=",ExpressionUUID->"50c66ca0-9c74-4d61-9f4b-df2d48548dec"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Log", "[", 
           FractionBox["S", "k"], "]"}]}]}], ")"}], "2"], 
      RowBox[{"8", " ", 
       SuperscriptBox["v", "2"], " ", "\[Tau]"}]]}]], " ", "x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["v", "2"], " ", "\[Tau]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Log", "[", 
       FractionBox["S", "k"], "]"}]}]}], ")"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", "v", " ", 
   SuperscriptBox["\[Tau]", 
    RowBox[{"3", "/", "2"}]], " ", 
   SuperscriptBox[
    RowBox[{"Erfc", "[", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Log", "[", 
         FractionBox["S", "k"], "]"}]}]}], 
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", "v", " ", 
       SqrtBox["\[Tau]"]}]], "]"}], "2"]}]]], "Output",
 CellChangeTimes->{
  3.9092845427099953`*^9, 3.9092847284270687`*^9, {3.909285319040761*^9, 
   3.909285333489358*^9}, 3.909285426726862*^9, 3.909285486420289*^9},
 CellLabel->
  "Out[2298]=",ExpressionUUID->"1ff2b6f1-79df-45c7-b33d-411cc0c1f570"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"k", ",", "v", ",", "\[Tau]"}], "]"}], ",", " ", "v"}], "]"}], 
  "]"}]], "Code",
 CellChangeTimes->{
  3.909286005138384*^9, {3.909286071218306*^9, 3.9092860773164062`*^9}},
 CellLabel->
  "In[2299]:=",ExpressionUUID->"da6f77ec-0263-4e0f-ae2e-65c443a57315"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Log", "[", 
           FractionBox["S", "k"], "]"}]}]}], ")"}], "2"], 
      RowBox[{"8", " ", 
       SuperscriptBox["v", "2"], " ", "\[Tau]"}]]}]], " ", 
   SqrtBox[
    FractionBox["2", "\[Pi]"]], " ", "x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["v", "2"], " ", "\[Tau]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Log", "[", 
       FractionBox["S", "k"], "]"}]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox["v", "2"], " ", 
   SqrtBox["\[Tau]"], " ", 
   SuperscriptBox[
    RowBox[{"Erfc", "[", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Log", "[", 
         FractionBox["S", "k"], "]"}]}]}], 
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", "v", " ", 
       SqrtBox["\[Tau]"]}]], "]"}], "2"]}]]], "Output",
 CellChangeTimes->{3.909286081302704*^9},
 CellLabel->
  "Out[2299]=",ExpressionUUID->"e1990e5f-a66a-4ff5-a461-0d0ffa1425f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"\[Kappa]", ",", "v", ",", "\[Tau]"}], "]"}], ",", " ", 
    "\[Kappa]"}], "]"}], "]"}]], "Code",
 CellChangeTimes->{{3.909286199444543*^9, 3.909286209054088*^9}},
 CellLabel->
  "In[2300]:=",ExpressionUUID->"4738d5dd-62e6-4329-9f10-aa51583081a4"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Log", "[", 
            FractionBox["S", "\[Kappa]"], "]"}]}]}], ")"}], "2"], 
       RowBox[{"8", " ", 
        SuperscriptBox["v", "2"], " ", "\[Tau]"}]]}]], " ", 
    SqrtBox[
     FractionBox["2", "\[Pi]"]], " ", "x"}], 
   RowBox[{"v", " ", "\[Kappa]", " ", 
    SqrtBox["\[Tau]"], " ", 
    SuperscriptBox[
     RowBox[{"Erfc", "[", 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Log", "[", 
          FractionBox["S", "\[Kappa]"], "]"}]}]}], 
       RowBox[{"2", " ", 
        SqrtBox["2"], " ", "v", " ", 
        SqrtBox["\[Tau]"]}]], "]"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.909286209687827*^9},
 CellLabel->
  "Out[2300]=",ExpressionUUID->"5d6626db-ee2a-47e3-98ee-214b11fe010e"]
}, Open  ]],

Cell["", "Item",
 CellChangeTimes->{
  3.9102698673316183`*^9},ExpressionUUID->"30f4a8e8-beca-49df-baea-\
8b81c8a2aeb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "a", " ", "root", " ", "for", " ", "changed", " ", 
    "parameters"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"computeSwapConstant", "[", 
      RowBox[{
      "x_", ",", "y_", ",", "L_", ",", "strike_", ",", "vol_", ",", "tau_"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"gaussianPPF", "[", 
       FractionBox["x", "L"], "]"}], "+", 
      RowBox[{"gaussianPPF", "[", 
       FractionBox["y", 
        RowBox[{"strike", "*", "L"}]], "]"}], "+", 
      RowBox[{"vol", "*", "tau"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialPrice", ":=", "2000"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialX", ":=", "5000"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialStrike", ":=", "1800"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialSigma", ":=", "0.05"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialTau", ":=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "fromX"], "[", 
     RowBox[{"x_", ",", "S_", ",", "K_", ",", "\[Sigma]_", ",", "\[Tau]_"}], 
     "]"}], ":=", 
    FractionBox["x", 
     RowBox[{"1", "-", 
      RowBox[{"gaussianCDF", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"Log", "[", 
          FractionBox["S", "K"], "]"}], 
         RowBox[{"\[Sigma]", "*", 
          RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]], "+", 
        RowBox[{
         FractionBox["1", "2"], "\[Sigma]", "*", 
         RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]}], "]"}]}]]}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["Y", "fromX"], "[", 
      RowBox[{"x_", ",", "S_", ",", "K_", ",", "\[Sigma]_", ",", "\[Tau]_"}], 
      "]"}], ":=", 
     RowBox[{"K", "*", 
      RowBox[{
       SubscriptBox["L", "fromX"], "[", 
       RowBox[{"x", ",", "S", ",", "K", ",", "\[Sigma]", ",", "\[Tau]"}], 
       "]"}], "*", 
      RowBox[{"gaussianCDF", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"Log", "[", 
          FractionBox["S", "K"], "]"}], 
         RowBox[{"\[Sigma]", "*", 
          RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]], "-", 
        RowBox[{
         FractionBox["1", "2"], "\[Sigma]", "*", 
         RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]}], "]"}]}]}], ";"}], "\n", 
   RowBox[{"initialL", ":=", 
    RowBox[{
     SubscriptBox["L", "fromX"], "[", 
     RowBox[{
     "initialX", ",", "initialPrice", ",", "initialStrike", ",", 
      "initialSigma", ",", "initialTau"}], "]"}]}], "\n", 
   RowBox[{"initialY", ":=", 
    RowBox[{
     SubscriptBox["Y", "fromX"], "[", 
     RowBox[{
     "initialX", ",", "initialPrice", ",", "initialStrike", ",", 
      "initialSigma", ",", "initialTau"}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Initial L = \>\"", ",", " ", "initialL"}], "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Initial Y = \>\"", ",", " ", "initialY"}], "]"}], "\n", "\n", 
   RowBox[{
    RowBox[{"newStrike", " ", "=", " ", "1820"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"newSigma", " ", "=", " ", "0.04"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"newTau", " ", "=", " ", "1"}], ";"}], "\n", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{"computeSwapConstant", "[", 
      RowBox[{
      "initialX", ",", " ", "initialY", ",", " ", "L", ",", " ", "newStrike", 
       ",", " ", "newSigma", ",", " ", "newTau"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"L", ",", " ", "initialL"}], "}"}]}], "]"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Desmos", " ", "Checks"}], " ", "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"initialX", ":=", "2"}], ";", "\n", 
     RowBox[{"initialY", ":=", "2.209"}], ";", "\n", 
     RowBox[{"initialStrike", ":=", "1"}], ";", "\n", 
     RowBox[{"initialSigma", ":=", "0.4"}], ";", "\n", 
     RowBox[{"initialTau", ":=", "1"}], ";", "\n", 
     RowBox[{"initialL", ":=", "5"}], ";"}], "*)"}]}]}]], "Code",
 CellChangeTimes->{{3.9102698717452183`*^9, 3.910269878705433*^9}, {
  3.910269917340452*^9, 3.910270513817072*^9}, {3.9102705893206577`*^9, 
  3.910270844573196*^9}, {3.910272041094924*^9, 3.910272047123364*^9}, {
  3.910276540573292*^9, 3.910276541127635*^9}, {3.9102765919165382`*^9, 
  3.9102766535669317`*^9}, {3.9102767176812983`*^9, 3.9102767196112013`*^9}, {
  3.910276852015691*^9, 3.910276879183813*^9}, {3.910286187652493*^9, 
  3.910286192547421*^9}},ExpressionUUID->"4ed370a8-51eb-433c-a04a-\
009252cccf10"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial L = \"\>", "\[InvisibleSpace]", "303126.1917495261`"}],
  
  SequenceForm["Initial L = ", 303126.1917495261],
  Editable->False]], "Print",
 CellChangeTimes->{{3.910270823726644*^9, 3.910270846743188*^9}, {
   3.9102765427704983`*^9, 3.91027665548776*^9}, 3.910276719975027*^9, {
   3.910276852840979*^9, 3.910276879603985*^9}},
 CellLabel->
  "During evaluation of \
In[477]:=",ExpressionUUID->"6a4df0d2-2146-46a7-8dd3-e231a119f803"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial Y = \"\>", "\[InvisibleSpace]", 
   "5.3544485224666595`*^8"}],
  SequenceForm["Initial Y = ", 5.3544485224666595`*^8],
  Editable->False]], "Print",
 CellChangeTimes->{{3.910270823726644*^9, 3.910270846743188*^9}, {
   3.9102765427704983`*^9, 3.91027665548776*^9}, 3.910276719975027*^9, {
   3.910276852840979*^9, 3.91027687960579*^9}},
 CellLabel->
  "During evaluation of \
In[477]:=",ExpressionUUID->"51e9fba5-8056-4f0b-9c0c-fbfd3f335072"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"L", "\[Rule]", "306469.65444831847`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.910270515517971*^9, 3.910270692837224*^9, 3.910270750972248*^9, {
   3.910270823760948*^9, 3.910270846745335*^9}, {3.910276542779942*^9, 
   3.910276655491342*^9}, 3.910276719977729*^9, {3.9102768528538*^9, 
   3.9102768796074123`*^9}},
 CellLabel->
  "Out[492]=",ExpressionUUID->"39de1e4e-021f-4eb9-af88-8bca5bf4d8af"]
}, Open  ]]
},
WindowSize->{3220, 2084},
WindowMargins->{{Automatic, 12}, {Automatic, 11}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 31, 2023)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "Users", "colin", 
   "Documents"}, "DarkMode.nb", CharacterEncoding -> "UTF-8"],
ExpressionUUID->"5448244f-f9d9-40b1-b507-d7b872b3fa95"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 935, 25, 148, "Code",ExpressionUUID->"c490899a-2f5d-40ab-a7d1-a5c9dca8c853"],
Cell[1499, 47, 2817, 95, 373, "Code",ExpressionUUID->"0e5528a2-b8c6-467a-844e-8c7716a97af3"],
Cell[4319, 144, 678, 16, 122, "Code",ExpressionUUID->"38327a6c-a04f-4af4-877c-b294ae062156"],
Cell[5000, 162, 1343, 37, 226, "Code",ExpressionUUID->"7d969c2b-e997-401d-b15b-a40e313196bc"],
Cell[CellGroupData[{
Cell[6368, 203, 813, 22, 96, "Code",ExpressionUUID->"8a8b8903-b1b9-4e57-ae98-7ba26b8f5c79"],
Cell[CellGroupData[{
Cell[7206, 229, 400, 9, 31, "Print",ExpressionUUID->"a60caa90-4666-4dee-9d46-48319958a213"],
Cell[7609, 240, 402, 9, 31, "Print",ExpressionUUID->"441ff41f-2daa-44d6-99ff-8f260c700e20"]
}, Open  ]]
}, Open  ]],
Cell[8038, 253, 3628, 95, 342, "Code",ExpressionUUID->"1efdbee4-dd4b-4b95-89ef-b8a05144a40f"],
Cell[CellGroupData[{
Cell[11691, 352, 8962, 225, 1149, "Code",ExpressionUUID->"e81539e0-9c8f-4cc0-9aed-23ff71ff5ce5"],
Cell[CellGroupData[{
Cell[20678, 581, 1469, 22, 31, "Print",ExpressionUUID->"42e60caf-1a29-4bbe-b936-7100a60eb6b7"],
Cell[22150, 605, 1678, 28, 31, "Print",ExpressionUUID->"8a1f079c-1436-4198-9b93-bf0ec32daa63"],
Cell[23831, 635, 1491, 23, 31, "Print",ExpressionUUID->"50aba783-7415-40cd-839a-e6f6092faa46"],
Cell[25325, 660, 1672, 28, 31, "Print",ExpressionUUID->"32e6938a-d6c0-4bb8-9abe-f9c2a2ebd4fd"],
Cell[27000, 690, 1468, 22, 31, "Print",ExpressionUUID->"7da6e04c-283e-469a-9a13-4960ecac2c82"],
Cell[28471, 714, 1670, 28, 31, "Print",ExpressionUUID->"c019ccf2-a4d8-4e34-9fd6-193905ebbdfa"],
Cell[30144, 744, 1476, 23, 31, "Print",ExpressionUUID->"79ae7000-f01f-4cd1-877c-9d16759ce0d6"],
Cell[31623, 769, 1672, 28, 31, "Print",ExpressionUUID->"5c439259-9b7f-425b-8cd2-f5079d9d5bbf"],
Cell[33298, 799, 1463, 22, 31, "Print",ExpressionUUID->"9297b731-6079-4122-bdf6-fe1d3dca478e"],
Cell[34764, 823, 1680, 28, 31, "Print",ExpressionUUID->"5f6ee580-1096-4d87-9ce4-e85bdc82f31c"],
Cell[36447, 853, 1468, 22, 31, "Print",ExpressionUUID->"19832e1d-782c-4114-9910-f4591149a725"],
Cell[37918, 877, 1658, 28, 31, "Print",ExpressionUUID->"b92947c4-2e01-4c11-9c50-3081d132e224"],
Cell[39579, 907, 1466, 22, 31, "Print",ExpressionUUID->"97b9ed97-f081-45b7-9818-0a70c3bf9fca"],
Cell[41048, 931, 1660, 28, 35, "Print",ExpressionUUID->"0a71fbdd-7a5b-4f20-aaad-8db2a2df4b0f"],
Cell[42711, 961, 1466, 22, 31, "Print",ExpressionUUID->"41087c6e-c587-49ce-8bae-1c9e2608c571"],
Cell[44180, 985, 1660, 28, 35, "Print",ExpressionUUID->"6e7b6991-4569-4d60-9646-04aa5ee7eb3e"],
Cell[45843, 1015, 1476, 23, 31, "Print",ExpressionUUID->"b93a08b5-824b-4045-ba0b-d4b3ccbdae1d"],
Cell[47322, 1040, 1571, 26, 31, "Print",ExpressionUUID->"ffe5903d-d10f-43f8-95f2-1fe909779e27"],
Cell[48896, 1068, 1476, 23, 31, "Print",ExpressionUUID->"618e91cd-4561-4876-821f-06af1b46a8b8"],
Cell[50375, 1093, 1571, 26, 31, "Print",ExpressionUUID->"4278d801-00b2-443d-b6f8-9d59e1172cc9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51995, 1125, 7746, 220, 1177, "Code",ExpressionUUID->"9bf9bebe-962a-46aa-86cc-a308ddbc4fb0"],
Cell[CellGroupData[{
Cell[59766, 1349, 492, 8, 31, "Print",ExpressionUUID->"6f6fcc7c-6c65-4011-a67a-c0f19f30e480"],
Cell[60261, 1359, 702, 14, 31, "Print",ExpressionUUID->"b4e1dc5c-2209-45ec-90d5-3e6526dd7fcf"],
Cell[60966, 1375, 518, 9, 31, "Print",ExpressionUUID->"353b6d98-9f9a-4096-8438-850b48afda6a"],
Cell[61487, 1386, 696, 14, 31, "Print",ExpressionUUID->"13c3838b-d12b-4848-abdf-8dc56f6a0f2f"],
Cell[62186, 1402, 490, 8, 31, "Print",ExpressionUUID->"1ad8520b-1ac8-408d-8419-ee6633ff2c04"],
Cell[62679, 1412, 837, 18, 31, "Print",ExpressionUUID->"b3909044-43d5-4b44-be8b-64cc2ecaaecd"],
Cell[63519, 1432, 500, 9, 31, "Print",ExpressionUUID->"2f6c6f97-3977-4368-8f1d-5fdce25729ce"],
Cell[64022, 1443, 868, 18, 31, "Print",ExpressionUUID->"30a122c1-ba91-46b3-95be-f05ca5080b0b"],
Cell[64893, 1463, 487, 8, 31, "Print",ExpressionUUID->"a762faa3-6304-492b-b678-3172e3abadaf"],
Cell[65383, 1473, 2595, 58, 82, "Print",ExpressionUUID->"1a63a977-2718-44b5-9524-5801784b88bd"],
Cell[67981, 1533, 494, 8, 31, "Print",ExpressionUUID->"80e36e48-baf9-4ffe-8e67-bf06e25ec9c1"],
Cell[68478, 1543, 2742, 61, 90, "Print",ExpressionUUID->"0fac9d51-3962-4b03-b432-f662f1fe7dba"],
Cell[71223, 1606, 490, 8, 31, "Print",ExpressionUUID->"dd9825d5-1937-44db-8c6b-a16eb3dfa0bd"],
Cell[71716, 1616, 686, 14, 35, "Print",ExpressionUUID->"9ac8c35d-e854-4ad0-be73-3633932e3c1e"],
Cell[72405, 1632, 490, 8, 31, "Print",ExpressionUUID->"4452a3d4-7c61-4108-9624-a6158215bdc3"],
Cell[72898, 1642, 684, 14, 35, "Print",ExpressionUUID->"b57949ed-8f79-4887-975c-61b3d66e1e0c"],
Cell[73585, 1658, 500, 9, 31, "Print",ExpressionUUID->"a6608637-099f-4cc3-9f6b-3c2d1991287b"],
Cell[74088, 1669, 8206, 180, 90, "Print",ExpressionUUID->"11fcbe35-8a4b-4b34-a759-393173e6ae11"],
Cell[82297, 1851, 502, 9, 31, "Print",ExpressionUUID->"6e6abc84-54b8-415f-9ece-b225215e3755"],
Cell[82802, 1862, 567, 12, 31, "Print",ExpressionUUID->"60c6f703-3ec0-434f-9a6d-b513d5efb793"]
}, Open  ]]
}, Open  ]],
Cell[83396, 1878, 708, 19, 83, "Code",ExpressionUUID->"4b5af426-135f-4a74-9da3-771d1103714c"],
Cell[CellGroupData[{
Cell[84129, 1901, 541, 12, 43, "Code",ExpressionUUID->"50c66ca0-9c74-4d61-9f4b-df2d48548dec"],
Cell[84673, 1915, 1418, 44, 111, "Output",ExpressionUUID->"1ff2b6f1-79df-45c7-b33d-411cc0c1f570"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86128, 1964, 372, 10, 43, "Code",ExpressionUUID->"da6f77ec-0263-4e0f-ae2e-65c443a57315"],
Cell[86503, 1976, 1281, 42, 113, "Output",ExpressionUUID->"e1990e5f-a66a-4ff5-a461-0d0ffa1425f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87821, 2023, 361, 9, 43, "Code",ExpressionUUID->"4738d5dd-62e6-4329-9f10-aa51583081a4"],
Cell[88185, 2034, 1141, 35, 113, "Output",ExpressionUUID->"5d6626db-ee2a-47e3-98ee-214b11fe010e"]
}, Open  ]],
Cell[89341, 2072, 120, 3, 40, "Item",ExpressionUUID->"30f4a8e8-beca-49df-baea-8b81c8a2aeb9"],
Cell[CellGroupData[{
Cell[89486, 2079, 4440, 115, 795, "Code",ExpressionUUID->"4ed370a8-51eb-433c-a04a-009252cccf10"],
Cell[CellGroupData[{
Cell[93951, 2198, 491, 11, 31, "Print",ExpressionUUID->"6a4df0d2-2146-46a7-8dd3-e231a119f803"],
Cell[94445, 2211, 500, 11, 33, "Print",ExpressionUUID->"51e9fba5-8056-4f0b-9c0c-fbfd3f335072"]
}, Open  ]],
Cell[94960, 2225, 441, 9, 33, "Output",ExpressionUUID->"39de1e4e-021f-4eb9-af88-8bca5bf4d8af"]
}, Open  ]]
}
]
*)

