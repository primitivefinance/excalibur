(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[    100327,       2281]
NotebookOptionsPosition[     93574,       2180]
NotebookOutlinePosition[     94171,       2200]
CellTagsIndexPosition[     94128,       2197]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Gaussian", " ", "CDF"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"gaussianCDF", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"CDF", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"0", ",", " ", "1"}], "]"}], ",", " ", "x"}], "]"}]}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Gaussian", " ", "PPF"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"gaussianPPF", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Quantile", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"0", ",", " ", "1"}], "]"}], ",", " ", "x"}], 
     "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.9084674257813168`*^9, 3.908467481719372*^9}, {
  3.9084675216212587`*^9, 3.908467546038982*^9}, {3.90846757908879*^9, 
  3.908467614530884*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c490899a-2f5d-40ab-a7d1-a5c9dca8c853"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["L", "X"], "[", 
    RowBox[{"x_", ",", "S_"}], "]"}], ":=", 
   FractionBox["x", 
    RowBox[{"1", "-", 
     RowBox[{"gaussianCDF", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox["S", "K"], "]"}], "\[Sigma]"], "+", 
       RowBox[{
        FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["L", "Y"], "[", 
    RowBox[{"y_", ",", "S_"}], "]"}], ":=", 
   FractionBox["y", 
    RowBox[{"K", "*", 
     RowBox[{"gaussianCDF", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox["S", "K"], "]"}], "\[Sigma]"], "-", 
       RowBox[{
        FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"y_", ",", "S_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "Y"], "[", 
     RowBox[{"y", ",", "S"}], "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"gaussianCDF", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"Log", "[", 
          FractionBox["S", "K"], "]"}], "\[Sigma]"], "+", 
        RowBox[{
         FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Y", "[", 
    RowBox[{"x_", ",", "S_"}], "]"}], ":=", 
   RowBox[{"K", "*", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{"x", ",", "S"}], "]"}], "*", 
    RowBox[{"gaussianCDF", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox["S", "K"], "]"}], "\[Sigma]"], "-", 
      RowBox[{
       FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["P", "X"], "[", 
    RowBox[{"x_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"K", "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"gaussianPPF", "[", 
        RowBox[{"1", "-", 
         FractionBox["x", "L"]}], "]"}], "*", "\[Sigma]"}], "-", 
      RowBox[{
       FractionBox["1", "2"], 
       SuperscriptBox["\[Sigma]", "2"]}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["P", "Y"], "[", 
    RowBox[{"y_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"K", "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"gaussianPPF", "[", 
        FractionBox["y", 
         RowBox[{"K", "*", "L"}]], "]"}], "*", "\[Sigma]"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       SuperscriptBox["\[Sigma]", "2"]}]}], "]"}]}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.908467621608725*^9, 3.908467735863633*^9}, {
  3.9089759722512827`*^9, 3.908975998886648*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"0e5528a2-b8c6-467a-844e-8c7716a97af3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Constants", " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]", ":=", "0.5"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"K", ":=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Gamma]", ":=", "0.997"}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.9084680371821203`*^9, 3.908468094956563*^9}, {
  3.908470349190227*^9, 3.90847035824724*^9}, {3.908470640467009*^9, 
  3.908470651083271*^9}, {3.908962321915421*^9, 3.908962322267576*^9}, {
  3.908962366415097*^9, 3.9089623671545897`*^9}, {3.908962417752561*^9, 
  3.9089624186920137`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"38327a6c-a04f-4af4-877c-b294ae062156"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", "X", " ", "value"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["x", "0"], ":=", "1"}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Initial", " ", "price"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["S", "0"], ":=", "1"}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Amount", " ", "of", " ", "Y", " ", "for", " ", "this", " ", "price", " ",
      "and", " ", "X"}], " ", "*)"}], "\n", 
   RowBox[{
    SubscriptBox["y", "0"], ":=", 
    RowBox[{"Y", "[", 
     RowBox[{
      SubscriptBox["x", "0"], ",", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"(*", " ", "Liquidity", " ", "*)"}], "\n", 
   RowBox[{
    SubscriptBox["L", "0"], ":=", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{
      SubscriptBox["x", "0"], ",", 
      SubscriptBox["S", "0"]}], "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.908468373546104*^9, 3.9084685799434233`*^9}, {
  3.9084686112036858`*^9, 3.908468612883589*^9}, {3.908468683308464*^9, 
  3.908468734474468*^9}, {3.90846994004578*^9, 3.908469951539794*^9}, {
  3.90847000421662*^9, 3.908470006749341*^9}, {3.909022679810102*^9, 
  3.909022681399785*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"7d969c2b-e997-401d-b15b-a40e313196bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Quck", " ", "sanity", " ", "checks"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<This should print 1: \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "X"], "[", 
      RowBox[{
       SubscriptBox["x", "0"], ",", 
       SubscriptBox["L", "0"]}], "]"}]}], "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<This should print 1: \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "Y"], "[", 
      RowBox[{
       SubscriptBox["y", "0"], ",", 
       SubscriptBox["L", "0"]}], "]"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.908962773200364*^9, 3.908962811041506*^9}, {
  3.908976008296489*^9, 3.9089760811257973`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"8a8b8903-b1b9-4e57-ae98-7ba26b8f5c79"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"This should print 1: \"\>", "\[InvisibleSpace]", "1.`"}],
  SequenceForm["This should print 1: ", 1.],
  Editable->False]], "Print",
 CellChangeTimes->{3.908976082572167*^9, 3.909025668931364*^9, 
  3.9102698961915703`*^9},
 CellLabel->
  "During evaluation of \
In[16]:=",ExpressionUUID->"dc8b80d7-5b11-428d-aa0b-17c8f7a58316"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"This should print 1: \"\>", "\[InvisibleSpace]", "1.`"}],
  SequenceForm["This should print 1: ", 1.],
  Editable->False]], "Print",
 CellChangeTimes->{3.908976082572167*^9, 3.909025668931364*^9, 
  3.910269896192731*^9},
 CellLabel->
  "During evaluation of \
In[16]:=",ExpressionUUID->"819ae34f-6934-408b-b25d-b4900bac7a69"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Arb", " ", "calculations"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"arbX", "[", 
      RowBox[{"p_", ",", "x_", ",", "L_"}], "]"}], ":=", 
     FractionBox[
      RowBox[{
       RowBox[{"L", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"gaussianCDF", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"Log", "[", 
              FractionBox["p", "K"], "]"}], "\[Sigma]"], "+", 
            RowBox[{
             FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], ")"}]}], "-", 
       "x"}], 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "-", "1"}], ")"}], "*", 
        FractionBox[
         RowBox[{"1", "-", 
          RowBox[{"gaussianCDF", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"Log", "[", 
              FractionBox["p", "K"], "]"}], "\[Sigma]"], "+", 
            RowBox[{
             FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], 
         RowBox[{"1", "-", 
          RowBox[{"gaussianCDF", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"Log", "[", 
              FractionBox[
               SubscriptBox["S", "0"], "K"], "]"}], "\[Sigma]"], "+", 
            RowBox[{
             FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]]}]}]]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"arbY", "[", 
      RowBox[{"p_", ",", "y_", ",", "L_"}], "]"}], ":=", 
     FractionBox[
      RowBox[{
       RowBox[{"K", "*", "L", "*", 
        RowBox[{"gaussianCDF", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"Log", "[", 
            FractionBox["p", "K"], "]"}], "\[Sigma]"], "-", 
          RowBox[{
           FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], "-", "y"}], 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "-", "1"}], ")"}], 
        FractionBox[
         RowBox[{"gaussianCDF", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["p", "K"], "]"}], "\[Sigma]"], "-", 
           RowBox[{
            FractionBox["1", "2"], "\[Sigma]"}]}], "]"}], 
         RowBox[{"gaussianCDF", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox[
              SubscriptBox["S", "0"], "K"], "]"}], "\[Sigma]"], "-", 
           RowBox[{
            FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]]}]}]]}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{{3.908469869746161*^9, 3.908469874456465*^9}, {
   3.908469966460216*^9, 3.9084699673930483`*^9}, {3.908470014741447*^9, 
   3.908470016059868*^9}, {3.9084710978099003`*^9, 3.9084711295094557`*^9}, 
   3.9084711698900547`*^9, {3.90847120602601*^9, 3.908471247223518*^9}, {
   3.908471281448723*^9, 3.908471367082285*^9}, {3.908472297530381*^9, 
   3.908472410924035*^9}, {3.908472525967081*^9, 3.9084725263795347`*^9}, {
   3.908472647857041*^9, 3.908472655134634*^9}, {3.908472698618392*^9, 
   3.9084728617947607`*^9}, {3.908962247915147*^9, 3.908962248388301*^9}, {
   3.908962905421812*^9, 3.9089629062637444`*^9}, {3.9089645920566*^9, 
   3.90896459533709*^9}, {3.908976692229253*^9, 3.908976695880341*^9}, {
   3.908976844868556*^9, 3.908976846911487*^9}, {3.908978192545518*^9, 
   3.908978253726102*^9}, {3.908978660030653*^9, 3.9089786769258137`*^9}, {
   3.908978827103158*^9, 3.9089788397352858`*^9}, {3.9089788752737007`*^9, 
   3.908978875659925*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"1efdbee4-dd4b-4b95-89ef-b8a05144a40f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Test", " ", "a", " ", "value", " ", "that", " ", "we", " ", "got", " ", 
    "from", " ", "above", " ", "here"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"newPriceX", ":=", "0.8"}], ";"}], "\n", 
   RowBox[{"tenderX", ":=", 
    RowBox[{"arbX", "[", 
     RowBox[{"newPriceX", ",", 
      SubscriptBox["x", "0"], ",", 
      SubscriptBox["L", "0"]}], "]"}]}], "\n", 
   RowBox[{
   "Print", "[", "\"\<We are tendering the following amount of X:\>\"", "]"}],
    "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\) = \>\"", ",", " ", 
     "tenderX"}], "]"}], "\n", 
   RowBox[{
   "Print", "[", 
    "\"\<After applying the fee, we will have the following X \
reinvested:\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Xx"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", "\[CapitalDelta]"}]}], 
    ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(X\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Xx"], "[", "tenderX", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Swap", " ", "in", " ", "X", " ", "with", " ", "fee", " ", "chosen", " ", 
     "above"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]_", "]"}], ":=", 
    " ", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", "Xx"], "[", "\[CapitalDelta]", "]"}], ",", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"This", " ", "can", " ", "be", " ", "simplified"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Delta]", "Yx"], "[", "\[CapitalDelta]_", "]"}], ":=", 
    RowBox[{"K", "*", 
     RowBox[{
      SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]", "]"}], "*", 
     RowBox[{"gaussianCDF", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox[
          SubscriptBox["S", "0"], "K"], "]"}], "\[Sigma]"], "-", 
       RowBox[{
        FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]}], "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective amount of Y reinvested is:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Yx"], "[", "tenderX", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective amount of liquidity reinvested is:\>\"", 
    "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Lx"], "[", "tenderX", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{
   "Print", "[", "\"\<The amount of Y the user will receive\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "Y"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"K", "*", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "0"], "+", 
         RowBox[{
          SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]", "]"}]}], 
        ")"}], "*", 
       RowBox[{"gaussianCDF", "[", 
        RowBox[{
         RowBox[{"-", "\[Sigma]"}], "-", 
         RowBox[{"gaussianPPF", "[", 
          FractionBox[
           RowBox[{
            SubscriptBox["x", "0"], "+", "\[CapitalDelta]"}], 
           RowBox[{
            SubscriptBox["L", "0"], "+", 
            RowBox[{
             SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]", "]"}]}]],
           "]"}]}], "]"}]}], "-", 
      SubscriptBox["y", "0"]}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\) = \>\"", ",", " ", 
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "Y"], "[", "tenderX", "]"}]}]}], "]"}],
    "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective price the user paid is then:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(P\), \(eff\)]\) = \>\"", ",", " ", 
     FractionBox[
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "Y"], "[", "tenderX", "]"}]}], 
      "tenderX"]}], "]"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"What", " ", "are", " ", "the", " ", "liquidities"}], " ", "*)"}],
    "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new L using new X reserve:\>\"", "]"}], 
   "\n", 
   RowBox[{
    SubscriptBox["L", "givenX"], ":=", " ", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "0"], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "Xx"], "[", "tenderX", "]"}]}], ",", " ", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(givenX\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "givenX"]}], "]"}], "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new L using new Y reserve:\>\"", "]"}], 
   "\n", 
   RowBox[{
    SubscriptBox["L", "givenY"], ":=", 
    RowBox[{
     SubscriptBox["L", "Y"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["y", "0"], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "Yx"], "[", "tenderX", "]"}]}], ",", " ", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(givenY\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "givenY"]}], "]"}], "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new price given the new X reserve:\>\"", 
    "]"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Now", " ", "what", " ", "is", " ", "the", " ", 
     RowBox[{"price", "?", " ", "Should"}], " ", "be", " ", "0.9"}], " ", 
    "*)"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<S = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "X"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "0"], "+", "tenderX"}], ",", 
       SubscriptBox["L", "givenX"]}], "]"}]}], "]"}], "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new price given the new Y reserve:\>\"", 
    "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<S = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "Y"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "0"], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "Y"], "[", "tenderX", "]"}]}], ",", 
       SubscriptBox["L", "givenY"]}], "]"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.9084686067941647`*^9, 3.908468677383553*^9}, {
   3.908468740698229*^9, 3.9084689324869547`*^9}, {3.908469407393499*^9, 
   3.90846948258585*^9}, {3.9084697453831453`*^9, 3.908469751400042*^9}, {
   3.90847002453519*^9, 3.908470095084703*^9}, {3.90847012516411*^9, 
   3.90847012730599*^9}, {3.908470389531291*^9, 3.9084706207048197`*^9}, {
   3.908470657120466*^9, 3.9084706819852057`*^9}, {3.908470713721982*^9, 
   3.9084707434513493`*^9}, {3.908470775377922*^9, 3.908470779431653*^9}, {
   3.908470827127829*^9, 3.908470836810878*^9}, {3.908471144978223*^9, 
   3.908471148613662*^9}, {3.908471342374304*^9, 3.908471396516526*^9}, {
   3.908471492879197*^9, 3.908471515719439*^9}, {3.908472220030443*^9, 
   3.9084722939922533`*^9}, {3.908472406536892*^9, 3.9084724386581182`*^9}, {
   3.908472792423646*^9, 3.908472793603929*^9}, {3.908962003290093*^9, 
   3.908962037676124*^9}, {3.908962097133566*^9, 3.908962173336836*^9}, {
   3.90896220971637*^9, 3.908962215271048*^9}, {3.908962268479413*^9, 
   3.90896229916632*^9}, 3.9089623337569313`*^9, {3.908962379639881*^9, 
   3.908962388938654*^9}, {3.9089624572707443`*^9, 3.9089624721040583`*^9}, {
   3.908962510704714*^9, 3.908962524338188*^9}, {3.908962555054682*^9, 
   3.90896256203594*^9}, {3.908962820059133*^9, 3.908962898754694*^9}, {
   3.9089629575319777`*^9, 3.90896307969725*^9}, {3.9089631418064203`*^9, 
   3.908963173466034*^9}, {3.908963258525576*^9, 3.9089633224402733`*^9}, {
   3.908963367994213*^9, 3.908963461202013*^9}, {3.908963609379298*^9, 
   3.908963933535779*^9}, {3.908964139664143*^9, 3.9089641709875937`*^9}, {
   3.90896426104887*^9, 3.908964413991126*^9}, 3.908964543677549*^9, 
   3.908964586086096*^9, {3.908976159020768*^9, 3.908976159227566*^9}, {
   3.908976470413172*^9, 3.908976481004795*^9}, {3.908976522067993*^9, 
   3.908976654910138*^9}, {3.908976734310645*^9, 3.908976786321085*^9}, {
   3.908976970992345*^9, 3.908977362278446*^9}, {3.908977545063843*^9, 
   3.908977618765689*^9}, {3.90897787977813*^9, 3.908977904800407*^9}, {
   3.9090235637726593`*^9, 3.9090235739352627`*^9}, 3.909025650712202*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"e81539e0-9c8f-4cc0-9aed-23ff71ff5ce5"],

Cell[CellGroupData[{

Cell[BoxData["\<\"We are tendering the following amount of X:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"3bcc7f21-c481-4b7a-a49a-dab415c589b7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(X\\)]\\) = \
\"\>", "\[InvisibleSpace]", "0.4417696624099112`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\) = ", 0.4417696624099112],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899126915*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"660519cd-fcfd-485f-a352-56a05383e2e6"],

Cell[BoxData["\<\"After applying the fee, we will have the following X \
reinvested:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899128642*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"098a1b4e-8ff0-4aad-a90e-b8e39ef97dcc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(X\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.001325308987229735`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(X\)]\) = ", 0.001325308987229735],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899129684*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"256894aa-279d-4bf8-8418-9b6620065af5"],

Cell[BoxData["\<\"The effective amount of Y reinvested is:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899130721*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"01a27006-44f3-4d49-869d-ce50c46b6e63"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(Y\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.001325308987229735`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = ", 0.001325308987229735],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991316957`*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"c0655bf5-59e9-4c99-afb2-2d886dbfdd8f"],

Cell[BoxData["\<\"The effective amount of liquidity reinvested is:\"\>"], \
"Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899132708*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"412c0738-d703-41d6-bf2a-46f2fc1a95d7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(L\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.003302591274295945`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = ", 0.003302591274295945],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899133663*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"6b80d935-c8cb-4c03-9f62-7e0f224fed97"],

Cell[BoxData["\<\"The amount of Y the user will receive\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899134674*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"04c9a361-e956-4014-8a83-d16514dca149"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(Y\\)]\\) = \
\"\>", "\[InvisibleSpace]", "0.3933451858828546`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\) = ", 0.3933451858828546],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899135654*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"8b4080ac-7859-483e-b48a-91c40741849a"],

Cell[BoxData["\<\"The effective price the user paid is then:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991366653`*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"410e58f2-f41a-4ed2-bafc-d69374f2ea0d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(P\\), \\(eff\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.8903852377211807`"}],
  SequenceForm["\!\(\*SubscriptBox[\(P\), \(eff\)]\) = ", 0.8903852377211807],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991376333`*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"4fcfa300-7788-4755-9788-3730b656496c"],

Cell[BoxData["\<\"Computing the new L using new X reserve:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899138603*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"a2dc8212-8356-43f0-bbab-fca15db6ce4d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(givenX\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "2.495243192385952`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(L\), \(givenX\)]\) = ", 2.495243192385952],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899139488*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"e132c861-e82d-4225-9782-aef962d47cf3"],

Cell[BoxData["\<\"Computing the new L using new Y reserve:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899140421*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"3fec5605-03cf-49c8-983d-7580193ce6cf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(givenY\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "2.495243192385952`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(L\), \(givenY\)]\) = ", 2.495243192385952],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899141301*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"53138044-261c-4257-945b-f7ff06751bc6"],

Cell[BoxData["\<\"Computing the new price given the new X reserve:\"\>"], \
"Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899142212*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"4c61d558-3264-44fe-9fa1-080e606396a6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", "0.8000000000000002`"}],
  SequenceForm["S = ", 0.8000000000000002],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991430807`*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"32cbec5b-d853-4bd5-8d4b-b8a4a03bdbb9"],

Cell[BoxData["\<\"Computing the new price given the new Y reserve:\"\>"], \
"Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899143965*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"ef3e92eb-e244-4b4c-8389-6da0977f1e87"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", "0.7999999999999999`"}],
  SequenceForm["S = ", 0.7999999999999999],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.910269899144867*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"8d507544-7c0b-4b7c-8645-bef86611df80"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Test", " ", "a", " ", "value", " ", "that", " ", "we", " ", "got", " ", 
    "from", " ", "above", " ", "here"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"newPriceY", ":=", "1.1"}], ";"}], "\n", 
   RowBox[{"tenderY", ":=", 
    RowBox[{"arbY", "[", 
     RowBox[{"newPriceY", ",", 
      SubscriptBox["y", "0"], ",", 
      RowBox[{
       SubscriptBox["L", "Y"], "[", 
       RowBox[{
        SubscriptBox["y", "0"], ",", 
        SubscriptBox["S", "0"]}], "]"}]}], "]"}]}], "\n", 
   RowBox[{
   "Print", "[", "\"\<We are tendering the following amount of Y:\>\"", "]"}],
    "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\) = \>\"", ",", " ", 
     "tenderY"}], "]"}], "\n", 
   RowBox[{
   "Print", "[", 
    "\"\<After applying the fee, we will have the following X \
reinvested:\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Yy"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", "\[CapitalDelta]"}]}], 
    ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Yy"], "[", "tenderY", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Swap", " ", "in", " ", "X", " ", "with", " ", "fee", " ", "chosen", " ", 
     "above"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Delta]", "Ly"], "[", "\[CapitalDelta]_", "]"}], ":=", 
    " ", 
    RowBox[{
     SubscriptBox["L", "Y"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", "Y"], "[", "\[CapitalDelta]", "]"}], ",", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"This", " ", "can", " ", "be", " ", "simplified"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Delta]", "Xy"], "[", "\[CapitalDelta]_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Ly"], "[", "\[CapitalDelta]", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"gaussianCDF", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"Log", "[", 
           FractionBox[
            SubscriptBox["S", "0"], "K"], "]"}], "\[Sigma]"], "+", 
         RowBox[{
          FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], ")"}]}]}], "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective amount of Y reinvested is:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(x\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Xy"], "[", "tenderY", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective amount of liquidity reinvested is:\>\"", 
    "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Ly"], "[", "tenderY", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{
   "Print", "[", "\"\<The amount of X the user will receive\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "X"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "0"], "+", 
         RowBox[{
          SubscriptBox["L", "Y"], "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Delta]", "Y"], "[", "\[CapitalDelta]", "]"}], ",", 
           SubscriptBox["S", "0"]}], "]"}]}], ")"}], "*", 
       RowBox[{"gaussianCDF", "[", 
        RowBox[{
         RowBox[{"-", "\[Sigma]"}], "-", 
         RowBox[{"gaussianPPF", "[", 
          FractionBox[
           RowBox[{
            SubscriptBox["y", "0"], "+", "\[CapitalDelta]"}], 
           RowBox[{"K", "*", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["L", "0"], "+", 
              RowBox[{
               SubscriptBox["L", "Y"], "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Delta]", "Y"], "[", "\[CapitalDelta]", "]"}],
                 ",", 
                SubscriptBox["S", "0"]}], "]"}]}], ")"}]}]], "]"}]}], "]"}]}],
       "-", 
      SubscriptBox["x", "0"]}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\) = \>\"", ",", " ", 
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "X"], "[", "tenderY", "]"}]}]}], "]"}],
    "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective price the user paid is then:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(P\), \(eff\)]\) = \>\"", ",", " ", 
     FractionBox[
      RowBox[{"-", "tenderY"}], 
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "X"], "[", "tenderY", "]"}]]}], "]"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"What", " ", "are", " ", "the", " ", "liquidities"}], " ", "*)"}],
    "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new L using new X reserve:\>\"", "]"}], 
   "\n", 
   RowBox[{
    SubscriptBox["L", "givenX"], ":=", " ", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "0"], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "Xx"], "[", "tenderY", "]"}]}], ",", " ", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(givenX\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "givenX"]}], "]"}], "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new L using new Y reserve:\>\"", "]"}], 
   "\n", 
   RowBox[{
    SubscriptBox["L", "givenY"], ":=", 
    RowBox[{
     SubscriptBox["L", "Y"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["y", "0"], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "Yy"], "[", "tenderY", "]"}]}], ",", " ", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(givenY\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "givenY"]}], "]"}], "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new price given the new X reserve:\>\"", 
    "]"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Now", " ", "what", " ", "is", " ", "the", " ", 
     RowBox[{"price", "?", " ", "Should"}], " ", "be", " ", "0.9"}], " ", 
    "*)"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<S = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "X"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "0"], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "X"], "[", "tenderY", "]"}]}], ",", 
       SubscriptBox["L", "givenX"]}], "]"}]}], "]"}], "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new price given the new Y reserve:\>\"", 
    "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<S = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "Y"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "0"], "+", "tenderY"}], ",", 
       SubscriptBox["L", "givenY"]}], "]"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQraARnnBB7q3jupDYdBDtLj83F0Sf2hdSBaJTXsu0
guieXUumgmgzwymzQLQk4/25ILrovO4iEG3sYrUJrC5pxn8QLXArnekikN65
TJ4dRPcnmQiDaIdf141AtN6D52B6+rGnsSB6zZbTcSB6XbPiebC6Wf8ugehL
giJ3QLTrCe2HILrYuvs1iN48ff9HEG1u3vsNRBssZP8OoptM/vUcl3/raOSX
tAxEi631OQSi+doaD4Noh2nbz4Hoc5LHLoJoJkWuayD6T9jnGyDaJtey6QSQ
PnJpfweITkoz6QfROh7np4HoVK1rc0D0ApnaBSAaAHwNpQQ=
  "],
 CellLabel->"In[48]:=",ExpressionUUID->"9bf9bebe-962a-46aa-86cc-a308ddbc4fb0"],

Cell[CellGroupData[{

Cell[BoxData["\<\"We are tendering the following amount of Y:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"e94fcb6f-839d-4fb7-90e1-fcf75eba96ab"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(Y\\)]\\) = \
\"\>", "\[InvisibleSpace]", "0.1876414453748587`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\) = ", 0.1876414453748587],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900683607*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"6b8a62e6-d432-4dc9-946f-66301d6c2531"],

Cell[BoxData["\<\"After applying the fee, we will have the following X \
reinvested:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900684969*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"9f9b4e9c-358a-4919-b1ab-ac585ea34427"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(Y\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.0005629243361245765`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = ", 0.0005629243361245765],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900685903*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"80e2a3eb-c147-473d-af6c-019acccf9ceb"],

Cell[BoxData["\<\"The effective amount of Y reinvested is:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900686844*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"b504fbda-cf52-4da3-8047-b518b82dda3a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(x\\)]\\) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"1.`", " ", 
    RowBox[{
     SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`", "]"}]}]}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(x\)]\) = ", 1. 
   Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900687751*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"bd6fe72e-b03c-4bca-920f-d3eee4972aa5"],

Cell[BoxData["\<\"The effective amount of liquidity reinvested is:\"\>"], \
"Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.9102699006887836`*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"b930be08-5de9-4d0d-841a-905cde87c4bb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(L\\)]\\) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"2.4919406011116556`", " ", 
    RowBox[{
     SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`", "]"}]}]}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = ", 2.4919406011116556` 
   Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900689692*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"0a0b1b27-4753-44e4-b77a-77d08a0488b4"],

Cell[BoxData["\<\"The amount of X the user will receive\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900690639*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"c1c0b87d-49bb-44e5-9977-10ab9751e63e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(X\\)]\\) = \
\"\>", "\[InvisibleSpace]", 
   TemplateBox[{
     RowBox[{"1", "-", 
       RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"Erfc", "[", 
           FractionBox[
            RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
              RowBox[{
                SqrtBox["2"], " ", 
                RowBox[{"InverseErfc", "[", 
                  FractionBox["2.3752828907497174`", 
                   RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}]], "]"}]}]}], 
            SqrtBox["2"]], "]"}], " ", 
         RowBox[{"(", 
           RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
             RowBox[{"2.4919406011116556`", " ", 
               RowBox[{
                 SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`", 
                 "]"}]}]}], ")"}]}]}], 
     RowBox[{"0", "\[LessEqual]", 
       FractionBox["1.1876414453748587`", 
        RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
          RowBox[{"2.4919406011116556`", " ", 
            RowBox[{
              SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`", 
              "]"}]}]}]], "\[LessEqual]", "1"}]},
    "ConditionalExpression"]}],
  SequenceForm["\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\) = ", 
   ConditionalExpression[
   1 + Rational[-1, 2] 
     Erfc[2^Rational[-1, 2] (0.5 - 2^Rational[1, 2] 
        InverseErfc[
         2.3752828907497174`/(2.4919406011116556` + 
          2.4919406011116556` 
           Subscript[$CellContext`\[Delta], $CellContext`Y][
            0.1876414453748587])])] (2.4919406011116556` + 
      2.4919406011116556` 
       Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]), 
    0 <= 1.1876414453748587`/(2.4919406011116556` + 
     2.4919406011116556` 
      Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]) <= 
    1]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900716136*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"6683a4de-6f98-4687-b717-8f211d6fbfeb"],

Cell[BoxData["\<\"The effective price the user paid is then:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900719871*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"6d4ed0fa-eb90-4d67-8328-ad70a00b977b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(P\\), \\(eff\\)]\\) = \"\>", 
   "\[InvisibleSpace]", 
   TemplateBox[{
     RowBox[{"-", 
       FractionBox["0.1876414453748587`", 
        RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
            FractionBox["1", "2"], " ", 
            RowBox[{"Erfc", "[", 
              FractionBox[
               RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
                 RowBox[{
                   SqrtBox["2"], " ", 
                   RowBox[{"InverseErfc", "[", 
                    FractionBox["2.3752828907497174`", 
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}]], "]"}]}]}], 
               SqrtBox["2"]], "]"}], " ", 
            RowBox[{"(", 
              RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
                RowBox[{"2.4919406011116556`", " ", 
                  RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}], ")"}]}]}]]}], 
     RowBox[{"0", "\[LessEqual]", 
       FractionBox["1.1876414453748587`", 
        RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
          RowBox[{"2.4919406011116556`", " ", 
            RowBox[{
              SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`", 
              "]"}]}]}]], "\[LessEqual]", "1"}]},
    "ConditionalExpression"]}],
  SequenceForm["\!\(\*SubscriptBox[\(P\), \(eff\)]\) = ", 
   ConditionalExpression[(-0.1876414453748587)/(-1 + 
    Rational[1, 2] 
     Erfc[2^Rational[-1, 2] (0.5 - 2^Rational[1, 2] 
        InverseErfc[
         2.3752828907497174`/(2.4919406011116556` + 
          2.4919406011116556` 
           Subscript[$CellContext`\[Delta], $CellContext`Y][
            0.1876414453748587])])] (2.4919406011116556` + 
      2.4919406011116556` 
       Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587])),
     0 <= 1.1876414453748587`/(2.4919406011116556` + 
     2.4919406011116556` 
      Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]) <= 
    1]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.9102699007207413`*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"053d181b-549e-4f7a-ba6a-e7dc57e1ac8a"],

Cell[BoxData["\<\"Computing the new L using new X reserve:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900722311*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"5cbd06c0-366d-4dc5-b3bc-fd35afaeca75"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(givenX\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "2.493343375120198`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(L\), \(givenX\)]\) = ", 2.493343375120198],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900723043*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"a35f4449-94fe-4c27-833b-46f6275d0048"],

Cell[BoxData["\<\"Computing the new L using new Y reserve:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.9102699007238073`*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"22b5cfe5-2fe8-40d5-9aa5-1ad9d31a359a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(givenY\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "2.493343375120198`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(L\), \(givenY\)]\) = ", 2.493343375120198],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.9102699007245207`*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"2c62c9e0-1b61-4cfa-a141-92a7f954de05"],

Cell[BoxData["\<\"Computing the new price given the new X reserve:\"\>"], \
"Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900725246*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"ae3a25b0-b899-4e1c-b91a-eabd6f8c4175"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", 
   TemplateBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
        RowBox[{"-", "0.125`"}], "-", 
        RowBox[{"0.7071067811865476`", " ", 
          RowBox[{"InverseErfc", "[", 
            RowBox[{"2", " ", 
              RowBox[{"(", 
                RowBox[{"1", "-", 
                  RowBox[{"0.2005339517168975`", " ", 
                    RowBox[{"Erfc", "[", 
                    FractionBox[
                    RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
                    RowBox[{
                    SqrtBox["2"], " ", 
                    RowBox[{"InverseErfc", "[", 
                    FractionBox["2.3752828907497174`", 
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}]], "]"}]}]}], 
                    SqrtBox["2"]], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]", "+", 
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}], ")"}]}]}], ")"}]}], "]"}]}]}]], 
     InterpretationBox[
      DynamicModuleBox[{Typeset`open = False}, 
       TemplateBox[{"Expression", 
         StyleBox[
          TagBox[
           TooltipBox["\"condition\"", 
            TagBox[
             RowBox[{
               RowBox[{"0", "\[LessEqual]", 
                 RowBox[{"1", "-", 
                   RowBox[{"0.2005339517168975`", " ", 
                    RowBox[{"Erfc", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"0.5`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{
                    SqrtBox["2"], " ", 
                    RowBox[{"InverseErfc", "[", 
                    FractionBox["2.3752828907497174`", 
                    RowBox[{
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}]], "]"}]}]}], 
                    SqrtBox["2"]], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}], ")"}]}]}], "\[LessEqual]", "1"}], "&&", 
               RowBox[{"0", "\[LessEqual]", 
                 FractionBox["1.1876414453748587`", 
                  RowBox[{
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}]], "\[LessEqual]", "1"}], "&&", 
               RowBox[{"0", "\[LessEqual]", 
                 FractionBox["1.1876414453748587`", 
                  RowBox[{
                    RowBox[{"2.4919406011116556`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"2.4919406011116556`", " ", 
                    RowBox[{
                    SubscriptBox["\[Delta]", "Y"], "[", "0.1876414453748587`",
                     "]"}]}]}]], "\[LessEqual]", "1"}]}], Short[#, 7]& ]], 
           Annotation[#, 
            Short[
             And[
             0 <= 1 - 0.2005339517168975 
               Erfc[2^Rational[-1, 2] (0.5 - 2^Rational[1, 2] 
                  InverseErfc[
                   2.3752828907497174`/(2.4919406011116556` + 
                    2.4919406011116556` 
                    Subscript[$CellContext`\[Delta], $CellContext`Y][
                    0.1876414453748587])])] (2.4919406011116556` + 
                2.4919406011116556` 
                 Subscript[$CellContext`\[Delta], $CellContext`Y][
                  0.1876414453748587]) <= 1, 0 <= 
              1.1876414453748587`/(2.4919406011116556` + 
               2.4919406011116556` 
                Subscript[$CellContext`\[Delta], $CellContext`Y][
                 0.1876414453748587]) <= 1, 0 <= 
              1.1876414453748587`/(2.4919406011116556` + 
               2.4919406011116556` 
                Subscript[$CellContext`\[Delta], $CellContext`Y][
                 0.1876414453748587]) <= 1], 7], "Tooltip"]& ], 
          "IconizedCustomName", StripOnInput -> False], 
         GridBox[{{
            RowBox[{
              TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
              TagBox["And", "IconizedItem"]}]}, {
            RowBox[{
              TagBox["\"Byte count: \"", "IconizedLabel"], 
              "\[InvisibleSpace]", 
              TagBox["2552", "IconizedItem"]}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
          "Column", 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
         Dynamic[Typeset`open]}, "IconizedObject"]], 
      And[
      0 <= 1 - 0.2005339517168975 
        Erfc[2^Rational[-1, 2] (0.5 - 2^Rational[1, 2] 
           InverseErfc[
            2.3752828907497174`/(2.4919406011116556` + 
             2.4919406011116556` 
              Subscript[$CellContext`\[Delta], $CellContext`Y][
               0.1876414453748587])])] (2.4919406011116556` + 
         2.4919406011116556` 
          Subscript[$CellContext`\[Delta], $CellContext`Y][
           0.1876414453748587]) <= 1, 0 <= 
       1.1876414453748587`/(2.4919406011116556` + 
        2.4919406011116556` 
         Subscript[$CellContext`\[Delta], $CellContext`Y][
          0.1876414453748587]) <= 1, 0 <= 
       1.1876414453748587`/(2.4919406011116556` + 
        2.4919406011116556` 
         Subscript[$CellContext`\[Delta], $CellContext`Y][
          0.1876414453748587]) <= 1], SelectWithContents -> True, Selectable -> 
      False]},
    "ConditionalExpression"]}],
  SequenceForm["S = ", 
   ConditionalExpression[
   E^(-0.125 - 0.7071067811865476 
     InverseErfc[
      2 (1 - 0.2005339517168975 
        Erfc[2^Rational[-1, 2] (0.5 - 2^Rational[1, 2] 
           InverseErfc[
            2.3752828907497174`/(2.4919406011116556` + 
             2.4919406011116556` 
              Subscript[$CellContext`\[Delta], $CellContext`Y][
               0.1876414453748587])])] (2.4919406011116556` + 
         2.4919406011116556` 
          Subscript[$CellContext`\[Delta], $CellContext`Y][
           0.1876414453748587]))]), 
    And[0 <= 
     1 - 0.2005339517168975 
      Erfc[2^Rational[-1, 2] (0.5 - 2^Rational[1, 2] 
         InverseErfc[
          2.3752828907497174`/(2.4919406011116556` + 
           2.4919406011116556` 
            Subscript[$CellContext`\[Delta], $CellContext`Y][
             0.1876414453748587])])] (2.4919406011116556` + 
       2.4919406011116556` 
        Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]) <= 
     1, 0 <= 1.1876414453748587`/(2.4919406011116556` + 
      2.4919406011116556` 
       Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]) <= 
     1, 0 <= 1.1876414453748587`/(2.4919406011116556` + 
      2.4919406011116556` 
       Subscript[$CellContext`\[Delta], $CellContext`Y][0.1876414453748587]) <= 
     1]]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900726268*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"d049544a-0a55-4300-8c90-6f84940a4038"],

Cell[BoxData["\<\"Computing the new price given the new Y reserve:\"\>"], \
"Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900742687*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"a9096cbf-c613-4c26-a365-de53d58fb5cf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", "1.1`"}],
  SequenceForm["S = ", 1.1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900743415*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"a0147377-3e3b-42b1-8156-a321e8b38d56"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"L", "[", 
    RowBox[{"K_", ",", " ", "\[Sigma]_", ",", " ", "\[Tau]_"}], "]"}], ":=", 
   FractionBox["x", 
    RowBox[{"1", "-", 
     RowBox[{"gaussianCDF", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox["S", "K"], "]"}], 
        RowBox[{"\[Sigma]", " ", "*", " ", 
         RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]], "+", 
       RowBox[{
        FractionBox["1", "2"], "\[Sigma]", "*", 
        RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]}], "]"}]}]]}], ";"}]], "Code",
 CellChangeTimes->{{3.909284232761074*^9, 3.909284311581963*^9}},
 CellLabel->
  "In[2292]:=",ExpressionUUID->"4b5af426-135f-4a74-9da3-771d1103714c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"k", ",", "v", ",", "\[Tau]"}], "]"}], ",", " ", "\[Tau]"}], 
   "]"}], "]"}]], "Code",
 CellChangeTimes->{{3.90928432250084*^9, 3.909284333437564*^9}, {
  3.909284512486307*^9, 3.909284540209017*^9}, {3.909284603343576*^9, 
  3.909284612257375*^9}, {3.90928530943178*^9, 3.90928533290548*^9}, {
  3.909285423256996*^9, 3.909285426149007*^9}},
 CellLabel->
  "In[2298]:=",ExpressionUUID->"50c66ca0-9c74-4d61-9f4b-df2d48548dec"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Log", "[", 
           FractionBox["S", "k"], "]"}]}]}], ")"}], "2"], 
      RowBox[{"8", " ", 
       SuperscriptBox["v", "2"], " ", "\[Tau]"}]]}]], " ", "x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["v", "2"], " ", "\[Tau]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Log", "[", 
       FractionBox["S", "k"], "]"}]}]}], ")"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", "v", " ", 
   SuperscriptBox["\[Tau]", 
    RowBox[{"3", "/", "2"}]], " ", 
   SuperscriptBox[
    RowBox[{"Erfc", "[", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Log", "[", 
         FractionBox["S", "k"], "]"}]}]}], 
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", "v", " ", 
       SqrtBox["\[Tau]"]}]], "]"}], "2"]}]]], "Output",
 CellChangeTimes->{
  3.9092845427099953`*^9, 3.9092847284270687`*^9, {3.909285319040761*^9, 
   3.909285333489358*^9}, 3.909285426726862*^9, 3.909285486420289*^9},
 CellLabel->
  "Out[2298]=",ExpressionUUID->"1ff2b6f1-79df-45c7-b33d-411cc0c1f570"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"k", ",", "v", ",", "\[Tau]"}], "]"}], ",", " ", "v"}], "]"}], 
  "]"}]], "Code",
 CellChangeTimes->{
  3.909286005138384*^9, {3.909286071218306*^9, 3.9092860773164062`*^9}},
 CellLabel->
  "In[2299]:=",ExpressionUUID->"da6f77ec-0263-4e0f-ae2e-65c443a57315"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Log", "[", 
           FractionBox["S", "k"], "]"}]}]}], ")"}], "2"], 
      RowBox[{"8", " ", 
       SuperscriptBox["v", "2"], " ", "\[Tau]"}]]}]], " ", 
   SqrtBox[
    FractionBox["2", "\[Pi]"]], " ", "x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["v", "2"], " ", "\[Tau]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Log", "[", 
       FractionBox["S", "k"], "]"}]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox["v", "2"], " ", 
   SqrtBox["\[Tau]"], " ", 
   SuperscriptBox[
    RowBox[{"Erfc", "[", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Log", "[", 
         FractionBox["S", "k"], "]"}]}]}], 
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", "v", " ", 
       SqrtBox["\[Tau]"]}]], "]"}], "2"]}]]], "Output",
 CellChangeTimes->{3.909286081302704*^9},
 CellLabel->
  "Out[2299]=",ExpressionUUID->"e1990e5f-a66a-4ff5-a461-0d0ffa1425f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"\[Kappa]", ",", "v", ",", "\[Tau]"}], "]"}], ",", " ", 
    "\[Kappa]"}], "]"}], "]"}]], "Code",
 CellChangeTimes->{{3.909286199444543*^9, 3.909286209054088*^9}},
 CellLabel->
  "In[2300]:=",ExpressionUUID->"4738d5dd-62e6-4329-9f10-aa51583081a4"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Log", "[", 
            FractionBox["S", "\[Kappa]"], "]"}]}]}], ")"}], "2"], 
       RowBox[{"8", " ", 
        SuperscriptBox["v", "2"], " ", "\[Tau]"}]]}]], " ", 
    SqrtBox[
     FractionBox["2", "\[Pi]"]], " ", "x"}], 
   RowBox[{"v", " ", "\[Kappa]", " ", 
    SqrtBox["\[Tau]"], " ", 
    SuperscriptBox[
     RowBox[{"Erfc", "[", 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Log", "[", 
          FractionBox["S", "\[Kappa]"], "]"}]}]}], 
       RowBox[{"2", " ", 
        SqrtBox["2"], " ", "v", " ", 
        SqrtBox["\[Tau]"]}]], "]"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.909286209687827*^9},
 CellLabel->
  "Out[2300]=",ExpressionUUID->"5d6626db-ee2a-47e3-98ee-214b11fe010e"]
}, Open  ]],

Cell["", "Item",
 CellChangeTimes->{
  3.9102698673316183`*^9},ExpressionUUID->"30f4a8e8-beca-49df-baea-\
8b81c8a2aeb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "a", " ", "root", " ", "for", " ", "changed", " ", 
    "parameters"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"computeSwapConstant", "[", 
      RowBox[{
      "x_", ",", "y_", ",", "L_", ",", "strike_", ",", "vol_", ",", "tau_"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"gaussianPPF", "[", 
       FractionBox["x", "L"], "]"}], "+", 
      RowBox[{"gaussianPPF", "[", 
       FractionBox["y", 
        RowBox[{"strike", "*", "L"}]], "]"}], "+", 
      RowBox[{"vol", "*", "tau"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialPrice", ":=", "2000"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialX", ":=", "5000"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialStrike", ":=", "1800"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialSigma", ":=", "0.05"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialTau", ":=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "fromX"], "[", 
     RowBox[{"x_", ",", "S_", ",", "K_", ",", "\[Sigma]_", ",", "\[Tau]_"}], 
     "]"}], ":=", 
    FractionBox["x", 
     RowBox[{"1", "-", 
      RowBox[{"gaussianCDF", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"Log", "[", 
          FractionBox["S", "K"], "]"}], 
         RowBox[{"\[Sigma]", "*", 
          RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]], "+", 
        RowBox[{
         FractionBox["1", "2"], "\[Sigma]", "*", 
         RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]}], "]"}]}]]}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["Y", "fromX"], "[", 
      RowBox[{"x_", ",", "S_", ",", "K_", ",", "\[Sigma]_", ",", "\[Tau]_"}], 
      "]"}], ":=", 
     RowBox[{"K", "*", 
      RowBox[{
       SubscriptBox["L", "fromX"], "[", 
       RowBox[{"x", ",", "S", ",", "K", ",", "\[Sigma]", ",", "\[Tau]"}], 
       "]"}], "*", 
      RowBox[{"gaussianCDF", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"Log", "[", 
          FractionBox["S", "K"], "]"}], 
         RowBox[{"\[Sigma]", "*", 
          RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]], "-", 
        RowBox[{
         FractionBox["1", "2"], "\[Sigma]", "*", 
         RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]}], "]"}]}]}], ";"}], "\n", 
   RowBox[{"initialL", ":=", 
    RowBox[{
     SubscriptBox["L", "fromX"], "[", 
     RowBox[{
     "initialX", ",", "initialPrice", ",", "initialStrike", ",", 
      "initialSigma", ",", "initialTau"}], "]"}]}], "\n", 
   RowBox[{"initialY", ":=", 
    RowBox[{
     SubscriptBox["Y", "fromX"], "[", 
     RowBox[{
     "initialX", ",", "initialPrice", ",", "initialStrike", ",", 
      "initialSigma", ",", "initialTau"}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Initial L = \>\"", ",", " ", "initialL"}], "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Initial Y = \>\"", ",", " ", "initialY"}], "]"}], "\n", "\n", 
   RowBox[{
    RowBox[{"newStrike", " ", "=", " ", "1801"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"newSigma", " ", "=", " ", "0.05"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"newTau", " ", "=", " ", "1"}], ";"}], "\n", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{"computeSwapConstant", "[", 
      RowBox[{
      "initialX", ",", " ", "initialY", ",", " ", "L", ",", " ", "newStrike", 
       ",", " ", "newSigma", ",", " ", "newTau"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"L", ",", " ", "initialL"}], "}"}]}], "]"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Desmos", " ", "Checks"}], " ", "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"initialX", ":=", "2"}], ";", "\n", 
     RowBox[{"initialY", ":=", "2.209"}], ";", "\n", 
     RowBox[{"initialStrike", ":=", "1"}], ";", "\n", 
     RowBox[{"initialSigma", ":=", "0.4"}], ";", "\n", 
     RowBox[{"initialTau", ":=", "1"}], ";", "\n", 
     RowBox[{"initialL", ":=", "5"}], ";"}], "*)"}]}]}]], "Code",
 CellChangeTimes->{{3.9102698717452183`*^9, 3.910269878705433*^9}, {
  3.910269917340452*^9, 3.910270513817072*^9}, {3.9102705893206577`*^9, 
  3.910270844573196*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"4ed370a8-51eb-433c-a04a-009252cccf10"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial L = \"\>", "\[InvisibleSpace]", "303126.1917495261`"}],
  
  SequenceForm["Initial L = ", 303126.1917495261],
  Editable->False]], "Print",
 CellChangeTimes->{{3.910270823726644*^9, 3.910270846743188*^9}},
 CellLabel->
  "During evaluation of \
In[177]:=",ExpressionUUID->"ea2565f1-89ce-4b90-9d31-6a29c59eb5f3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial Y = \"\>", "\[InvisibleSpace]", 
   "5.3544485224666595`*^8"}],
  SequenceForm["Initial Y = ", 5.3544485224666595`*^8],
  Editable->False]], "Print",
 CellChangeTimes->{{3.910270823726644*^9, 3.9102708467442827`*^9}},
 CellLabel->
  "During evaluation of \
In[177]:=",ExpressionUUID->"5a838f69-d7fd-4da5-b603-20cf9be1ce1f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"L", "\[Rule]", "302960.96753557195`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.910270515517971*^9, 3.910270692837224*^9, 3.910270750972248*^9, {
   3.910270823760948*^9, 3.910270846745335*^9}},
 CellLabel->
  "Out[192]=",ExpressionUUID->"0f463dd4-99fc-4915-aa7d-c21687db6ff9"]
}, Open  ]]
},
WindowSize->{2542, 2084},
WindowMargins->{{Automatic, 12}, {Automatic, 11}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 31, 2023)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "Users", "colin", 
   "Documents"}, "DarkMode.nb", CharacterEncoding -> "UTF-8"],
ExpressionUUID->"5448244f-f9d9-40b1-b507-d7b872b3fa95"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 930, 24, 148, "Code",ExpressionUUID->"c490899a-2f5d-40ab-a7d1-a5c9dca8c853"],
Cell[1494, 46, 2812, 94, 373, "Code",ExpressionUUID->"0e5528a2-b8c6-467a-844e-8c7716a97af3"],
Cell[4309, 142, 673, 15, 122, "Code",ExpressionUUID->"38327a6c-a04f-4af4-877c-b294ae062156"],
Cell[4985, 159, 1339, 36, 226, "Code",ExpressionUUID->"7d969c2b-e997-401d-b15b-a40e313196bc"],
Cell[CellGroupData[{
Cell[6349, 199, 809, 21, 96, "Code",ExpressionUUID->"8a8b8903-b1b9-4e57-ae98-7ba26b8f5c79"],
Cell[CellGroupData[{
Cell[7183, 224, 377, 9, 31, "Print",ExpressionUUID->"dc8b80d7-5b11-428d-aa0b-17c8f7a58316"],
Cell[7563, 235, 375, 9, 31, "Print",ExpressionUUID->"819ae34f-6934-408b-b25d-b4900bac7a69"]
}, Open  ]]
}, Open  ]],
Cell[7965, 248, 3624, 94, 342, "Code",ExpressionUUID->"1efdbee4-dd4b-4b95-89ef-b8a05144a40f"],
Cell[CellGroupData[{
Cell[11614, 346, 8958, 224, 1149, "Code",ExpressionUUID->"e81539e0-9c8f-4cc0-9aed-23ff71ff5ce5"],
Cell[CellGroupData[{
Cell[20597, 574, 1442, 21, 31, "Print",ExpressionUUID->"3bcc7f21-c481-4b7a-a49a-dab415c589b7"],
Cell[22042, 597, 1649, 27, 31, "Print",ExpressionUUID->"660519cd-fcfd-485f-a352-56a05383e2e6"],
Cell[23694, 626, 1463, 22, 31, "Print",ExpressionUUID->"098a1b4e-8ff0-4aad-a90e-b8e39ef97dcc"],
Cell[25160, 650, 1641, 27, 31, "Print",ExpressionUUID->"256894aa-279d-4bf8-8418-9b6620065af5"],
Cell[26804, 679, 1437, 21, 31, "Print",ExpressionUUID->"01a27006-44f3-4d49-869d-ce50c46b6e63"],
Cell[28244, 702, 1643, 27, 31, "Print",ExpressionUUID->"c0655bf5-59e9-4c99-afb2-2d886dbfdd8f"],
Cell[29890, 731, 1447, 22, 31, "Print",ExpressionUUID->"412c0738-d703-41d6-bf2a-46f2fc1a95d7"],
Cell[31340, 755, 1641, 27, 31, "Print",ExpressionUUID->"6b80d935-c8cb-4c03-9f62-7e0f224fed97"],
Cell[32984, 784, 1434, 21, 31, "Print",ExpressionUUID->"04c9a361-e956-4014-8a83-d16514dca149"],
Cell[34421, 807, 1649, 27, 31, "Print",ExpressionUUID->"8b4080ac-7859-483e-b48a-91c40741849a"],
Cell[36073, 836, 1441, 21, 31, "Print",ExpressionUUID->"410e58f2-f41a-4ed2-bafc-d69374f2ea0d"],
Cell[37517, 859, 1629, 27, 31, "Print",ExpressionUUID->"4fcfa300-7788-4755-9788-3730b656496c"],
Cell[39149, 888, 1437, 21, 31, "Print",ExpressionUUID->"a2dc8212-8356-43f0-bbab-fca15db6ce4d"],
Cell[40589, 911, 1631, 27, 35, "Print",ExpressionUUID->"e132c861-e82d-4225-9782-aef962d47cf3"],
Cell[42223, 940, 1437, 21, 31, "Print",ExpressionUUID->"3fec5605-03cf-49c8-983d-7580193ce6cf"],
Cell[43663, 963, 1631, 27, 35, "Print",ExpressionUUID->"53138044-261c-4257-945b-f7ff06751bc6"],
Cell[45297, 992, 1447, 22, 31, "Print",ExpressionUUID->"4c61d558-3264-44fe-9fa1-080e606396a6"],
Cell[46747, 1016, 1544, 25, 31, "Print",ExpressionUUID->"32cbec5b-d853-4bd5-8d4b-b8a4a03bdbb9"],
Cell[48294, 1043, 1447, 22, 31, "Print",ExpressionUUID->"ef3e92eb-e244-4b4c-8389-6da0977f1e87"],
Cell[49744, 1067, 1542, 25, 31, "Print",ExpressionUUID->"8d507544-7c0b-4b7c-8645-bef86611df80"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51335, 1098, 7742, 219, 1177, "Code",ExpressionUUID->"9bf9bebe-962a-46aa-86cc-a308ddbc4fb0"],
Cell[CellGroupData[{
Cell[59102, 1321, 466, 7, 31, "Print",ExpressionUUID->"e94fcb6f-839d-4fb7-90e1-fcf75eba96ab"],
Cell[59571, 1330, 675, 13, 31, "Print",ExpressionUUID->"6b8a62e6-d432-4dc9-946f-66301d6c2531"],
Cell[60249, 1345, 489, 8, 31, "Print",ExpressionUUID->"9f9b4e9c-358a-4919-b1ab-ac585ea34427"],
Cell[60741, 1355, 669, 13, 31, "Print",ExpressionUUID->"80e2a3eb-c147-473d-af6c-019acccf9ceb"],
Cell[61413, 1370, 463, 7, 31, "Print",ExpressionUUID->"b504fbda-cf52-4da3-8047-b518b82dda3a"],
Cell[61879, 1379, 808, 17, 31, "Print",ExpressionUUID->"bd6fe72e-b03c-4bca-920f-d3eee4972aa5"],
Cell[62690, 1398, 475, 8, 31, "Print",ExpressionUUID->"b930be08-5de9-4d0d-841a-905cde87c4bb"],
Cell[63168, 1408, 841, 17, 31, "Print",ExpressionUUID->"0a0b1b27-4753-44e4-b77a-77d08a0488b4"],
Cell[64012, 1427, 460, 7, 31, "Print",ExpressionUUID->"c1c0b87d-49bb-44e5-9977-10ab9751e63e"],
Cell[64475, 1436, 2568, 57, 82, "Print",ExpressionUUID->"6683a4de-6f98-4687-b717-8f211d6fbfeb"],
Cell[67046, 1495, 465, 7, 31, "Print",ExpressionUUID->"6d4ed0fa-eb90-4d67-8328-ad70a00b977b"],
Cell[67514, 1504, 2715, 60, 90, "Print",ExpressionUUID->"053d181b-549e-4f7a-ba6a-e7dc57e1ac8a"],
Cell[70232, 1566, 463, 7, 31, "Print",ExpressionUUID->"5cbd06c0-366d-4dc5-b3bc-fd35afaeca75"],
Cell[70698, 1575, 657, 13, 35, "Print",ExpressionUUID->"a35f4449-94fe-4c27-833b-46f6275d0048"],
Cell[71358, 1590, 465, 7, 31, "Print",ExpressionUUID->"22b5cfe5-2fe8-40d5-9aa5-1ad9d31a359a"],
Cell[71826, 1599, 659, 13, 35, "Print",ExpressionUUID->"2c62c9e0-1b61-4cfa-a141-92a7f954de05"],
Cell[72488, 1614, 473, 8, 31, "Print",ExpressionUUID->"ae3a25b0-b899-4e1c-b91a-eabd6f8c4175"],
Cell[72964, 1624, 8179, 179, 90, "Print",ExpressionUUID->"d049544a-0a55-4300-8c90-6f84940a4038"],
Cell[81146, 1805, 473, 8, 31, "Print",ExpressionUUID->"a9096cbf-c613-4c26-a365-de53d58fb5cf"],
Cell[81622, 1815, 538, 11, 31, "Print",ExpressionUUID->"a0147377-3e3b-42b1-8156-a321e8b38d56"]
}, Open  ]]
}, Open  ]],
Cell[82187, 1830, 709, 19, 83, "Code",ExpressionUUID->"4b5af426-135f-4a74-9da3-771d1103714c"],
Cell[CellGroupData[{
Cell[82921, 1853, 541, 12, 43, "Code",ExpressionUUID->"50c66ca0-9c74-4d61-9f4b-df2d48548dec"],
Cell[83465, 1867, 1418, 44, 111, "Output",ExpressionUUID->"1ff2b6f1-79df-45c7-b33d-411cc0c1f570"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84920, 1916, 372, 10, 43, "Code",ExpressionUUID->"da6f77ec-0263-4e0f-ae2e-65c443a57315"],
Cell[85295, 1928, 1281, 42, 113, "Output",ExpressionUUID->"e1990e5f-a66a-4ff5-a461-0d0ffa1425f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86613, 1975, 361, 9, 43, "Code",ExpressionUUID->"4738d5dd-62e6-4329-9f10-aa51583081a4"],
Cell[86977, 1986, 1141, 35, 113, "Output",ExpressionUUID->"5d6626db-ee2a-47e3-98ee-214b11fe010e"]
}, Open  ]],
Cell[88133, 2024, 120, 3, 40, "Item",ExpressionUUID->"30f4a8e8-beca-49df-baea-8b81c8a2aeb9"],
Cell[CellGroupData[{
Cell[88278, 2031, 4170, 112, 795, "Code",ExpressionUUID->"4ed370a8-51eb-433c-a04a-009252cccf10"],
Cell[CellGroupData[{
Cell[92473, 2147, 368, 9, 31, "Print",ExpressionUUID->"ea2565f1-89ce-4b90-9d31-6a29c59eb5f3"],
Cell[92844, 2158, 380, 9, 33, "Print",ExpressionUUID->"5a838f69-d7fd-4da5-b603-20cf9be1ce1f"]
}, Open  ]],
Cell[93239, 2170, 319, 7, 33, "Output",ExpressionUUID->"0f463dd4-99fc-4915-aa7d-c21687db6ff9"]
}, Open  ]]
}
]
*)

