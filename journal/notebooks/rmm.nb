(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[     93797,       2127]
NotebookOptionsPosition[     86791,       2020]
NotebookOutlinePosition[     87388,       2040]
CellTagsIndexPosition[     87345,       2037]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Gaussian", " ", "CDF"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"gaussianCDF", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"CDF", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"0", ",", " ", "1"}], "]"}], ",", " ", "x"}], "]"}]}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Gaussian", " ", "PPF"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"gaussianPPF", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Quantile", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"0", ",", " ", "1"}], "]"}], ",", " ", "x"}], 
     "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.9084674257813168`*^9, 3.908467481719372*^9}, {
  3.9084675216212587`*^9, 3.908467546038982*^9}, {3.90846757908879*^9, 
  3.908467614530884*^9}},
 CellLabel->
  "In[509]:=",ExpressionUUID->"c490899a-2f5d-40ab-a7d1-a5c9dca8c853"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["L", "X"], "[", 
    RowBox[{"x_", ",", "S_"}], "]"}], ":=", 
   FractionBox["x", 
    RowBox[{"1", "-", 
     RowBox[{"gaussianCDF", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox["S", "K"], "]"}], "\[Sigma]"], "+", 
       RowBox[{
        FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["L", "Y"], "[", 
    RowBox[{"y_", ",", "S_"}], "]"}], ":=", 
   FractionBox["y", 
    RowBox[{"K", "*", 
     RowBox[{"gaussianCDF", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox["S", "K"], "]"}], "\[Sigma]"], "-", 
       RowBox[{
        FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"y_", ",", "S_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "Y"], "[", 
     RowBox[{"y", ",", "S"}], "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"gaussianCDF", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"Log", "[", 
          FractionBox["S", "K"], "]"}], "\[Sigma]"], "+", 
        RowBox[{
         FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Y", "[", 
    RowBox[{"x_", ",", "S_"}], "]"}], ":=", 
   RowBox[{"K", "*", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{"x", ",", "S"}], "]"}], "*", 
    RowBox[{"gaussianCDF", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox["S", "K"], "]"}], "\[Sigma]"], "-", 
      RowBox[{
       FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["P", "X"], "[", 
    RowBox[{"x_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"K", "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"gaussianPPF", "[", 
        RowBox[{"1", "-", 
         FractionBox["x", "L"]}], "]"}], "*", "\[Sigma]"}], "-", 
      RowBox[{
       FractionBox["1", "2"], 
       SuperscriptBox["\[Sigma]", "2"]}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["P", "Y"], "[", 
    RowBox[{"y_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"K", "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"gaussianPPF", "[", 
        FractionBox["y", 
         RowBox[{"K", "*", "L"}]], "]"}], "*", "\[Sigma]"}], "+", 
      RowBox[{
       FractionBox["1", "2"], 
       SuperscriptBox["\[Sigma]", "2"]}]}], "]"}]}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.908467621608725*^9, 3.908467735863633*^9}, {
  3.9089759722512827`*^9, 3.908975998886648*^9}},
 CellLabel->
  "In[511]:=",ExpressionUUID->"0e5528a2-b8c6-467a-844e-8c7716a97af3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Constants", " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]", ":=", "0.05"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"K", ":=", "1800"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Gamma]", ":=", "0.997"}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.9084680371821203`*^9, 3.908468094956563*^9}, {
  3.908470349190227*^9, 3.90847035824724*^9}, {3.908470640467009*^9, 
  3.908470651083271*^9}, {3.908962321915421*^9, 3.908962322267576*^9}, {
  3.908962366415097*^9, 3.9089623671545897`*^9}, {3.908962417752561*^9, 
  3.9089624186920137`*^9}, {3.9103706641081343`*^9, 3.910370686429817*^9}},
 CellLabel->
  "In[517]:=",ExpressionUUID->"38327a6c-a04f-4af4-877c-b294ae062156"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", "X", " ", "value"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["x", "0"], ":=", "5000"}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Initial", " ", "price"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["S", "0"], ":=", "2000"}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Amount", " ", "of", " ", "Y", " ", "for", " ", "this", " ", "price", " ",
      "and", " ", "X"}], " ", "*)"}], "\n", 
   RowBox[{
    SubscriptBox["y", "0"], ":=", 
    RowBox[{"Y", "[", 
     RowBox[{
      SubscriptBox["x", "0"], ",", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Initial Y: \>\"", ",", " ", 
     SubscriptBox["y", "0"]}], "]"}], "\n", 
   RowBox[{"(*", " ", "Liquidity", " ", "*)"}], "\n", 
   RowBox[{
    SubscriptBox["L", "0"], ":=", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{
      SubscriptBox["x", "0"], ",", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Initial Liquidity: \>\"", ",", " ", 
     SubscriptBox["L", "0"]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.908468373546104*^9, 3.9084685799434233`*^9}, {
  3.9084686112036858`*^9, 3.908468612883589*^9}, {3.908468683308464*^9, 
  3.908468734474468*^9}, {3.90846994004578*^9, 3.908469951539794*^9}, {
  3.90847000421662*^9, 3.908470006749341*^9}, {3.909022679810102*^9, 
  3.909022681399785*^9}, {3.9103706983254232`*^9, 3.9103707084586277`*^9}, {
  3.9103708208190937`*^9, 3.910370835349227*^9}, {3.910373316470625*^9, 
  3.910373328388739*^9}},
 CellLabel->
  "In[615]:=",ExpressionUUID->"7d969c2b-e997-401d-b15b-a40e313196bc"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial Y: \"\>", "\[InvisibleSpace]", 
   "5.3544485224666595`*^8"}],
  SequenceForm["Initial Y: ", 5.3544485224666595`*^8],
  Editable->False]], "Print",
 CellChangeTimes->{3.9103708365963593`*^9, 3.910373329032158*^9},
 CellLabel->
  "During evaluation of \
In[615]:=",ExpressionUUID->"f3a67110-6e21-4560-a3bf-19f4cbaed0db"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial Liquidity: \"\>", "\[InvisibleSpace]", 
   "303126.1917495261`"}],
  SequenceForm["Initial Liquidity: ", 303126.1917495261],
  Editable->False]], "Print",
 CellChangeTimes->{3.9103708365963593`*^9, 3.9103733290340137`*^9},
 CellLabel->
  "During evaluation of \
In[615]:=",ExpressionUUID->"07784bf5-76ac-4880-921b-84e90689fcb4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Quck", " ", "sanity", " ", "checks"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<This should print 1: \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "X"], "[", 
      RowBox[{
       SubscriptBox["x", "0"], ",", 
       SubscriptBox["L", "0"]}], "]"}]}], "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<This should print 1: \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "Y"], "[", 
      RowBox[{
       SubscriptBox["y", "0"], ",", 
       SubscriptBox["L", "0"]}], "]"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.908962773200364*^9, 3.908962811041506*^9}, {
  3.908976008296489*^9, 3.9089760811257973`*^9}},
 CellLabel->
  "In[524]:=",ExpressionUUID->"8a8b8903-b1b9-4e57-ae98-7ba26b8f5c79"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"This should print 1: \"\>", "\[InvisibleSpace]", "2000.`"}],
  SequenceForm["This should print 1: ", 2000.],
  Editable->False]], "Print",
 CellChangeTimes->{3.908976082572167*^9, 3.909025668931364*^9, 
  3.9102698961915703`*^9, 3.910276555933729*^9, 3.9103707130582857`*^9},
 CellLabel->
  "During evaluation of \
In[524]:=",ExpressionUUID->"579d84d4-2d66-4712-bdd4-20b035a944ae"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"This should print 1: \"\>", "\[InvisibleSpace]", 
   "1999.9999999999998`"}],
  SequenceForm["This should print 1: ", 1999.9999999999998`],
  Editable->False]], "Print",
 CellChangeTimes->{3.908976082572167*^9, 3.909025668931364*^9, 
  3.9102698961915703`*^9, 3.910276555933729*^9, 3.910370713059544*^9},
 CellLabel->
  "During evaluation of \
In[524]:=",ExpressionUUID->"a1c07174-c3ed-4331-bc76-9a67d862e76e"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Arb", " ", "calculations"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"arbX", "[", 
      RowBox[{"p_", ",", "x_", ",", "L_"}], "]"}], ":=", 
     FractionBox[
      RowBox[{
       RowBox[{"L", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"gaussianCDF", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"Log", "[", 
              FractionBox["p", "K"], "]"}], "\[Sigma]"], "+", 
            RowBox[{
             FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], ")"}]}], "-", 
       "x"}], 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "-", "1"}], ")"}], "*", 
        FractionBox[
         RowBox[{"1", "-", 
          RowBox[{"gaussianCDF", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"Log", "[", 
              FractionBox["p", "K"], "]"}], "\[Sigma]"], "+", 
            RowBox[{
             FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], 
         RowBox[{"1", "-", 
          RowBox[{"gaussianCDF", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"Log", "[", 
              FractionBox[
               SubscriptBox["S", "0"], "K"], "]"}], "\[Sigma]"], "+", 
            RowBox[{
             FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]]}]}]]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"arbY", "[", 
      RowBox[{"p_", ",", "y_", ",", "L_"}], "]"}], ":=", 
     FractionBox[
      RowBox[{
       RowBox[{"K", "*", "L", "*", 
        RowBox[{"gaussianCDF", "[", 
         RowBox[{
          FractionBox[
           RowBox[{"Log", "[", 
            FractionBox["p", "K"], "]"}], "\[Sigma]"], "-", 
          RowBox[{
           FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], "-", "y"}], 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "-", "1"}], ")"}], 
        FractionBox[
         RowBox[{"gaussianCDF", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["p", "K"], "]"}], "\[Sigma]"], "-", 
           RowBox[{
            FractionBox["1", "2"], "\[Sigma]"}]}], "]"}], 
         RowBox[{"gaussianCDF", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox[
              SubscriptBox["S", "0"], "K"], "]"}], "\[Sigma]"], "-", 
           RowBox[{
            FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]]}]}]]}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{{3.908469869746161*^9, 3.908469874456465*^9}, {
   3.908469966460216*^9, 3.9084699673930483`*^9}, {3.908470014741447*^9, 
   3.908470016059868*^9}, {3.9084710978099003`*^9, 3.9084711295094557`*^9}, 
   3.9084711698900547`*^9, {3.90847120602601*^9, 3.908471247223518*^9}, {
   3.908471281448723*^9, 3.908471367082285*^9}, {3.908472297530381*^9, 
   3.908472410924035*^9}, {3.908472525967081*^9, 3.9084725263795347`*^9}, {
   3.908472647857041*^9, 3.908472655134634*^9}, {3.908472698618392*^9, 
   3.9084728617947607`*^9}, {3.908962247915147*^9, 3.908962248388301*^9}, {
   3.908962905421812*^9, 3.9089629062637444`*^9}, {3.9089645920566*^9, 
   3.90896459533709*^9}, {3.908976692229253*^9, 3.908976695880341*^9}, {
   3.908976844868556*^9, 3.908976846911487*^9}, {3.908978192545518*^9, 
   3.908978253726102*^9}, {3.908978660030653*^9, 3.9089786769258137`*^9}, {
   3.908978827103158*^9, 3.9089788397352858`*^9}, {3.9089788752737007`*^9, 
   3.908978875659925*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"1efdbee4-dd4b-4b95-89ef-b8a05144a40f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Test", " ", "a", " ", "value", " ", "that", " ", "we", " ", "got", " ", 
    "from", " ", "above", " ", "here"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"newPriceX", ":=", "0.8"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"tenderX", ":=", 
     RowBox[{"arbX", "[", 
      RowBox[{"newPriceX", ",", 
       SubscriptBox["x", "0"], ",", 
       SubscriptBox["L", "0"]}], "]"}]}], "*)"}], "\n", 
   RowBox[{"tenderX", ":=", "500"}], "\n", 
   RowBox[{
   "Print", "[", "\"\<We are tendering the following amount of X:\>\"", "]"}],
    "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\) = \>\"", ",", " ", 
     "tenderX"}], "]"}], "\n", 
   RowBox[{
   "Print", "[", 
    "\"\<After applying the fee, we will have the following X \
reinvested:\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Xx"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", "\[CapitalDelta]"}]}], 
    ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(X\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Xx"], "[", "tenderX", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Swap", " ", "in", " ", "X", " ", "with", " ", "fee", " ", "chosen", " ", 
     "above"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]_", "]"}], ":=", 
    " ", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", "Xx"], "[", "\[CapitalDelta]", "]"}], ",", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"This", " ", "can", " ", "be", " ", "simplified"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Delta]", "Yx"], "[", "\[CapitalDelta]_", "]"}], ":=", 
    RowBox[{"K", "*", 
     RowBox[{
      SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]", "]"}], "*", 
     RowBox[{"gaussianCDF", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox[
          SubscriptBox["S", "0"], "K"], "]"}], "\[Sigma]"], "-", 
       RowBox[{
        FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}]}], "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective amount of Y reinvested is:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Yx"], "[", "tenderX", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective amount of liquidity reinvested is:\>\"", 
    "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Lx"], "[", "tenderX", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{
   "Print", "[", "\"\<The amount of Y the user will receive\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "Y"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"K", "*", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "0"], "+", 
         RowBox[{
          SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]", "]"}]}], 
        ")"}], "*", 
       RowBox[{"gaussianCDF", "[", 
        RowBox[{
         RowBox[{"-", "\[Sigma]"}], "-", 
         RowBox[{"gaussianPPF", "[", 
          FractionBox[
           RowBox[{
            SubscriptBox["x", "0"], "+", "\[CapitalDelta]"}], 
           RowBox[{
            SubscriptBox["L", "0"], "+", 
            RowBox[{
             SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]", "]"}]}]],
           "]"}]}], "]"}]}], "-", 
      SubscriptBox["y", "0"]}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\) = \>\"", ",", " ", 
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "Y"], "[", "tenderX", "]"}]}]}], "]"}],
    "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective price the user paid is then:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(P\), \(eff\)]\) = \>\"", ",", " ", 
     FractionBox[
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "Y"], "[", "tenderX", "]"}]}], 
      "tenderX"]}], "]"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"What", " ", "are", " ", "the", " ", "liquidities"}], " ", "*)"}],
    "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new L using new X reserve:\>\"", "]"}], 
   "\n", 
   RowBox[{
    SubscriptBox["L", "givenX"], ":=", " ", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "0"], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "Xx"], "[", "tenderX", "]"}]}], ",", " ", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(givenX\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "givenX"]}], "]"}], "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new L using new Y reserve:\>\"", "]"}], 
   "\n", 
   RowBox[{
    SubscriptBox["L", "givenY"], ":=", 
    RowBox[{
     SubscriptBox["L", "Y"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["y", "0"], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "Yx"], "[", "tenderX", "]"}]}], ",", " ", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(givenY\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "givenY"]}], "]"}], "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new price given the new X reserve:\>\"", 
    "]"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Now", " ", "what", " ", "is", " ", "the", " ", 
     RowBox[{"price", "?", " ", "Should"}], " ", "be", " ", "0.9"}], " ", 
    "*)"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<S = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "X"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "0"], "+", "tenderX"}], ",", 
       SubscriptBox["L", "givenX"]}], "]"}]}], "]"}], "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new price given the new Y reserve:\>\"", 
    "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<S = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "Y"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "0"], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "Y"], "[", "tenderX", "]"}]}], ",", 
       SubscriptBox["L", "givenY"]}], "]"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.9084686067941647`*^9, 3.908468677383553*^9}, {
   3.908468740698229*^9, 3.9084689324869547`*^9}, {3.908469407393499*^9, 
   3.90846948258585*^9}, {3.9084697453831453`*^9, 3.908469751400042*^9}, {
   3.90847002453519*^9, 3.908470095084703*^9}, {3.90847012516411*^9, 
   3.90847012730599*^9}, {3.908470389531291*^9, 3.9084706207048197`*^9}, {
   3.908470657120466*^9, 3.9084706819852057`*^9}, {3.908470713721982*^9, 
   3.9084707434513493`*^9}, {3.908470775377922*^9, 3.908470779431653*^9}, {
   3.908470827127829*^9, 3.908470836810878*^9}, {3.908471144978223*^9, 
   3.908471148613662*^9}, {3.908471342374304*^9, 3.908471396516526*^9}, {
   3.908471492879197*^9, 3.908471515719439*^9}, {3.908472220030443*^9, 
   3.9084722939922533`*^9}, {3.908472406536892*^9, 3.9084724386581182`*^9}, {
   3.908472792423646*^9, 3.908472793603929*^9}, {3.908962003290093*^9, 
   3.908962037676124*^9}, {3.908962097133566*^9, 3.908962173336836*^9}, {
   3.90896220971637*^9, 3.908962215271048*^9}, {3.908962268479413*^9, 
   3.90896229916632*^9}, 3.9089623337569313`*^9, {3.908962379639881*^9, 
   3.908962388938654*^9}, {3.9089624572707443`*^9, 3.9089624721040583`*^9}, {
   3.908962510704714*^9, 3.908962524338188*^9}, {3.908962555054682*^9, 
   3.90896256203594*^9}, {3.908962820059133*^9, 3.908962898754694*^9}, {
   3.9089629575319777`*^9, 3.90896307969725*^9}, {3.9089631418064203`*^9, 
   3.908963173466034*^9}, {3.908963258525576*^9, 3.9089633224402733`*^9}, {
   3.908963367994213*^9, 3.908963461202013*^9}, {3.908963609379298*^9, 
   3.908963933535779*^9}, {3.908964139664143*^9, 3.9089641709875937`*^9}, {
   3.90896426104887*^9, 3.908964413991126*^9}, 3.908964543677549*^9, 
   3.908964586086096*^9, {3.908976159020768*^9, 3.908976159227566*^9}, {
   3.908976470413172*^9, 3.908976481004795*^9}, {3.908976522067993*^9, 
   3.908976654910138*^9}, {3.908976734310645*^9, 3.908976786321085*^9}, {
   3.908976970992345*^9, 3.908977362278446*^9}, {3.908977545063843*^9, 
   3.908977618765689*^9}, {3.90897787977813*^9, 3.908977904800407*^9}, {
   3.9090235637726593`*^9, 3.9090235739352627`*^9}, 3.909025650712202*^9, {
   3.910370726710269*^9, 3.910370736995474*^9}},
 CellLabel->
  "In[526]:=",ExpressionUUID->"e81539e0-9c8f-4cc0-9aed-23ff71ff5ce5"],

Cell[CellGroupData[{

Cell[BoxData["\<\"We are tendering the following amount of X:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.9103707410788193`*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"2b9f0464-6007-4e3d-a9d9-a19181f890a5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(X\\)]\\) = \
\"\>", "\[InvisibleSpace]", "500"}],
  SequenceForm["\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\) = ", 500],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741080847*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"19221afb-07b8-43dc-8144-a123ab8c47cb"],

Cell[BoxData["\<\"After applying the fee, we will have the following X \
reinvested:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741082594*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"476d2b34-2def-4d1b-a41d-9711b5ec994f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(X\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "1.5000000000000013`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(X\)]\) = ", 1.5000000000000013`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741083696*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"ff9f609f-2f9f-435c-bd63-e30a3b8d2bd5"],

Cell[BoxData["\<\"The effective amount of Y reinvested is:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741084827*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"562d84f2-edd0-4953-b560-233714f9c844"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(Y\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "160633.4556739999`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = ", 160633.4556739999],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741085937*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"dbde9d6b-8b39-4ed3-952e-1e54dff44600"],

Cell[BoxData["\<\"The effective amount of liquidity reinvested is:\"\>"], \
"Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741087143*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"bebd1da2-d74e-42ad-b117-54c7bb0939dc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(L\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "90.93785752485789`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = ", 90.93785752485789],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.9103707410881567`*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"ea79b3d0-6452-4331-b213-03731e8b8604"],

Cell[BoxData["\<\"The amount of Y the user will receive\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741089158*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"d546d5c7-4918-4bc6-a889-c3c9a6c86756"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(Y\\)]\\) = \
\"\>", "\[InvisibleSpace]", "835396.8917782903`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\) = ", 835396.8917782903],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741090096*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"28e26a4c-22c3-4f90-a691-c424e7c035f0"],

Cell[BoxData["\<\"The effective price the user paid is then:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.9103707410910788`*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"ebab0655-69a6-40d5-8220-be240f2d44e9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(P\\), \\(eff\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "1670.7937835565806`"}],
  SequenceForm["\!\(\*SubscriptBox[\(P\), \(eff\)]\) = ", 1670.7937835565806`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741092017*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"66b0406c-6ff5-461a-a0b8-4a26bbe10b2e"],

Cell[BoxData["\<\"Computing the new L using new X reserve:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.91037074109301*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"6e3da5e0-4926-4a34-a9c0-6f09fe0e067a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(givenX\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "303217.1296070509`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(L\), \(givenX\)]\) = ", 303217.1296070509],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741093965*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"093fd778-9331-435d-be22-d8de485a35ba"],

Cell[BoxData["\<\"Computing the new L using new Y reserve:\"\>"], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741094945*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"0b53b7f4-9de0-4bda-b942-e35ecfa3e8ee"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(givenY\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "303217.1296070509`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(L\), \(givenY\)]\) = ", 303217.1296070509],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741095879*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"01869dbd-76d4-4a11-b486-911e9e1905d1"],

Cell[BoxData["\<\"Computing the new price given the new X reserve:\"\>"], \
"Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741096911*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"179cead1-c23e-438d-9b0b-7c7566209019"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", "1996.1628410033063`"}],
  SequenceForm["S = ", 1996.1628410033063`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741097826*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"d4f250c9-09f4-49b1-bfad-09f3d9bf1456"],

Cell[BoxData["\<\"Computing the new price given the new Y reserve:\"\>"], \
"Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741098691*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"58dab9a6-261d-4454-8a28-48feb901bca5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", "1996.1628410033063`"}],
  SequenceForm["S = ", 1996.1628410033063`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.908963270263609*^9, {3.908963304399385*^9, 3.9089633231904707`*^9}, 
   3.908963416199234*^9, {3.908963451498691*^9, 3.90896346218254*^9}, {
   3.908963618076185*^9, 3.908963640559702*^9}, {3.908963702234438*^9, 
   3.908963722278123*^9}, {3.908963760766817*^9, 3.90896381961022*^9}, {
   3.9089638498244534`*^9, 3.908963861671217*^9}, {3.908963892555255*^9, 
   3.9089639347653008`*^9}, {3.908964143291018*^9, 3.908964172990427*^9}, {
   3.9089643555840797`*^9, 3.908964416111692*^9}, 3.908964545891534*^9, {
   3.908964587998259*^9, 3.9089645972077913`*^9}, 3.908975955880533*^9, {
   3.908976090929585*^9, 3.9089761066198072`*^9}, 3.908976281842781*^9, {
   3.908976596976282*^9, 3.908976655848523*^9}, 3.908976699125703*^9, {
   3.908976761501348*^9, 3.908976779960833*^9}, {3.908976849191225*^9, 
   3.908976864790901*^9}, {3.90897710098203*^9, 3.908977135963718*^9}, 
   3.908977190585826*^9, 3.908977220722659*^9, {3.908977320339306*^9, 
   3.908977363124432*^9}, 3.908977571026897*^9, 3.9089776077780743`*^9, {
   3.908977889564906*^9, 3.908977905519168*^9}, 3.908978681016038*^9, 
   3.908978841664908*^9, 3.9089788777275257`*^9, 3.909023575841799*^9, {
   3.909025651463257*^9, 3.909025673134295*^9}, 3.9102698991252737`*^9, 
   3.910276558069399*^9, 3.910370741099566*^9},
 CellLabel->
  "During evaluation of \
In[526]:=",ExpressionUUID->"3ab12364-13fd-4d25-a8fa-ba1e4c8b59d9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Test", " ", "a", " ", "value", " ", "that", " ", "we", " ", "got", " ", 
    "from", " ", "above", " ", "here"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"newPriceY", ":=", "1.1"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"tenderY", ":=", 
     RowBox[{"arbY", "[", 
      RowBox[{"newPriceY", ",", 
       SubscriptBox["y", "0"], ",", 
       RowBox[{
        SubscriptBox["L", "Y"], "[", 
        RowBox[{
         SubscriptBox["y", "0"], ",", 
         SubscriptBox["S", "0"]}], "]"}]}], "]"}]}], "*)"}], "\n", 
   RowBox[{"tenderY", ":=", "50000"}], "\n", 
   RowBox[{
   "Print", "[", "\"\<We are tendering the following amount of Y:\>\"", "]"}],
    "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\) = \>\"", ",", " ", 
     "tenderY"}], "]"}], "\n", 
   RowBox[{
   "Print", "[", 
    "\"\<After applying the fee, we will have the following X \
reinvested:\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Yy"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", "\[CapitalDelta]"}]}], 
    ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Yy"], "[", "tenderY", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Swap", " ", "in", " ", "X", " ", "with", " ", "fee", " ", "chosen", " ", 
     "above"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Delta]", "Ly"], "[", "\[CapitalDelta]_", "]"}], ":=", 
    " ", 
    RowBox[{
     SubscriptBox["L", "Y"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Delta]", "Y"], "[", "\[CapitalDelta]", "]"}], ",", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"This", " ", "can", " ", "be", " ", "simplified"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Delta]", "Xy"], "[", "\[CapitalDelta]_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Ly"], "[", "\[CapitalDelta]", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"gaussianCDF", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"Log", "[", 
           FractionBox[
            SubscriptBox["S", "0"], "K"], "]"}], "\[Sigma]"], "+", 
         RowBox[{
          FractionBox["1", "2"], "\[Sigma]"}]}], "]"}]}], ")"}]}]}], "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective amount of Y reinvested is:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(x\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Xy"], "[", "tenderY", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective amount of liquidity reinvested is:\>\"", 
    "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Ly"], "[", "tenderY", "]"}]}], "]"}], "\n", 
   "\n", 
   RowBox[{
   "Print", "[", "\"\<The amount of X the user will receive\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "X"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["L", "0"], "+", 
         RowBox[{
          SubscriptBox["L", "Y"], "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Delta]", "Yy"], "[", "\[CapitalDelta]", "]"}], 
           ",", 
           SubscriptBox["S", "0"]}], "]"}]}], ")"}], "*", 
       RowBox[{"gaussianCDF", "[", 
        RowBox[{
         RowBox[{"-", "\[Sigma]"}], "-", 
         RowBox[{"gaussianPPF", "[", 
          FractionBox[
           RowBox[{
            SubscriptBox["y", "0"], "+", "\[CapitalDelta]"}], 
           RowBox[{"K", "*", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["L", "0"], "+", 
              RowBox[{
               SubscriptBox["L", "Y"], "[", 
               RowBox[{
                RowBox[{
                 SubscriptBox["\[Delta]", "Yy"], "[", "\[CapitalDelta]", 
                 "]"}], ",", 
                SubscriptBox["S", "0"]}], "]"}]}], ")"}]}]], "]"}]}], "]"}]}],
       "-", 
      SubscriptBox["x", "0"]}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\) = \>\"", ",", " ", 
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "X"], "[", "tenderY", "]"}]}]}], "]"}],
    "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<The effective price the user paid is then:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(P\), \(eff\)]\) = \>\"", ",", " ", 
     FractionBox[
      RowBox[{"-", "tenderY"}], 
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "X"], "[", "tenderY", "]"}]]}], "]"}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"What", " ", "are", " ", "the", " ", "liquidities"}], " ", "*)"}],
    "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new L using new X reserve:\>\"", "]"}], 
   "\n", 
   RowBox[{
    SubscriptBox["L", "givenX"], ":=", " ", 
    RowBox[{
     SubscriptBox["L", "X"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "0"], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "Xx"], "[", "tenderY", "]"}]}], ",", " ", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(givenX\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "givenX"]}], "]"}], "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new L using new Y reserve:\>\"", "]"}], 
   "\n", 
   RowBox[{
    SubscriptBox["L", "givenY"], ":=", 
    RowBox[{
     SubscriptBox["L", "Y"], "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["y", "0"], "+", 
       RowBox[{
        SubscriptBox["\[Delta]", "Yy"], "[", "tenderY", "]"}]}], ",", " ", 
      SubscriptBox["S", "0"]}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(givenY\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "givenY"]}], "]"}], "\n", "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new price given the new X reserve:\>\"", 
    "]"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Now", " ", "what", " ", "is", " ", "the", " ", 
     RowBox[{"price", "?", " ", "Should"}], " ", "be", " ", "0.9"}], " ", 
    "*)"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<S = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "X"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "0"], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "X"], "[", "tenderY", "]"}]}], ",", 
       SubscriptBox["L", "givenX"]}], "]"}]}], "]"}], "\n", 
   RowBox[{
   "Print", "[", "\"\<Computing the new price given the new Y reserve:\>\"", 
    "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<S = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["P", "Y"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "0"], "+", "tenderY"}], ",", 
       SubscriptBox["L", "givenY"]}], "]"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQraARnnBB7q3jupDYdBDtLj83F0Sf2hdSBaJTXsu0
guieXUumgmgzwymzQLQk4/25ILrovO4iEG3sYrUJrC5pxn8QLXArnekikN65
TJ4dRPcnmQiDaIdf141AtN6D52B6+rGnsSB6zZbTcSB6XbPiebC6Wf8ugehL
giJ3QLTrCe2HILrYuvs1iN48ff9HEG1u3vsNRBssZP8OoptM/vUcl3/raOSX
tAxEi631OQSi+doaD4Noh2nbz4Hoc5LHLoJoJkWuayD6T9jnGyDaJtey6QSQ
PnJpfweITkoz6QfROh7np4HoVK1rc0D0ApnaBSDaeY3am0Klt46vYlnfguid
Fz0+gmgTc38wrffp/zcQzVeS9R1EAwDAXb0t
  "],
 CellLabel->
  "In[587]:=",ExpressionUUID->"9bf9bebe-962a-46aa-86cc-a308ddbc4fb0"],

Cell[CellGroupData[{

Cell[BoxData["\<\"We are tendering the following amount of Y:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373309999918*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"1bae8965-92ec-4ecb-8280-0ab4d78ebc92"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(Y\\)]\\) = \
\"\>", "\[InvisibleSpace]", "50000"}],
  SequenceForm["\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\) = ", 50000],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.9103733100018187`*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"ae63f423-e1be-45d0-b7df-6cd065313f64"],

Cell[BoxData["\<\"After applying the fee, we will have the following X \
reinvested:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310003305*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"ccf27c8b-4277-49cb-9530-c3a2c551a935"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(Y\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "150.00000000000014`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = ", 150.00000000000014`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310004323*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"5e2ed615-a9a5-4e1b-a83b-f13084bfe271"],

Cell[BoxData["\<\"The effective amount of Y reinvested is:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310005335*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"6b05512d-3571-4232-ae3a-a3dd66b08bc2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(x\\)]\\) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"9.338029825145515`*^-6", " ", 
    RowBox[{
     SubscriptBox["\[Delta]", "Y"], "[", "50000", "]"}]}]}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(x\)]\) = ", 9.338029825145515*^-6 
   Subscript[$CellContext`\[Delta], $CellContext`Y][50000]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310006337*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"ad2d8671-57f8-495c-a408-631d569345ff"],

Cell[BoxData["\<\"The effective amount of liquidity reinvested is:\"\>"], \
"Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310007543*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"7d649db0-2d24-4534-9f99-c021c7122071"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(L\\)]\\) = \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"0.0005661202838679705`", " ", 
    RowBox[{
     SubscriptBox["\[Delta]", "Y"], "[", "50000", "]"}]}]}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = ", 0.0005661202838679705 
   Subscript[$CellContext`\[Delta], $CellContext`Y][50000]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310008548*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"22719bc6-4b6e-4a3a-a3dd-b2634c9a2417"],

Cell[BoxData["\<\"The amount of X the user will receive\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.9103733100095453`*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"8bb8e97a-a4ff-4ba9-94c2-495f7abcc4db"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(X\\)]\\) = \
\"\>", "\[InvisibleSpace]", "24.922350511082186`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\) = ", 24.922350511082186`],
  
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310010511*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"60eeed03-d0bf-41e8-8489-6fca239523ff"],

Cell[BoxData["\<\"The effective price the user paid is then:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310011484*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"8d20a201-ccdc-45c1-a7ba-9dede6eac5e4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(P\\), \\(eff\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "2006.2313134455985`"}],
  SequenceForm["\!\(\*SubscriptBox[\(P\), \(eff\)]\) = ", 2006.2313134455985`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310012342*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"2a96ff99-f7e6-47c1-9c0e-7e16ef50c8ad"],

Cell[BoxData["\<\"Computing the new L using new X reserve:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310013229*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"948a5426-4f08-4356-8504-bd01833fe4d6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(givenX\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "312219.9775020118`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(L\), \(givenX\)]\) = ", 312219.9775020118],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310014072*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"05abdfc8-50d2-462e-a889-5409b48ddbdb"],

Cell[BoxData["\<\"Computing the new L using new Y reserve:\"\>"], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310014965*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"0578a060-a3f8-454b-a269-6f504fd0f5e0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(givenY\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "303126.27666756866`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(L\), \(givenY\)]\) = ", 303126.27666756866`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310015814*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"75b037f1-4204-4255-a13e-b7837c15d8ed"],

Cell[BoxData["\<\"Computing the new price given the new X reserve:\"\>"], \
"Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310016706*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"41e015e7-e590-4a97-85e4-7a92d5db0a14"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", "2001.3843671724012`"}],
  SequenceForm["S = ", 2001.3843671724012`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.91037331001756*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"beac6889-cbaa-411c-8075-2d41b91e6891"],

Cell[BoxData["\<\"Computing the new price given the new Y reserve:\"\>"], \
"Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.910373310018385*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"60e7c015-fde0-4d69-a232-3c02aff54918"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", "2000.200563122271`"}],
  SequenceForm["S = ", 2000.200563122271],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9089759262519407`*^9, 3.908975946966117*^9}, 
   3.908976095055153*^9, 3.908976212569809*^9, {3.9089762734727783`*^9, 
   3.908976288840375*^9}, {3.908976322710137*^9, 3.908976328315237*^9}, 
   3.908977927457947*^9, 3.908978262640129*^9, 3.910269900682267*^9, 
   3.91027656023333*^9, 3.91037326128382*^9, 3.9103733100192223`*^9},
 CellLabel->
  "During evaluation of \
In[587]:=",ExpressionUUID->"6f5025f5-873c-4495-9f19-dace1e456b94"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"L", "[", 
    RowBox[{"K_", ",", " ", "\[Sigma]_", ",", " ", "\[Tau]_"}], "]"}], ":=", 
   FractionBox["x", 
    RowBox[{"1", "-", 
     RowBox[{"gaussianCDF", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Log", "[", 
         FractionBox["S", "K"], "]"}], 
        RowBox[{"\[Sigma]", " ", "*", " ", 
         RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]], "+", 
       RowBox[{
        FractionBox["1", "2"], "\[Sigma]", "*", 
        RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]}], "]"}]}]]}], ";"}]], "Code",
 CellChangeTimes->{{3.909284232761074*^9, 3.909284311581963*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"4b5af426-135f-4a74-9da3-771d1103714c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"k", ",", "v", ",", "\[Tau]"}], "]"}], ",", " ", "\[Tau]"}], 
   "]"}], "]"}]], "Code",
 CellChangeTimes->{{3.90928432250084*^9, 3.909284333437564*^9}, {
  3.909284512486307*^9, 3.909284540209017*^9}, {3.909284603343576*^9, 
  3.909284612257375*^9}, {3.90928530943178*^9, 3.90928533290548*^9}, {
  3.909285423256996*^9, 3.909285426149007*^9}},
 CellLabel->
  "In[2298]:=",ExpressionUUID->"50c66ca0-9c74-4d61-9f4b-df2d48548dec"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Log", "[", 
           FractionBox["S", "k"], "]"}]}]}], ")"}], "2"], 
      RowBox[{"8", " ", 
       SuperscriptBox["v", "2"], " ", "\[Tau]"}]]}]], " ", "x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["v", "2"], " ", "\[Tau]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Log", "[", 
       FractionBox["S", "k"], "]"}]}]}], ")"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", "v", " ", 
   SuperscriptBox["\[Tau]", 
    RowBox[{"3", "/", "2"}]], " ", 
   SuperscriptBox[
    RowBox[{"Erfc", "[", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Log", "[", 
         FractionBox["S", "k"], "]"}]}]}], 
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", "v", " ", 
       SqrtBox["\[Tau]"]}]], "]"}], "2"]}]]], "Output",
 CellChangeTimes->{
  3.9092845427099953`*^9, 3.9092847284270687`*^9, {3.909285319040761*^9, 
   3.909285333489358*^9}, 3.909285426726862*^9, 3.909285486420289*^9},
 CellLabel->
  "Out[2298]=",ExpressionUUID->"1ff2b6f1-79df-45c7-b33d-411cc0c1f570"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"k", ",", "v", ",", "\[Tau]"}], "]"}], ",", " ", "v"}], "]"}], 
  "]"}]], "Code",
 CellChangeTimes->{
  3.909286005138384*^9, {3.909286071218306*^9, 3.9092860773164062`*^9}},
 CellLabel->
  "In[2299]:=",ExpressionUUID->"da6f77ec-0263-4e0f-ae2e-65c443a57315"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Log", "[", 
           FractionBox["S", "k"], "]"}]}]}], ")"}], "2"], 
      RowBox[{"8", " ", 
       SuperscriptBox["v", "2"], " ", "\[Tau]"}]]}]], " ", 
   SqrtBox[
    FractionBox["2", "\[Pi]"]], " ", "x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["v", "2"], " ", "\[Tau]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Log", "[", 
       FractionBox["S", "k"], "]"}]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox["v", "2"], " ", 
   SqrtBox["\[Tau]"], " ", 
   SuperscriptBox[
    RowBox[{"Erfc", "[", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Log", "[", 
         FractionBox["S", "k"], "]"}]}]}], 
      RowBox[{"2", " ", 
       SqrtBox["2"], " ", "v", " ", 
       SqrtBox["\[Tau]"]}]], "]"}], "2"]}]]], "Output",
 CellChangeTimes->{3.909286081302704*^9},
 CellLabel->
  "Out[2299]=",ExpressionUUID->"e1990e5f-a66a-4ff5-a461-0d0ffa1425f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"\[Kappa]", ",", "v", ",", "\[Tau]"}], "]"}], ",", " ", 
    "\[Kappa]"}], "]"}], "]"}]], "Code",
 CellChangeTimes->{{3.909286199444543*^9, 3.909286209054088*^9}},
 CellLabel->
  "In[2300]:=",ExpressionUUID->"4738d5dd-62e6-4329-9f10-aa51583081a4"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Log", "[", 
            FractionBox["S", "\[Kappa]"], "]"}]}]}], ")"}], "2"], 
       RowBox[{"8", " ", 
        SuperscriptBox["v", "2"], " ", "\[Tau]"}]]}]], " ", 
    SqrtBox[
     FractionBox["2", "\[Pi]"]], " ", "x"}], 
   RowBox[{"v", " ", "\[Kappa]", " ", 
    SqrtBox["\[Tau]"], " ", 
    SuperscriptBox[
     RowBox[{"Erfc", "[", 
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["v", "2"], " ", "\[Tau]"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Log", "[", 
          FractionBox["S", "\[Kappa]"], "]"}]}]}], 
       RowBox[{"2", " ", 
        SqrtBox["2"], " ", "v", " ", 
        SqrtBox["\[Tau]"]}]], "]"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.909286209687827*^9},
 CellLabel->
  "Out[2300]=",ExpressionUUID->"5d6626db-ee2a-47e3-98ee-214b11fe010e"]
}, Open  ]],

Cell["", "Item",
 CellChangeTimes->{
  3.9102698673316183`*^9},ExpressionUUID->"30f4a8e8-beca-49df-baea-\
8b81c8a2aeb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "a", " ", "root", " ", "for", " ", "changed", " ", 
    "parameters"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"computeSwapConstant", "[", 
      RowBox[{
      "x_", ",", "y_", ",", "L_", ",", "strike_", ",", "vol_", ",", "tau_"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"gaussianPPF", "[", 
       FractionBox["x", "L"], "]"}], "+", 
      RowBox[{"gaussianPPF", "[", 
       FractionBox["y", 
        RowBox[{"strike", "*", "L"}]], "]"}], "+", 
      RowBox[{"vol", "*", "tau"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialPrice", ":=", "2000"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialX", ":=", "5000"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialStrike", ":=", "1800"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialSigma", ":=", "0.05"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialTau", ":=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "fromX"], "[", 
     RowBox[{"x_", ",", "S_", ",", "K_", ",", "\[Sigma]_", ",", "\[Tau]_"}], 
     "]"}], ":=", 
    FractionBox["x", 
     RowBox[{"1", "-", 
      RowBox[{"gaussianCDF", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"Log", "[", 
          FractionBox["S", "K"], "]"}], 
         RowBox[{"\[Sigma]", "*", 
          RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]], "+", 
        RowBox[{
         FractionBox["1", "2"], "\[Sigma]", "*", 
         RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]}], "]"}]}]]}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["Y", "fromX"], "[", 
      RowBox[{"x_", ",", "S_", ",", "K_", ",", "\[Sigma]_", ",", "\[Tau]_"}], 
      "]"}], ":=", 
     RowBox[{"K", "*", 
      RowBox[{
       SubscriptBox["L", "fromX"], "[", 
       RowBox[{"x", ",", "S", ",", "K", ",", "\[Sigma]", ",", "\[Tau]"}], 
       "]"}], "*", 
      RowBox[{"gaussianCDF", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"Log", "[", 
          FractionBox["S", "K"], "]"}], 
         RowBox[{"\[Sigma]", "*", 
          RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]], "-", 
        RowBox[{
         FractionBox["1", "2"], "\[Sigma]", "*", 
         RowBox[{"Sqrt", "[", "\[Tau]", "]"}]}]}], "]"}]}]}], ";"}], "\n", 
   RowBox[{"initialL", ":=", 
    RowBox[{
     SubscriptBox["L", "fromX"], "[", 
     RowBox[{
     "initialX", ",", "initialPrice", ",", "initialStrike", ",", 
      "initialSigma", ",", "initialTau"}], "]"}]}], "\n", 
   RowBox[{"initialY", ":=", 
    RowBox[{
     SubscriptBox["Y", "fromX"], "[", 
     RowBox[{
     "initialX", ",", "initialPrice", ",", "initialStrike", ",", 
      "initialSigma", ",", "initialTau"}], "]"}]}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Initial L = \>\"", ",", " ", "initialL"}], "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Initial Y = \>\"", ",", " ", "initialY"}], "]"}], "\n", "\n", 
   RowBox[{
    RowBox[{"newStrike", " ", "=", " ", "1820"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"newSigma", " ", "=", " ", "0.04"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"newTau", " ", "=", " ", "1"}], ";"}], "\n", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{"computeSwapConstant", "[", 
      RowBox[{
      "initialX", ",", " ", "initialY", ",", " ", "L", ",", " ", "newStrike", 
       ",", " ", "newSigma", ",", " ", "newTau"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"L", ",", " ", "initialL"}], "}"}]}], "]"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Desmos", " ", "Checks"}], " ", "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"initialX", ":=", "2"}], ";", "\n", 
     RowBox[{"initialY", ":=", "2.209"}], ";", "\n", 
     RowBox[{"initialStrike", ":=", "1"}], ";", "\n", 
     RowBox[{"initialSigma", ":=", "0.4"}], ";", "\n", 
     RowBox[{"initialTau", ":=", "1"}], ";", "\n", 
     RowBox[{"initialL", ":=", "5"}], ";"}], "*)"}]}]}]], "Code",
 CellChangeTimes->{{3.9102698717452183`*^9, 3.910269878705433*^9}, {
  3.910269917340452*^9, 3.910270513817072*^9}, {3.9102705893206577`*^9, 
  3.910270844573196*^9}, {3.910272041094924*^9, 3.910272047123364*^9}, {
  3.910276540573292*^9, 3.910276541127635*^9}, {3.9102765919165382`*^9, 
  3.9102766535669317`*^9}, {3.9102767176812983`*^9, 3.9102767196112013`*^9}, {
  3.910276852015691*^9, 3.910276879183813*^9}, {3.910286187652493*^9, 
  3.910286192547421*^9}},
 CellLabel->
  "In[493]:=",ExpressionUUID->"4ed370a8-51eb-433c-a04a-009252cccf10"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial L = \"\>", "\[InvisibleSpace]", "303126.1917495261`"}],
  
  SequenceForm["Initial L = ", 303126.1917495261],
  Editable->False]], "Print",
 CellChangeTimes->{{3.910270823726644*^9, 3.910270846743188*^9}, {
   3.9102765427704983`*^9, 3.91027665548776*^9}, 3.910276719975027*^9, {
   3.910276852840979*^9, 3.910276879603985*^9}, 3.91028619474218*^9},
 CellLabel->
  "During evaluation of \
In[493]:=",ExpressionUUID->"f2d0eda9-ab94-471b-9fe1-b219cb411c1f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Initial Y = \"\>", "\[InvisibleSpace]", 
   "5.3544485224666595`*^8"}],
  SequenceForm["Initial Y = ", 5.3544485224666595`*^8],
  Editable->False]], "Print",
 CellChangeTimes->{{3.910270823726644*^9, 3.910270846743188*^9}, {
   3.9102765427704983`*^9, 3.91027665548776*^9}, 3.910276719975027*^9, {
   3.910276852840979*^9, 3.910276879603985*^9}, 3.910286194743977*^9},
 CellLabel->
  "During evaluation of \
In[493]:=",ExpressionUUID->"c8f08254-0359-41d3-a640-d37c14efe6d7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"L", "\[Rule]", "299719.4573701215`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.910270515517971*^9, 3.910270692837224*^9, 3.910270750972248*^9, {
   3.910270823760948*^9, 3.910270846745335*^9}, {3.910276542779942*^9, 
   3.910276655491342*^9}, 3.910276719977729*^9, {3.9102768528538*^9, 
   3.9102768796074123`*^9}, 3.910286194745448*^9},
 CellLabel->
  "Out[508]=",ExpressionUUID->"192c51dd-dd58-497b-9a03-3a9e102e325d"]
}, Open  ]]
},
WindowSize->{1348, 2084},
WindowMargins->{{Automatic, 12}, {Automatic, 11}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 31, 2023)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "Users", "colin", 
   "Documents"}, "DarkMode.nb", CharacterEncoding -> "UTF-8"],
ExpressionUUID->"5448244f-f9d9-40b1-b507-d7b872b3fa95"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 935, 25, 148, "Code",ExpressionUUID->"c490899a-2f5d-40ab-a7d1-a5c9dca8c853"],
Cell[1499, 47, 2817, 95, 373, "Code",ExpressionUUID->"0e5528a2-b8c6-467a-844e-8c7716a97af3"],
Cell[4319, 144, 730, 16, 122, "Code",ExpressionUUID->"38327a6c-a04f-4af4-877c-b294ae062156"],
Cell[CellGroupData[{
Cell[5074, 164, 1741, 45, 278, "Code",ExpressionUUID->"7d969c2b-e997-401d-b15b-a40e313196bc"],
Cell[CellGroupData[{
Cell[6840, 213, 376, 9, 33, "Print",ExpressionUUID->"f3a67110-6e21-4560-a3bf-19f4cbaed0db"],
Cell[7219, 224, 385, 9, 31, "Print",ExpressionUUID->"07784bf5-76ac-4880-921b-84e90689fcb4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7653, 239, 813, 22, 96, "Code",ExpressionUUID->"8a8b8903-b1b9-4e57-ae98-7ba26b8f5c79"],
Cell[CellGroupData[{
Cell[8491, 265, 430, 9, 31, "Print",ExpressionUUID->"579d84d4-2d66-4712-bdd4-20b035a944ae"],
Cell[8924, 276, 459, 10, 31, "Print",ExpressionUUID->"a1c07174-c3ed-4331-bc76-9a67d862e76e"]
}, Open  ]]
}, Open  ]],
Cell[9410, 290, 3628, 95, 342, "Code",ExpressionUUID->"1efdbee4-dd4b-4b95-89ef-b8a05144a40f"],
Cell[CellGroupData[{
Cell[13063, 389, 9087, 228, 1175, "Code",ExpressionUUID->"e81539e0-9c8f-4cc0-9aed-23ff71ff5ce5"],
Cell[CellGroupData[{
Cell[22175, 621, 1493, 22, 31, "Print",ExpressionUUID->"2b9f0464-6007-4e3d-a9d9-a19181f890a5"],
Cell[23671, 645, 1666, 27, 31, "Print",ExpressionUUID->"19221afb-07b8-43dc-8144-a123ab8c47cb"],
Cell[25340, 674, 1514, 23, 31, "Print",ExpressionUUID->"476d2b34-2def-4d1b-a41d-9711b5ec994f"],
Cell[26857, 699, 1689, 28, 31, "Print",ExpressionUUID->"ff9f609f-2f9f-435c-bd63-e30a3b8d2bd5"],
Cell[28549, 729, 1488, 22, 31, "Print",ExpressionUUID->"562d84f2-edd0-4953-b560-233714f9c844"],
Cell[30040, 753, 1686, 28, 31, "Print",ExpressionUUID->"dbde9d6b-8b39-4ed3-952e-1e54dff44600"],
Cell[31729, 783, 1498, 23, 31, "Print",ExpressionUUID->"bebd1da2-d74e-42ad-b117-54c7bb0939dc"],
Cell[33230, 808, 1688, 28, 31, "Print",ExpressionUUID->"ea79b3d0-6452-4331-b213-03731e8b8604"],
Cell[34921, 838, 1485, 22, 31, "Print",ExpressionUUID->"d546d5c7-4918-4bc6-a889-c3c9a6c86756"],
Cell[36409, 862, 1698, 28, 31, "Print",ExpressionUUID->"28e26a4c-22c3-4f90-a691-c424e7c035f0"],
Cell[38110, 892, 1492, 22, 31, "Print",ExpressionUUID->"ebab0655-69a6-40d5-8220-be240f2d44e9"],
Cell[39605, 916, 1676, 27, 31, "Print",ExpressionUUID->"66b0406c-6ff5-461a-a0b8-4a26bbe10b2e"],
Cell[41284, 945, 1487, 22, 31, "Print",ExpressionUUID->"6e3da5e0-4926-4a34-a9c0-6f09fe0e067a"],
Cell[42774, 969, 1682, 28, 35, "Print",ExpressionUUID->"093fd778-9331-435d-be22-d8de485a35ba"],
Cell[44459, 999, 1488, 22, 31, "Print",ExpressionUUID->"0b53b7f4-9de0-4bda-b942-e35ecfa3e8ee"],
Cell[45950, 1023, 1682, 28, 35, "Print",ExpressionUUID->"01869dbd-76d4-4a11-b486-911e9e1905d1"],
Cell[47635, 1053, 1498, 23, 31, "Print",ExpressionUUID->"179cead1-c23e-438d-9b0b-7c7566209019"],
Cell[49136, 1078, 1594, 26, 31, "Print",ExpressionUUID->"d4f250c9-09f4-49b1-bfad-09f3d9bf1456"],
Cell[50733, 1106, 1498, 23, 31, "Print",ExpressionUUID->"58dab9a6-261d-4454-8a28-48feb901bca5"],
Cell[52234, 1131, 1594, 26, 31, "Print",ExpressionUUID->"3ab12364-13fd-4d25-a8fa-ba1e4c8b59d9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53877, 1163, 7891, 224, 1209, "Code",ExpressionUUID->"9bf9bebe-962a-46aa-86cc-a308ddbc4fb0"],
Cell[CellGroupData[{
Cell[61793, 1391, 535, 8, 31, "Print",ExpressionUUID->"1bae8965-92ec-4ecb-8280-0ab4d78ebc92"],
Cell[62331, 1401, 716, 13, 31, "Print",ExpressionUUID->"ae63f423-e1be-45d0-b7df-6cd065313f64"],
Cell[63050, 1416, 558, 9, 31, "Print",ExpressionUUID->"ccf27c8b-4277-49cb-9530-c3a2c551a935"],
Cell[63611, 1427, 733, 14, 31, "Print",ExpressionUUID->"5e2ed615-a9a5-4e1b-a83b-f13084bfe271"],
Cell[64347, 1443, 532, 8, 31, "Print",ExpressionUUID->"6b05512d-3571-4232-ae3a-a3dd66b08bc2"],
Cell[64882, 1453, 888, 18, 33, "Print",ExpressionUUID->"ad2d8671-57f8-495c-a408-631d569345ff"],
Cell[65773, 1473, 542, 9, 31, "Print",ExpressionUUID->"7d649db0-2d24-4534-9f99-c021c7122071"],
Cell[66318, 1484, 888, 18, 31, "Print",ExpressionUUID->"22719bc6-4b6e-4a3a-a3dd-b2634c9a2417"],
Cell[67209, 1504, 531, 8, 31, "Print",ExpressionUUID->"8bb8e97a-a4ff-4ba9-94c2-495f7abcc4db"],
Cell[67743, 1514, 748, 15, 31, "Print",ExpressionUUID->"60eeed03-d0bf-41e8-8489-6fca239523ff"],
Cell[68494, 1531, 534, 8, 31, "Print",ExpressionUUID->"8d20a201-ccdc-45c1-a7ba-9dede6eac5e4"],
Cell[69031, 1541, 720, 13, 31, "Print",ExpressionUUID->"2a96ff99-f7e6-47c1-9c0e-7e16ef50c8ad"],
Cell[69754, 1556, 532, 8, 31, "Print",ExpressionUUID->"948a5426-4f08-4356-8504-bd01833fe4d6"],
Cell[70289, 1566, 726, 14, 35, "Print",ExpressionUUID->"05abdfc8-50d2-462e-a889-5409b48ddbdb"],
Cell[71018, 1582, 532, 8, 31, "Print",ExpressionUUID->"0578a060-a3f8-454b-a269-6f504fd0f5e0"],
Cell[71553, 1592, 729, 14, 35, "Print",ExpressionUUID->"75b037f1-4204-4255-a13e-b7837c15d8ed"],
Cell[72285, 1608, 542, 9, 31, "Print",ExpressionUUID->"41e015e7-e590-4a97-85e4-7a92d5db0a14"],
Cell[72830, 1619, 637, 12, 31, "Print",ExpressionUUID->"beac6889-cbaa-411c-8075-2d41b91e6891"],
Cell[73470, 1633, 542, 9, 31, "Print",ExpressionUUID->"60e7c015-fde0-4d69-a232-3c02aff54918"],
Cell[74015, 1644, 637, 12, 31, "Print",ExpressionUUID->"6f5025f5-873c-4495-9f19-dace1e456b94"]
}, Open  ]]
}, Open  ]],
Cell[74679, 1660, 708, 19, 83, "Code",ExpressionUUID->"4b5af426-135f-4a74-9da3-771d1103714c"],
Cell[CellGroupData[{
Cell[75412, 1683, 541, 12, 43, "Code",ExpressionUUID->"50c66ca0-9c74-4d61-9f4b-df2d48548dec"],
Cell[75956, 1697, 1418, 44, 111, "Output",ExpressionUUID->"1ff2b6f1-79df-45c7-b33d-411cc0c1f570"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77411, 1746, 372, 10, 43, "Code",ExpressionUUID->"da6f77ec-0263-4e0f-ae2e-65c443a57315"],
Cell[77786, 1758, 1281, 42, 113, "Output",ExpressionUUID->"e1990e5f-a66a-4ff5-a461-0d0ffa1425f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79104, 1805, 361, 9, 43, "Code",ExpressionUUID->"4738d5dd-62e6-4329-9f10-aa51583081a4"],
Cell[79468, 1816, 1141, 35, 113, "Output",ExpressionUUID->"5d6626db-ee2a-47e3-98ee-214b11fe010e"]
}, Open  ]],
Cell[80624, 1854, 120, 3, 40, "Item",ExpressionUUID->"30f4a8e8-beca-49df-baea-8b81c8a2aeb9"],
Cell[CellGroupData[{
Cell[80769, 1861, 4466, 116, 795, "Code",ExpressionUUID->"4ed370a8-51eb-433c-a04a-009252cccf10"],
Cell[CellGroupData[{
Cell[85260, 1981, 512, 11, 31, "Print",ExpressionUUID->"f2d0eda9-ab94-471b-9fe1-b219cb411c1f"],
Cell[85775, 1994, 523, 11, 33, "Print",ExpressionUUID->"c8f08254-0359-41d3-a640-d37c14efe6d7"]
}, Open  ]],
Cell[86313, 2008, 462, 9, 33, "Output",ExpressionUUID->"192c51dd-dd58-497b-9a03-3a9e102e325d"]
}, Open  ]]
}
]
*)

