(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[     50786,       1203]
NotebookOptionsPosition[     45565,       1118]
NotebookOutlinePosition[     46065,       1135]
CellTagsIndexPosition[     46022,       1132]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Invariant", " ", "and", " ", "price"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"L", "[", 
      RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
     RowBox[{
      SuperscriptBox["x", 
       RowBox[{
        SubscriptBox["w", "X"], "[", "t", "]"}]], "*", 
      SuperscriptBox["y", 
       RowBox[{
        SubscriptBox["w", "Y"], "[", "t", "]"}]]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"x_", ",", "y_", ",", "t_"}], "]"}], ":=", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["w", "X"], "[", "t", "]"}], 
       RowBox[{
        SubscriptBox["w", "Y"], "[", "t", "]"}]], "*", 
      FractionBox["y", "x"]}]}], ";"}], "\n", 
   RowBox[{"(*", " ", "weights", " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["w", "X"], "[", "t_", "]"}], ":=", "0.5"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["w", "Y"], "[", "t_", "]"}], ":=", 
     RowBox[{"1", "-", 
      RowBox[{
       SubscriptBox["w", "X"], "[", "t", "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", "constants", " ", "*)"}], "\n", 
   RowBox[{"\[Gamma]", ":=", "0.997"}]}]}]], "Code",
 CellChangeTimes->{{3.909021803662468*^9, 3.909022025592271*^9}, {
   3.909022093996531*^9, 3.909022120469081*^9}, 3.909022205588684*^9, {
   3.909022426604455*^9, 3.909022448323473*^9}, {3.909022744334041*^9, 
   3.909022754650867*^9}, {3.9090228185541697`*^9, 3.909022818842835*^9}, {
   3.909026701717299*^9, 3.909026701987199*^9}, 3.909028614426351*^9},
 CellLabel->
  "In[1569]:=",ExpressionUUID->"b2c3eb13-7d03-414e-8c7f-9b7f586d0f14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Finding", " ", "liquidity", " ", "in", " ", "single", " ", "variable"}], 
   " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["L", "X"], "[", 
      RowBox[{"x_", ",", "S_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"x", "*", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SubscriptBox["w", "Y"], "[", "t", "]"}], 
          RowBox[{
           SubscriptBox["w", "X"], "[", "t", "]"}]], "*", "S"}], ")"}], 
       RowBox[{"1", "/", 
        RowBox[{
         SubscriptBox["w", "Y"], "[", "t", "]"}]}]]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["L", "Y"], "[", 
      RowBox[{"y_", ",", "S_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"y", "*", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SubscriptBox["w", "X"], "[", "t", "]"}], 
          RowBox[{
           SubscriptBox["w", "Y"], "[", "t", "]"}]], "*", 
         FractionBox["1", "S"]}], ")"}], 
       RowBox[{"1", "/", 
        RowBox[{
         SubscriptBox["w", "X"], "[", "t", "]"}]}]]}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.909025140492548*^9, 3.909025251735415*^9}, {
  3.909025421735194*^9, 3.90902546011587*^9}, {3.909026682170676*^9, 
  3.90902668613767*^9}},
 CellLabel->
  "In[1307]:=",ExpressionUUID->"f9fb63cc-a717-46fa-82f5-c9fe272a7a74"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Sanity", " ", "checking", " ", 
    SubscriptBox["k", "X"], " ", "and", " ", 
    SubscriptBox["k", "Y"]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(L\), \(X\)]\)(1,1,0) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["L", "X"], "[", 
      RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(L\), \(Y\)]\)(1,1,0) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["L", "Y"], "[", 
      RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->{
  3.9090252398424063`*^9, {3.90902546934628*^9, 3.909025530855916*^9}, {
   3.909026689874899*^9, 3.9090266952785597`*^9}},
 CellLabel->
  "In[1309]:=",ExpressionUUID->"ed65588f-4a47-4e8e-b018-b05cf18d9036"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(X\\)]\\)(1,1,0) = \"\>", 
   "\[InvisibleSpace]", "1.`"}],
  SequenceForm["\!\(\*SubscriptBox[\(L\), \(X\)]\)(1,1,0) = ", 1.],
  Editable->False]], "Print",
 CellChangeTimes->{3.909025532264587*^9, 3.909026705679769*^9},
 CellLabel->
  "During evaluation of \
In[1309]:=",ExpressionUUID->"9d838419-17a4-4531-9f10-226ad8f68bd5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(Y\\)]\\)(1,1,0) = \"\>", 
   "\[InvisibleSpace]", "1.`"}],
  SequenceForm["\!\(\*SubscriptBox[\(L\), \(Y\)]\)(1,1,0) = ", 1.],
  Editable->False]], "Print",
 CellChangeTimes->{3.909025532264587*^9, 3.909026705680867*^9},
 CellLabel->
  "During evaluation of \
In[1309]:=",ExpressionUUID->"74d27c34-5927-40ef-855f-c9190fd6803b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Some", " ", "tests"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"Print", "[", "\"\<The price when R = (1,1) and t=0\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<P(1.0, 1.0, 0) = \>\"", ",", "  ", 
     RowBox[{"P", "[", 
      RowBox[{"1.0", ",", "1.0", ",", "0"}], "]"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.9090222109769077`*^9, 3.9090223957510157`*^9}, {
  3.909022533714499*^9, 3.909022533949081*^9}},
 CellLabel->
  "In[1607]:=",ExpressionUUID->"11a592e2-9623-49b0-bc2b-483c8894c5e3"],

Cell[CellGroupData[{

Cell[BoxData["\<\"The price when R = (1,1) and t=0\"\>"], "Print",
 CellChangeTimes->{{3.909022360788795*^9, 3.909022376926024*^9}, 
   3.909022757587614*^9, 3.909022821878997*^9, 3.9090267077448072`*^9, 
   3.909028728976143*^9},
 CellLabel->
  "During evaluation of \
In[1607]:=",ExpressionUUID->"efc0aae8-7362-46f7-a9af-f11e87ea5d8b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"P(1.0, 1.0, 0) = \"\>", "\[InvisibleSpace]", "1.`"}],
  SequenceForm["P(1.0, 1.0, 0) = ", 1.],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909022360788795*^9, 3.909022376926024*^9}, 
   3.909022757587614*^9, 3.909022821878997*^9, 3.9090267077448072`*^9, 
   3.909028728977232*^9},
 CellLabel->
  "During evaluation of \
In[1607]:=",ExpressionUUID->"7fb7c0d2-49ca-41ef-8128-26a4bfec6ce2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", "time", " ", "t"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    SubscriptBox["t", "0"], ":=", "0"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Initial", " ", "weights"}], " ", "*)"}], "\n", 
   RowBox[{"Print", "[", "\"\<The initial weights are:\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["w", "X0"], ":=", 
     RowBox[{
      SubscriptBox["w", "X"], "[", 
      SubscriptBox["t", "0"], "]"}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(w\), \(X0\)]\) = \>\"", ",", 
     SubscriptBox["w", "X0"]}], "]"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["w", "Y0"], ":=", 
     RowBox[{
      SubscriptBox["w", "Y"], "[", 
      SubscriptBox["t", "0"], "]"}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(w\), \(Y0\)]\) = \>\"", ",", 
     SubscriptBox["w", "Y0"]}], "]"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Initial", " ", "X", " ", "value"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "0"], ":=", "1"}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(x\), \(0\)]\) = \>\"", ",", 
     SubscriptBox["x", "0"]}], "]"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Initial", " ", "price"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["S", "0"], ":=", "1"}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(S\), \(0\)]\) = \>\"", ",", 
     SubscriptBox["S", "0"]}], "]"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Amount", " ", "for", " ", "Y", " ", "for", " ", "this", " ", "price", 
     " ", "and", " ", "X"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["y", "0"], ":=", 
     RowBox[{"Y", "[", 
      RowBox[{
       SubscriptBox["x", "0"], ",", 
       SubscriptBox["S", "0"]}], "]"}]}], ";"}], "\n", 
   RowBox[{"Print", "[", "\"\<The initial amount of y is:\>\"", "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(y\), \(0\)]\) = \>\"", ",", " ", 
     SubscriptBox["y", "0"]}], "]"}], "\n", 
   RowBox[{"(*", " ", "Liquidity", " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     SubscriptBox["L", "0"], "=", 
     RowBox[{"L", "[", 
      RowBox[{
       SubscriptBox["x", "0"], ",", 
       SubscriptBox["y", "0"], ",", 
       SubscriptBox["t", "0"]}], "]"}]}], ";"}], "\n", 
   RowBox[{"Print", "[", "\"\<The initial liquidity k is:\>\"", "]"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(L\), \(0\)]\) = \>\"", ",", " ", 
     SubscriptBox["L", "0"]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.909022539411557*^9, 3.909022724321106*^9}, {
  3.909022851977118*^9, 3.909022934513764*^9}, {3.9090231646979017`*^9, 
  3.9090233051017723`*^9}, {3.909023348941732*^9, 3.909023387785617*^9}, {
  3.909026713613399*^9, 3.90902673954897*^9}},
 CellLabel->
  "In[1591]:=",ExpressionUUID->"d8460225-c2d1-439c-a0be-cebd189603df"],

Cell[CellGroupData[{

Cell[BoxData["\<\"The initial weights are:\"\>"], "Print",
 CellChangeTimes->{
  3.9090229364100027`*^9, 3.909023201170885*^9, {3.909023344335574*^9, 
   3.909023349967985*^9}, 3.909023388621849*^9, 3.909026740798004*^9, 
   3.9090274925503798`*^9, 3.9090286345067596`*^9},
 CellLabel->
  "During evaluation of \
In[1591]:=",ExpressionUUID->"1a8569be-6fb6-43a0-bfc4-26c2c17575e8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(w\\), \\(X0\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.5`"}],
  SequenceForm["\!\(\*SubscriptBox[\(w\), \(X0\)]\) = ", 0.5],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9090229364100027`*^9, 3.909023201170885*^9, {3.909023344335574*^9, 
   3.909023349967985*^9}, 3.909023388621849*^9, 3.909026740798004*^9, 
   3.9090274925503798`*^9, 3.909028634507841*^9},
 CellLabel->
  "During evaluation of \
In[1591]:=",ExpressionUUID->"65866cc6-8e4c-49bd-b209-35106212b5a2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(w\\), \\(Y0\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.5`"}],
  SequenceForm["\!\(\*SubscriptBox[\(w\), \(Y0\)]\) = ", 0.5],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9090229364100027`*^9, 3.909023201170885*^9, {3.909023344335574*^9, 
   3.909023349967985*^9}, 3.909023388621849*^9, 3.909026740798004*^9, 
   3.9090274925503798`*^9, 3.909028634509561*^9},
 CellLabel->
  "During evaluation of \
In[1591]:=",ExpressionUUID->"eebc4482-69ae-43c0-b1e9-2c6c74caac02"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(x\\), \\(0\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["\!\(\*SubscriptBox[\(x\), \(0\)]\) = ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9090229364100027`*^9, 3.909023201170885*^9, {3.909023344335574*^9, 
   3.909023349967985*^9}, 3.909023388621849*^9, 3.909026740798004*^9, 
   3.9090274925503798`*^9, 3.909028634510582*^9},
 CellLabel->
  "During evaluation of \
In[1591]:=",ExpressionUUID->"a9385fcb-8e79-423f-9a08-01ecb8120a07"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(S\\), \\(0\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm["\!\(\*SubscriptBox[\(S\), \(0\)]\) = ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9090229364100027`*^9, 3.909023201170885*^9, {3.909023344335574*^9, 
   3.909023349967985*^9}, 3.909023388621849*^9, 3.909026740798004*^9, 
   3.9090274925503798`*^9, 3.909028634511553*^9},
 CellLabel->
  "During evaluation of \
In[1591]:=",ExpressionUUID->"3073bc55-df85-4e15-875d-de047a8c500d"],

Cell[BoxData["\<\"The initial amount of y is:\"\>"], "Print",
 CellChangeTimes->{
  3.9090229364100027`*^9, 3.909023201170885*^9, {3.909023344335574*^9, 
   3.909023349967985*^9}, 3.909023388621849*^9, 3.909026740798004*^9, 
   3.9090274925503798`*^9, 3.909028634512496*^9},
 CellLabel->
  "During evaluation of \
In[1591]:=",ExpressionUUID->"105ed2ea-0dbd-49f6-a031-3b1d7c074f7d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(y\\), \\(0\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "1.`"}],
  SequenceForm["\!\(\*SubscriptBox[\(y\), \(0\)]\) = ", 1.],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9090229364100027`*^9, 3.909023201170885*^9, {3.909023344335574*^9, 
   3.909023349967985*^9}, 3.909023388621849*^9, 3.909026740798004*^9, 
   3.9090274925503798`*^9, 3.909028634513403*^9},
 CellLabel->
  "During evaluation of \
In[1591]:=",ExpressionUUID->"0862faa2-3557-42fa-9645-ed7f5585d2be"],

Cell[BoxData["\<\"The initial liquidity k is:\"\>"], "Print",
 CellChangeTimes->{
  3.9090229364100027`*^9, 3.909023201170885*^9, {3.909023344335574*^9, 
   3.909023349967985*^9}, 3.909023388621849*^9, 3.909026740798004*^9, 
   3.9090274925503798`*^9, 3.909028634514367*^9},
 CellLabel->
  "During evaluation of \
In[1591]:=",ExpressionUUID->"cbc9e66f-61b9-475b-b519-8972a421f159"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(L\\), \\(0\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "1.`"}],
  SequenceForm["\!\(\*SubscriptBox[\(L\), \(0\)]\) = ", 1.],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9090229364100027`*^9, 3.909023201170885*^9, {3.909023344335574*^9, 
   3.909023349967985*^9}, 3.909023388621849*^9, 3.909026740798004*^9, 
   3.9090274925503798`*^9, 3.909028634515293*^9},
 CellLabel->
  "During evaluation of \
In[1591]:=",ExpressionUUID->"12a3d6ba-2e66-4dfc-9b8f-d14c5f97a353"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Arb", " ", "Calculations"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Note", " ", "these", " ", "are", " ", "not", " ", "going", " ", "to", " ",
     "give", " ", "exactly", " ", "correct", " ", "prices"}], " ", "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"arbX", "[", 
      RowBox[{"p_", ",", "x_", ",", "L_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", "\[Gamma]"], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"L", "*", 
           FractionBox[
            SubscriptBox["w", "X0"], 
            SubscriptBox["w", "Y0"]], "*", 
           FractionBox["1", "p"]}], ")"}], 
         SubscriptBox["w", "Y0"]], "-", "x"}], ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"arbY", "[", 
      RowBox[{"p_", ",", "y_", ",", "L_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", "\[Gamma]"], "*", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"L", "*", 
           FractionBox[
            SubscriptBox["w", "Y0"], 
            SubscriptBox["w", "X0"]], "*", "p"}], ")"}], 
         SubscriptBox["w", "X0"]], "-", "y"}], ")"}]}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.9090230606779823`*^9, 3.909023156164391*^9}, {
  3.909023335942824*^9, 3.90902334210565*^9}, {3.909023395669045*^9, 
  3.909023477521027*^9}, {3.909026151251039*^9, 3.909026181828005*^9}, {
  3.909027506599036*^9, 3.909027516143065*^9}, {3.909030991446961*^9, 
  3.90903102767811*^9}, {3.9090310677418528`*^9, 3.9090311157672358`*^9}, {
  3.909031186082201*^9, 3.909031188204049*^9}, {3.909031245928356*^9, 
  3.909031335048544*^9}, {3.909031400103899*^9, 3.909031425449504*^9}, {
  3.909032092184464*^9, 3.9090320985923347`*^9}, {3.909032148220768*^9, 
  3.9090322452811117`*^9}},
 CellLabel->
  "In[1977]:=",ExpressionUUID->"32951f98-a51e-4d59-a510-81f1ce18a5b0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Testing", " ", "both", " ", "arbitrages"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"First", " ", "tender", " ", "X"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["S", "nextX"], ":=", "0.8"}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<To lower price from \!\(\*SubscriptBox[\(S\), \(0\)]\) = \>\"", ",", 
     " ", 
     SubscriptBox["S", "0"], ",", " ", 
     "\"\< to \!\(\*SubscriptBox[\(S\), \(next\)]\) = \>\"", ",", " ", 
     SubscriptBox["S", "nextX"]}], "]"}], "\n", 
   RowBox[{
    SubscriptBox["\[CapitalDelta]", "X0"], ":=", 
    RowBox[{"arbX", "[", 
     RowBox[{
      SubscriptBox["S", "nextX"], ",", 
      SubscriptBox["x", "0"], ",", 
      SubscriptBox["L", "0"]}], "]"}]}], "\n", 
   RowBox[{
   "Print", "[", 
    "\"\<After applying the fee, we will have the following X \
reinvested:\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Xx"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", "\[CapitalDelta]"}]}], 
    ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(X\)]\) = \>\"", ",", 
     RowBox[{
      SubscriptBox["\[Delta]", "Xx"], "[", 
      SubscriptBox["\[CapitalDelta]", "X0"], "]"}]}], "]"}], "\n", 
   RowBox[{"Print", "[", "\"\<The change in liquidity will be:\>\"", "]"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     " ", 
     RowBox[{
      SubscriptBox["L", "X"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Delta]", "Xx"], "[", "\[CapitalDelta]", "]"}], ",", 
       SubscriptBox["S", "0"], ",", "0"}], "]"}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Lx"], "[", 
      SubscriptBox["\[CapitalDelta]", "X0"], "]"}]}], "]"}], "\n", "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<We must swap in \!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X0\)]\) = \
\>\"", ",", " ", 
     SubscriptBox["\[CapitalDelta]", "X0"]}], "]"}], "\n", 
   RowBox[{"Print", "[", "\"\<Then we will get out:\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "Y"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SubscriptBox["L", "0"], "+", 
          RowBox[{
           SubscriptBox["\[Delta]", "Lx"], "[", "\[CapitalDelta]", "]"}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["x", "0"], "+", 
            RowBox[{"\[Gamma]", "*", "\[CapitalDelta]"}]}], ")"}], 
          SubscriptBox["w", "X0"]]], ")"}], 
       RowBox[{"1", "/", 
        SubscriptBox["w", "Y0"]}]], "-", 
      SubscriptBox["y", "0"]}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\)(\!\(\*SubscriptBox[\
\(\[CapitalDelta]\), \(X0\)]\)) = \>\"", ",", 
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "Y"], "[", 
      SubscriptBox["\[CapitalDelta]", "X0"], "]"}]}], "]"}], "\n", "\n", 
   RowBox[{"Print", "[", "\"\<The pool price after the swap is:\>\"", "]"}], 
   "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<P(\!\(\*SubscriptBox[\(x\), \(0\)]\)+\!\(\*SubscriptBox[\(\
\[CapitalDelta]\), \(X\)]\),\!\(\*SubscriptBox[\(y\), \
\(0\)]\)+\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\),\!\(\*SubscriptBox[\
\(t\), \(0\)]\)) = \>\"", ",", " ", 
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "0"], "+", 
        SubscriptBox["\[CapitalDelta]", "X0"]}], ",", 
       RowBox[{
        SubscriptBox["y", "0"], "+", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "Y"], "[", 
         SubscriptBox["\[CapitalDelta]", "X0"], "]"}]}], ",", 
       SubscriptBox["t", "0"]}], "]"}]}], "]"}], "\n", "\n", 
   RowBox[{"Print", "[", "\"\<The effective price paid is:\>\"", "]"}], "\n", 
   
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(P\), \(eff\)]\) = \>\"", ",", 
     FractionBox[
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "Y"], "[", 
        SubscriptBox["\[CapitalDelta]", "X0"], "]"}]}], 
      SubscriptBox["\[CapitalDelta]", "X0"]]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.909023485649941*^9, 3.909023554417844*^9}, {
  3.909023588654104*^9, 3.909023784038788*^9}, {3.909023838231306*^9, 
  3.909023869387912*^9}, {3.9090246712830353`*^9, 3.909025108548517*^9}, {
  3.9090255944786253`*^9, 3.909025629325931*^9}, {3.9090256951317863`*^9, 
  3.909025733231577*^9}, {3.90902578612426*^9, 3.909025880024002*^9}, {
  3.9090262116624937`*^9, 3.9090262678651943`*^9}, {3.909027524212573*^9, 
  3.909027733023752*^9}, {3.909027790141903*^9, 3.90902782483636*^9}, {
  3.909028048665339*^9, 3.90902812051196*^9}, {3.9090282482317467`*^9, 
  3.909028266710107*^9}, {3.9090283170031013`*^9, 3.909028317749967*^9}, {
  3.9090284404793262`*^9, 3.9090285676793823`*^9}, {3.909028747646686*^9, 
  3.909028759578367*^9}},
 CellLabel->
  "In[1979]:=",ExpressionUUID->"f1a7138d-bdd9-498d-831a-913e603831f5"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"To lower price from \\!\\(\\*SubscriptBox[\\(S\\), \\(0\\)]\\) \
= \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\" to \\!\\(\\*SubscriptBox[\\(S\\), \
\\(next\\)]\\) = \"\>", "\[InvisibleSpace]", "0.8`"}],
  SequenceForm[
  "To lower price from \!\(\*SubscriptBox[\(S\), \(0\)]\) = ", 1, 
   " to \!\(\*SubscriptBox[\(S\), \(next\)]\) = ", 0.8],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909023625590147*^9, 3.909023634459036*^9}, 
   3.909023673673493*^9, 3.9090237856711693`*^9, 3.9090248379910192`*^9, 
   3.909025001664439*^9, 3.909025735273368*^9, 3.909025791895224*^9, 
   3.909025880922803*^9, {3.90902617178374*^9, 3.909026183795624*^9}, 
   3.90902753895807*^9, 3.90902761381222*^9, {3.909027681108068*^9, 
   3.909027716308919*^9}, 3.909027826384385*^9, 3.909028046338876*^9, 
   3.909028099254758*^9, 3.909028162927443*^9, {3.9090282490879107`*^9, 
   3.909028267729203*^9}, 3.909028568926923*^9, 3.909028618643444*^9, 
   3.909028760100865*^9, 3.909031032472728*^9, 3.909031073875078*^9, {
   3.9090311057096157`*^9, 3.9090311181923323`*^9}, {3.909031275383518*^9, 
   3.909031338513184*^9}, {3.9090314108814907`*^9, 3.909031427244606*^9}, 
   3.909032100464244*^9, {3.909032171119351*^9, 3.909032249376775*^9}},
 CellLabel->
  "During evaluation of \
In[1979]:=",ExpressionUUID->"ba71b91a-28e1-4d9c-b322-15df5c4e26df"],

Cell[BoxData["\<\"After applying the fee, we will have the following X \
reinvested:\"\>"], "Print",
 CellChangeTimes->{{3.909023625590147*^9, 3.909023634459036*^9}, 
   3.909023673673493*^9, 3.9090237856711693`*^9, 3.9090248379910192`*^9, 
   3.909025001664439*^9, 3.909025735273368*^9, 3.909025791895224*^9, 
   3.909025880922803*^9, {3.90902617178374*^9, 3.909026183795624*^9}, 
   3.90902753895807*^9, 3.90902761381222*^9, {3.909027681108068*^9, 
   3.909027716308919*^9}, 3.909027826384385*^9, 3.909028046338876*^9, 
   3.909028099254758*^9, 3.909028162927443*^9, {3.9090282490879107`*^9, 
   3.909028267729203*^9}, 3.909028568926923*^9, 3.909028618643444*^9, 
   3.909028760100865*^9, 3.909031032472728*^9, 3.909031073875078*^9, {
   3.9090311057096157`*^9, 3.9090311181923323`*^9}, {3.909031275383518*^9, 
   3.909031338513184*^9}, {3.9090314108814907`*^9, 3.909031427244606*^9}, 
   3.909032100464244*^9, {3.909032171119351*^9, 3.909032249378049*^9}},
 CellLabel->
  "During evaluation of \
In[1979]:=",ExpressionUUID->"bbe7fa41-12eb-4df0-8d76-9a6de098e4cf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(X\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.000355167468655652`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(X\)]\) = ", 0.000355167468655652],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909023625590147*^9, 3.909023634459036*^9}, 
   3.909023673673493*^9, 3.9090237856711693`*^9, 3.9090248379910192`*^9, 
   3.909025001664439*^9, 3.909025735273368*^9, 3.909025791895224*^9, 
   3.909025880922803*^9, {3.90902617178374*^9, 3.909026183795624*^9}, 
   3.90902753895807*^9, 3.90902761381222*^9, {3.909027681108068*^9, 
   3.909027716308919*^9}, 3.909027826384385*^9, 3.909028046338876*^9, 
   3.909028099254758*^9, 3.909028162927443*^9, {3.9090282490879107`*^9, 
   3.909028267729203*^9}, 3.909028568926923*^9, 3.909028618643444*^9, 
   3.909028760100865*^9, 3.909031032472728*^9, 3.909031073875078*^9, {
   3.9090311057096157`*^9, 3.9090311181923323`*^9}, {3.909031275383518*^9, 
   3.909031338513184*^9}, {3.9090314108814907`*^9, 3.909031427244606*^9}, 
   3.909032100464244*^9, {3.909032171119351*^9, 3.909032249379071*^9}},
 CellLabel->
  "During evaluation of \
In[1979]:=",ExpressionUUID->"d57c0dda-683c-4f75-958b-6349b88ee415"],

Cell[BoxData["\<\"The change in liquidity will be:\"\>"], "Print",
 CellChangeTimes->{{3.909023625590147*^9, 3.909023634459036*^9}, 
   3.909023673673493*^9, 3.9090237856711693`*^9, 3.9090248379910192`*^9, 
   3.909025001664439*^9, 3.909025735273368*^9, 3.909025791895224*^9, 
   3.909025880922803*^9, {3.90902617178374*^9, 3.909026183795624*^9}, 
   3.90902753895807*^9, 3.90902761381222*^9, {3.909027681108068*^9, 
   3.909027716308919*^9}, 3.909027826384385*^9, 3.909028046338876*^9, 
   3.909028099254758*^9, 3.909028162927443*^9, {3.9090282490879107`*^9, 
   3.909028267729203*^9}, 3.909028568926923*^9, 3.909028618643444*^9, 
   3.909028760100865*^9, 3.909031032472728*^9, 3.909031073875078*^9, {
   3.9090311057096157`*^9, 3.9090311181923323`*^9}, {3.909031275383518*^9, 
   3.909031338513184*^9}, {3.9090314108814907`*^9, 3.909031427244606*^9}, 
   3.909032100464244*^9, {3.909032171119351*^9, 3.909032249379942*^9}},
 CellLabel->
  "During evaluation of \
In[1979]:=",ExpressionUUID->"0c4f7f03-8789-479d-90ae-3cd29d680409"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(L\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.000355167468655652`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = ", 0.000355167468655652],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909023625590147*^9, 3.909023634459036*^9}, 
   3.909023673673493*^9, 3.9090237856711693`*^9, 3.9090248379910192`*^9, 
   3.909025001664439*^9, 3.909025735273368*^9, 3.909025791895224*^9, 
   3.909025880922803*^9, {3.90902617178374*^9, 3.909026183795624*^9}, 
   3.90902753895807*^9, 3.90902761381222*^9, {3.909027681108068*^9, 
   3.909027716308919*^9}, 3.909027826384385*^9, 3.909028046338876*^9, 
   3.909028099254758*^9, 3.909028162927443*^9, {3.9090282490879107`*^9, 
   3.909028267729203*^9}, 3.909028568926923*^9, 3.909028618643444*^9, 
   3.909028760100865*^9, 3.909031032472728*^9, 3.909031073875078*^9, {
   3.9090311057096157`*^9, 3.9090311181923323`*^9}, {3.909031275383518*^9, 
   3.909031338513184*^9}, {3.9090314108814907`*^9, 3.909031427244606*^9}, 
   3.909032100464244*^9, {3.909032171119351*^9, 3.909032249380766*^9}},
 CellLabel->
  "During evaluation of \
In[1979]:=",ExpressionUUID->"47b005c0-e6d2-489d-ade4-a10d372e609c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"We must swap in \\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \
\\(X0\\)]\\) = \"\>", "\[InvisibleSpace]", "0.11838915621855055`"}],
  SequenceForm[
  "We must swap in \!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X0\)]\) = ", 
   0.11838915621855055`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909023625590147*^9, 3.909023634459036*^9}, 
   3.909023673673493*^9, 3.9090237856711693`*^9, 3.9090248379910192`*^9, 
   3.909025001664439*^9, 3.909025735273368*^9, 3.909025791895224*^9, 
   3.909025880922803*^9, {3.90902617178374*^9, 3.909026183795624*^9}, 
   3.90902753895807*^9, 3.90902761381222*^9, {3.909027681108068*^9, 
   3.909027716308919*^9}, 3.909027826384385*^9, 3.909028046338876*^9, 
   3.909028099254758*^9, 3.909028162927443*^9, {3.9090282490879107`*^9, 
   3.909028267729203*^9}, 3.909028568926923*^9, 3.909028618643444*^9, 
   3.909028760100865*^9, 3.909031032472728*^9, 3.909031073875078*^9, {
   3.9090311057096157`*^9, 3.9090311181923323`*^9}, {3.909031275383518*^9, 
   3.909031338513184*^9}, {3.9090314108814907`*^9, 3.909031427244606*^9}, 
   3.909032100464244*^9, {3.909032171119351*^9, 3.909032249381632*^9}},
 CellLabel->
  "During evaluation of \
In[1979]:=",ExpressionUUID->"81a35743-a2ee-4c47-ae59-e806b51d21fb"],

Cell[BoxData["\<\"Then we will get out:\"\>"], "Print",
 CellChangeTimes->{{3.909023625590147*^9, 3.909023634459036*^9}, 
   3.909023673673493*^9, 3.9090237856711693`*^9, 3.9090248379910192`*^9, 
   3.909025001664439*^9, 3.909025735273368*^9, 3.909025791895224*^9, 
   3.909025880922803*^9, {3.90902617178374*^9, 3.909026183795624*^9}, 
   3.90902753895807*^9, 3.90902761381222*^9, {3.909027681108068*^9, 
   3.909027716308919*^9}, 3.909027826384385*^9, 3.909028046338876*^9, 
   3.909028099254758*^9, 3.909028162927443*^9, {3.9090282490879107`*^9, 
   3.909028267729203*^9}, 3.909028568926923*^9, 3.909028618643444*^9, 
   3.909028760100865*^9, 3.909031032472728*^9, 3.909031073875078*^9, {
   3.9090311057096157`*^9, 3.9090311181923323`*^9}, {3.909031275383518*^9, 
   3.909031338513184*^9}, {3.9090314108814907`*^9, 3.909031427244606*^9}, 
   3.909032100464244*^9, {3.909032171119351*^9, 3.9090322493824863`*^9}},
 CellLabel->
  "During evaluation of \
In[1979]:=",ExpressionUUID->"9a08cb3d-3b45-443d-a3e6-3ac2214bc229"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \
\\(Y\\)]\\)(\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(X0\\)]\\)) = \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "0.10493735329087384`"}]}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\)(\!\(\*SubscriptBox[\(\
\[CapitalDelta]\), \(X0\)]\)) = ", -0.10493735329087384`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909023625590147*^9, 3.909023634459036*^9}, 
   3.909023673673493*^9, 3.9090237856711693`*^9, 3.9090248379910192`*^9, 
   3.909025001664439*^9, 3.909025735273368*^9, 3.909025791895224*^9, 
   3.909025880922803*^9, {3.90902617178374*^9, 3.909026183795624*^9}, 
   3.90902753895807*^9, 3.90902761381222*^9, {3.909027681108068*^9, 
   3.909027716308919*^9}, 3.909027826384385*^9, 3.909028046338876*^9, 
   3.909028099254758*^9, 3.909028162927443*^9, {3.9090282490879107`*^9, 
   3.909028267729203*^9}, 3.909028568926923*^9, 3.909028618643444*^9, 
   3.909028760100865*^9, 3.909031032472728*^9, 3.909031073875078*^9, {
   3.9090311057096157`*^9, 3.9090311181923323`*^9}, {3.909031275383518*^9, 
   3.909031338513184*^9}, {3.9090314108814907`*^9, 3.909031427244606*^9}, 
   3.909032100464244*^9, {3.909032171119351*^9, 3.909032249383296*^9}},
 CellLabel->
  "During evaluation of \
In[1979]:=",ExpressionUUID->"f039eaa6-f959-484d-a013-15584a002dd0"],

Cell[BoxData["\<\"The pool price after the swap is:\"\>"], "Print",
 CellChangeTimes->{{3.909023625590147*^9, 3.909023634459036*^9}, 
   3.909023673673493*^9, 3.9090237856711693`*^9, 3.9090248379910192`*^9, 
   3.909025001664439*^9, 3.909025735273368*^9, 3.909025791895224*^9, 
   3.909025880922803*^9, {3.90902617178374*^9, 3.909026183795624*^9}, 
   3.90902753895807*^9, 3.90902761381222*^9, {3.909027681108068*^9, 
   3.909027716308919*^9}, 3.909027826384385*^9, 3.909028046338876*^9, 
   3.909028099254758*^9, 3.909028162927443*^9, {3.9090282490879107`*^9, 
   3.909028267729203*^9}, 3.909028568926923*^9, 3.909028618643444*^9, 
   3.909028760100865*^9, 3.909031032472728*^9, 3.909031073875078*^9, {
   3.9090311057096157`*^9, 3.9090311181923323`*^9}, {3.909031275383518*^9, 
   3.909031338513184*^9}, {3.9090314108814907`*^9, 3.909031427244606*^9}, 
   3.909032100464244*^9, {3.909032171119351*^9, 3.909032249384199*^9}},
 CellLabel->
  "During evaluation of \
In[1979]:=",ExpressionUUID->"b283c890-1629-4ae8-94b4-e692e97001d3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"P(\\!\\(\\*SubscriptBox[\\(x\\), \
\\(0\\)]\\)+\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \
\\(X\\)]\\),\\!\\(\\*SubscriptBox[\\(y\\), \\(0\\)]\\)+\\!\\(\\*SubscriptBox[\
\\(\[CapitalDelta]\\), \\(Y\\)]\\),\\!\\(\\*SubscriptBox[\\(t\\), \
\\(0\\)]\\)) = \"\>", "\[InvisibleSpace]", "0.8003141319211942`"}],
  SequenceForm[
  "P(\!\(\*SubscriptBox[\(x\), \
\(0\)]\)+\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(X\)]\),\!\(\*SubscriptBox[\
\(y\), \(0\)]\)+\!\(\*SubscriptBox[\(\[CapitalDelta]\), \
\(Y\)]\),\!\(\*SubscriptBox[\(t\), \(0\)]\)) = ", 0.8003141319211942],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909023625590147*^9, 3.909023634459036*^9}, 
   3.909023673673493*^9, 3.9090237856711693`*^9, 3.9090248379910192`*^9, 
   3.909025001664439*^9, 3.909025735273368*^9, 3.909025791895224*^9, 
   3.909025880922803*^9, {3.90902617178374*^9, 3.909026183795624*^9}, 
   3.90902753895807*^9, 3.90902761381222*^9, {3.909027681108068*^9, 
   3.909027716308919*^9}, 3.909027826384385*^9, 3.909028046338876*^9, 
   3.909028099254758*^9, 3.909028162927443*^9, {3.9090282490879107`*^9, 
   3.909028267729203*^9}, 3.909028568926923*^9, 3.909028618643444*^9, 
   3.909028760100865*^9, 3.909031032472728*^9, 3.909031073875078*^9, {
   3.9090311057096157`*^9, 3.9090311181923323`*^9}, {3.909031275383518*^9, 
   3.909031338513184*^9}, {3.9090314108814907`*^9, 3.909031427244606*^9}, 
   3.909032100464244*^9, {3.909032171119351*^9, 3.909032249385037*^9}},
 CellLabel->
  "During evaluation of \
In[1979]:=",ExpressionUUID->"7681da45-4bea-40b3-8ce6-cee35a5d8ae8"],

Cell[BoxData["\<\"The effective price paid is:\"\>"], "Print",
 CellChangeTimes->{{3.909023625590147*^9, 3.909023634459036*^9}, 
   3.909023673673493*^9, 3.9090237856711693`*^9, 3.9090248379910192`*^9, 
   3.909025001664439*^9, 3.909025735273368*^9, 3.909025791895224*^9, 
   3.909025880922803*^9, {3.90902617178374*^9, 3.909026183795624*^9}, 
   3.90902753895807*^9, 3.90902761381222*^9, {3.909027681108068*^9, 
   3.909027716308919*^9}, 3.909027826384385*^9, 3.909028046338876*^9, 
   3.909028099254758*^9, 3.909028162927443*^9, {3.9090282490879107`*^9, 
   3.909028267729203*^9}, 3.909028568926923*^9, 3.909028618643444*^9, 
   3.909028760100865*^9, 3.909031032472728*^9, 3.909031073875078*^9, {
   3.9090311057096157`*^9, 3.9090311181923323`*^9}, {3.909031275383518*^9, 
   3.909031338513184*^9}, {3.9090314108814907`*^9, 3.909031427244606*^9}, 
   3.909032100464244*^9, {3.909032171119351*^9, 3.909032249386002*^9}},
 CellLabel->
  "During evaluation of \
In[1979]:=",ExpressionUUID->"752789c6-221c-4165-a0df-459b4faa9b61"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(P\\), \\(eff\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.886376393266591`"}],
  SequenceForm["\!\(\*SubscriptBox[\(P\), \(eff\)]\) = ", 0.886376393266591],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909023625590147*^9, 3.909023634459036*^9}, 
   3.909023673673493*^9, 3.9090237856711693`*^9, 3.9090248379910192`*^9, 
   3.909025001664439*^9, 3.909025735273368*^9, 3.909025791895224*^9, 
   3.909025880922803*^9, {3.90902617178374*^9, 3.909026183795624*^9}, 
   3.90902753895807*^9, 3.90902761381222*^9, {3.909027681108068*^9, 
   3.909027716308919*^9}, 3.909027826384385*^9, 3.909028046338876*^9, 
   3.909028099254758*^9, 3.909028162927443*^9, {3.9090282490879107`*^9, 
   3.909028267729203*^9}, 3.909028568926923*^9, 3.909028618643444*^9, 
   3.909028760100865*^9, 3.909031032472728*^9, 3.909031073875078*^9, {
   3.9090311057096157`*^9, 3.9090311181923323`*^9}, {3.909031275383518*^9, 
   3.909031338513184*^9}, {3.9090314108814907`*^9, 3.909031427244606*^9}, 
   3.909032100464244*^9, {3.909032171119351*^9, 3.9090322493868103`*^9}},
 CellLabel->
  "During evaluation of \
In[1979]:=",ExpressionUUID->"ea78d690-dd45-401e-a2d2-6ab45dc875dd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Now", " ", "tender", " ", "Y"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["S", "nextY"], ":=", "1.2"}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<To lower price from \!\(\*SubscriptBox[\(S\), \(0\)]\) = \>\"", ",", 
     " ", 
     SubscriptBox["S", "0"], ",", " ", 
     "\"\< to \!\(\*SubscriptBox[\(S\), \(next\)]\) = \>\"", ",", " ", 
     SubscriptBox["S", "nextX"]}], "]"}], "\n", 
   RowBox[{
    SubscriptBox["\[CapitalDelta]", "Y0"], ":=", 
    RowBox[{"arbY", "[", 
     RowBox[{
      SubscriptBox["S", "nextY"], ",", 
      SubscriptBox["y", "0"], ",", 
      SubscriptBox["L", "0"]}], "]"}]}], "\n", 
   RowBox[{
   "Print", "[", 
    "\"\<After applying the fee, we will have the following Y \
reinvested:\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Yy"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Gamma]"}], ")"}], "*", "\[CapitalDelta]"}]}], 
    ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = \>\"", ",", 
     RowBox[{
      SubscriptBox["\[Delta]", "Yy"], "[", 
      SubscriptBox["\[CapitalDelta]", "Y0"], "]"}]}], "]"}], "\n", 
   RowBox[{"Print", "[", "\"\<The change in liquidity will be:\>\"", "]"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Delta]", "Ly"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     " ", 
     RowBox[{
      SubscriptBox["L", "Y"], "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Delta]", "Yy"], "[", "\[CapitalDelta]", "]"}], ",", 
       SubscriptBox["S", "0"], ",", "0"}], "]"}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = \>\"", ",", " ", 
     RowBox[{
      SubscriptBox["\[Delta]", "Ly"], "[", 
      SubscriptBox["\[CapitalDelta]", "Y0"], "]"}]}], "]"}], "\n", "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<We must swap in \!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y0\)]\) = \
\>\"", ",", " ", 
     SubscriptBox["\[CapitalDelta]", "Y0"]}], "]"}], "\n", 
   RowBox[{"Print", "[", "\"\<Then we will get out:\>\"", "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "X"], "[", "\[CapitalDelta]_", "]"}], ":=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          SubscriptBox["L", "0"], "+", 
          RowBox[{
           SubscriptBox["\[Delta]", "Ly"], "[", "\[CapitalDelta]", "]"}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["y", "0"], "+", 
            RowBox[{"\[Gamma]", "*", "\[CapitalDelta]"}]}], ")"}], 
          SubscriptBox["w", "Y0"]]], ")"}], 
       RowBox[{"1", "/", 
        SubscriptBox["w", "X0"]}]], "-", 
      SubscriptBox["x", "0"]}]}], ";"}], "\n", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\)(\!\(\*SubscriptBox[\
\(\[CapitalDelta]\), \(X0\)]\)) = \>\"", ",", 
     RowBox[{
      SubscriptBox["\[CapitalDelta]", "X"], "[", 
      SubscriptBox["\[CapitalDelta]", "Y0"], "]"}]}], "]"}], "\n", "\n", 
   RowBox[{"Print", "[", "\"\<The effective price paid is:\>\"", "]"}], "\n", 
   
   RowBox[{"Print", "[", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(P\), \(eff\)]\) = \>\"", ",", 
     FractionBox[
      SubscriptBox["\[CapitalDelta]", "Y0"], 
      RowBox[{"-", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "X"], "[", 
        SubscriptBox["\[CapitalDelta]", "Y0"], "]"}]}]]}], "]"}]}]}]], "Code",\

 CellChangeTimes->{{3.909028107185556*^9, 3.909028117295044*^9}, {
  3.909028240676588*^9, 3.909028413755548*^9}},
 CellLabel->
  "In[1537]:=",ExpressionUUID->"b433b1f5-921d-42a6-a443-5a4803a9a613"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"To lower price from \\!\\(\\*SubscriptBox[\\(S\\), \\(0\\)]\\) \
= \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\" to \\!\\(\\*SubscriptBox[\\(S\\), \
\\(next\\)]\\) = \"\>", "\[InvisibleSpace]", "0.8`"}],
  SequenceForm[
  "To lower price from \!\(\*SubscriptBox[\(S\), \(0\)]\) = ", 1, 
   " to \!\(\*SubscriptBox[\(S\), \(next\)]\) = ", 0.8],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909028407971368*^9, 3.909028414314933*^9}},
 CellLabel->
  "During evaluation of \
In[1537]:=",ExpressionUUID->"cf6d6dd0-61e0-41c3-a6d0-147ce57daff2"],

Cell[BoxData["\<\"After applying the fee, we will have the following Y \
reinvested:\"\>"], "Print",
 CellChangeTimes->{{3.909028407971368*^9, 3.909028414316236*^9}},
 CellLabel->
  "During evaluation of \
In[1537]:=",ExpressionUUID->"c2f68b67-3c08-4084-9ae4-c2756a00ef7d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(Y\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.0002863353450309967`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(Y\)]\) = ", 0.0002863353450309967],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909028407971368*^9, 3.909028414317347*^9}},
 CellLabel->
  "During evaluation of \
In[1537]:=",ExpressionUUID->"31ee56fd-f64c-4bdf-8258-4bae261cda8b"],

Cell[BoxData["\<\"The change in liquidity will be:\"\>"], "Print",
 CellChangeTimes->{{3.909028407971368*^9, 3.909028414318323*^9}},
 CellLabel->
  "During evaluation of \
In[1537]:=",ExpressionUUID->"27951f22-a8f4-4b49-8bca-3fda152bcd3d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Delta]\\), \\(L\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "0.0002863353450309967`"}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[Delta]\), \(L\)]\) = ", 0.0002863353450309967],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909028407971368*^9, 3.90902841431921*^9}},
 CellLabel->
  "During evaluation of \
In[1537]:=",ExpressionUUID->"cc9ae62e-093d-42d6-a557-2a1f953555c0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"We must swap in \\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \
\\(Y0\\)]\\) = \"\>", "\[InvisibleSpace]", "0.09544511501033215`"}],
  SequenceForm[
  "We must swap in \!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y0\)]\) = ", 
   0.09544511501033215],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909028407971368*^9, 3.909028414320159*^9}},
 CellLabel->
  "During evaluation of \
In[1537]:=",ExpressionUUID->"829b8bdc-26d5-4727-a115-0c32b6f841a1"],

Cell[BoxData["\<\"Then we will get out:\"\>"], "Print",
 CellChangeTimes->{{3.909028407971368*^9, 3.9090284143210983`*^9}},
 CellLabel->
  "During evaluation of \
In[1537]:=",ExpressionUUID->"49e1ba96-5699-4f0f-9d30-b09667b24096"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \
\\(Y\\)]\\)(\\!\\(\\*SubscriptBox[\\(\[CapitalDelta]\\), \\(X0\\)]\\)) = \
\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "0.08636740967936729`"}]}],
  SequenceForm[
  "\!\(\*SubscriptBox[\(\[CapitalDelta]\), \(Y\)]\)(\!\(\*SubscriptBox[\(\
\[CapitalDelta]\), \(X0\)]\)) = ", -0.08636740967936729],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909028407971368*^9, 3.909028414322*^9}},
 CellLabel->
  "During evaluation of \
In[1537]:=",ExpressionUUID->"861eb9fe-6b4d-4347-b0ea-16fc5c4d476a"],

Cell[BoxData["\<\"The effective price paid is:\"\>"], "Print",
 CellChangeTimes->{{3.909028407971368*^9, 3.909028414323015*^9}},
 CellLabel->
  "During evaluation of \
In[1537]:=",ExpressionUUID->"cc520117-0eee-42e1-aba5-6f49d0532ed0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(P\\), \\(eff\\)]\\) = \"\>", 
   "\[InvisibleSpace]", "1.10510568007846`"}],
  SequenceForm["\!\(\*SubscriptBox[\(P\), \(eff\)]\) = ", 1.10510568007846],
  Editable->False]], "Print",
 CellChangeTimes->{{3.909028407971368*^9, 3.909028414323927*^9}},
 CellLabel->
  "During evaluation of \
In[1537]:=",ExpressionUUID->"6bc3ad6d-f8d8-4f88-a6f7-7c7f1e18f609"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox[
  RowBox[{"-", 
   SubscriptBox["w", "X0"]}], 
  SubscriptBox["w", "Y0"]]], "Code",
 CellChangeTimes->{{3.9090294466331167`*^9, 
  3.909029559941733*^9}},ExpressionUUID->"978efd4e-335a-4fb5-9dbc-\
848cf584a987"],

Cell[BoxData[
 RowBox[{"-", "1.`"}]], "Output",
 CellChangeTimes->{3.9090294904103622`*^9, 3.90902952980698*^9},
 CellLabel->
  "Out[1644]=",ExpressionUUID->"444b7e27-c175-4239-8db9-2f183f8bdf9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  FractionBox["1", 
   RowBox[{"1", "+", 
    RowBox[{"a", "/", "b"}], "-", "a"}]], "]"}]], "Code",
 CellChangeTimes->{{3.909030823434169*^9, 3.909030868306538*^9}},
 CellLabel->
  "In[1645]:=",ExpressionUUID->"e5372a67-9ed5-42fa-8206-995e29eda362"],

Cell[BoxData[
 FractionBox["b", 
  RowBox[{"a", "+", "b", "-", 
   RowBox[{"a", " ", "b"}]}]]], "Output",
 CellChangeTimes->{3.909030868703977*^9},
 CellLabel->
  "Out[1645]=",ExpressionUUID->"7cae8f48-69d3-465b-8d01-5d31d4878768"]
}, Open  ]]
},
WindowSize->{780, 1233},
WindowMargins->{{Automatic, 12}, {Automatic, 12}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 31, 2023)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "Users", "colin", 
   "Documents"}, "DarkMode.nb", CharacterEncoding -> "UTF-8"],
ExpressionUUID->"ad9da185-af22-4988-9267-9b210caaebc0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 1708, 47, 288, "Code",ExpressionUUID->"b2c3eb13-7d03-414e-8c7f-9b7f586d0f14"],
Cell[2272, 69, 1483, 46, 161, "Code",ExpressionUUID->"f9fb63cc-a717-46fa-82f5-c9fe272a7a74"],
Cell[CellGroupData[{
Cell[3780, 119, 873, 23, 110, "Code",ExpressionUUID->"ed65588f-4a47-4e8e-b018-b05cf18d9036"],
Cell[CellGroupData[{
Cell[4678, 146, 410, 9, 31, "Print",ExpressionUUID->"9d838419-17a4-4531-9f10-226ad8f68bd5"],
Cell[5091, 157, 410, 9, 31, "Print",ExpressionUUID->"74d27c34-5927-40ef-855f-c9190fd6803b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5550, 172, 578, 14, 110, "Code",ExpressionUUID->"11a592e2-9623-49b0-bc2b-483c8894c5e3"],
Cell[CellGroupData[{
Cell[6153, 190, 337, 6, 31, "Print",ExpressionUUID->"efc0aae8-7362-46f7-a9af-f11e87ea5d8b"],
Cell[6493, 198, 444, 10, 31, "Print",ExpressionUUID->"7fb7c0d2-49ca-41ef-8128-26a4bfec6ce2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6986, 214, 2996, 77, 604, "Code",ExpressionUUID->"d8460225-c2d1-439c-a0be-cebd189603df"],
Cell[CellGroupData[{
Cell[10007, 295, 380, 7, 31, "Print",ExpressionUUID->"1a8569be-6fb6-43a0-bfc4-26c2c17575e8"],
Cell[10390, 304, 549, 12, 31, "Print",ExpressionUUID->"65866cc6-8e4c-49bd-b209-35106212b5a2"],
Cell[10942, 318, 549, 12, 31, "Print",ExpressionUUID->"eebc4482-69ae-43c0-b1e9-2c6c74caac02"],
Cell[11494, 332, 542, 12, 31, "Print",ExpressionUUID->"a9385fcb-8e79-423f-9a08-01ecb8120a07"],
Cell[12039, 346, 542, 12, 31, "Print",ExpressionUUID->"3073bc55-df85-4e15-875d-de047a8c500d"],
Cell[12584, 360, 381, 7, 31, "Print",ExpressionUUID->"105ed2ea-0dbd-49f6-a031-3b1d7c074f7d"],
Cell[12968, 369, 545, 12, 31, "Print",ExpressionUUID->"0862faa2-3557-42fa-9645-ed7f5585d2be"],
Cell[13516, 383, 381, 7, 31, "Print",ExpressionUUID->"cbc9e66f-61b9-475b-b519-8972a421f159"],
Cell[13900, 392, 545, 12, 31, "Print",ExpressionUUID->"12a3d6ba-2e66-4dfc-9b8f-d14c5f97a353"]
}, Open  ]]
}, Open  ]],
Cell[14472, 408, 1979, 51, 181, "Code",ExpressionUUID->"32951f98-a51e-4d59-a510-81f1ce18a5b0"],
Cell[CellGroupData[{
Cell[16476, 463, 5377, 135, 652, "Code",ExpressionUUID->"f1a7138d-bdd9-498d-831a-913e603831f5"],
Cell[CellGroupData[{
Cell[21878, 602, 1406, 24, 31, "Print",ExpressionUUID->"ba71b91a-28e1-4d9c-b322-15df5c4e26df"],
Cell[23287, 628, 1066, 16, 31, "Print",ExpressionUUID->"bbe7fa41-12eb-4df0-8d76-9a6de098e4cf"],
Cell[24356, 646, 1244, 21, 31, "Print",ExpressionUUID->"d57c0dda-683c-4f75-958b-6349b88ee415"],
Cell[25603, 669, 1032, 15, 31, "Print",ExpressionUUID->"0c4f7f03-8789-479d-90ae-3cd29d680409"],
Cell[26638, 686, 1244, 21, 31, "Print",ExpressionUUID->"47b005c0-e6d2-489d-ade4-a10d372e609c"],
Cell[27885, 709, 1293, 22, 31, "Print",ExpressionUUID->"81a35743-a2ee-4c47-ae59-e806b51d21fb"],
Cell[29181, 733, 1023, 15, 31, "Print",ExpressionUUID->"9a08cb3d-3b45-443d-a3e6-3ac2214bc229"],
Cell[30207, 750, 1389, 24, 31, "Print",ExpressionUUID->"f039eaa6-f959-484d-a013-15584a002dd0"],
Cell[31599, 776, 1033, 15, 31, "Print",ExpressionUUID->"b283c890-1629-4ae8-94b4-e692e97001d3"],
Cell[32635, 793, 1610, 27, 31, "Print",ExpressionUUID->"7681da45-4bea-40b3-8ce6-cee35a5d8ae8"],
Cell[34248, 822, 1028, 15, 31, "Print",ExpressionUUID->"752789c6-221c-4165-a0df-459b4faa9b61"],
Cell[35279, 839, 1227, 20, 31, "Print",ExpressionUUID->"ea78d690-dd45-401e-a2d2-6ab45dc875dd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36555, 865, 3874, 106, 557, "Code",ExpressionUUID->"b433b1f5-921d-42a6-a443-5a4803a9a613"],
Cell[CellGroupData[{
Cell[40454, 975, 613, 13, 31, "Print",ExpressionUUID->"cf6d6dd0-61e0-41c3-a6d0-147ce57daff2"],
Cell[41070, 990, 273, 5, 31, "Print",ExpressionUUID->"c2f68b67-3c08-4084-9ae4-c2756a00ef7d"],
Cell[41346, 997, 453, 10, 31, "Print",ExpressionUUID->"31ee56fd-f64c-4bdf-8258-4bae261cda8b"],
Cell[41802, 1009, 239, 4, 31, "Print",ExpressionUUID->"27951f22-a8f4-4b49-8bca-3fda152bcd3d"],
Cell[42044, 1015, 452, 10, 31, "Print",ExpressionUUID->"cc9ae62e-093d-42d6-a557-2a1f953555c0"],
Cell[42499, 1027, 499, 11, 31, "Print",ExpressionUUID->"829b8bdc-26d5-4727-a115-0c32b6f841a1"],
Cell[43001, 1040, 230, 4, 31, "Print",ExpressionUUID->"49e1ba96-5699-4f0f-9d30-b09667b24096"],
Cell[43234, 1046, 592, 13, 31, "Print",ExpressionUUID->"861eb9fe-6b4d-4347-b0ea-16fc5c4d476a"],
Cell[43829, 1061, 235, 4, 31, "Print",ExpressionUUID->"cc520117-0eee-42e1-aba5-6f49d0532ed0"],
Cell[44067, 1067, 430, 9, 31, "Print",ExpressionUUID->"6bc3ad6d-f8d8-4f88-a6f7-7c7f1e18f609"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44546, 1082, 239, 7, 60, "Code",ExpressionUUID->"978efd4e-335a-4fb5-9dbc-848cf584a987"],
Cell[44788, 1091, 196, 4, 47, "Output",ExpressionUUID->"444b7e27-c175-4239-8db9-2f183f8bdf9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45021, 1100, 294, 7, 75, "Code",ExpressionUUID->"e5372a67-9ed5-42fa-8206-995e29eda362"],
Cell[45318, 1109, 231, 6, 66, "Output",ExpressionUUID->"7cae8f48-69d3-465b-8d01-5d31d4878768"]
}, Open  ]]
}
]
*)

