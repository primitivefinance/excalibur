#!/bin/sh
#
# This hook was set by cargo-husky v1.5.0: https://github.com/rhysd/cargo-husky#readme
# Generated by script /Users/shufflebottomhogwood/.cargo/registry/src/index.crates.io-6f17d22bba15001f/cargo-husky-1.5.0/build.rs
# Output at /Users/shufflebottomhogwood/Code/excalibur/target/debug/build/cargo-husky-f07c66896bec186c/out
#

set -e
# fmt
echo '+cargo +nightly fmt --all'
cargo +nightly fmt --all

# Enforcing Angular commit style
# I was having trouble gitting the regex to work, so I just commented it out for now
# commit_message=$(git log -1 --pretty=%B)
# if ! echo "$commit_message" | grep -qE '^(build|chore|ci|docs|feat|fix|perf|refactor|revert|style|test)(\([a-zA-Z0-9_]*\))?: .*'
# then
#     echo 'error: invalid commit message format.'
#     echo 'Please follow the Angular commit message style.'
#     echo 'Format: type(scope?): subject'
#     echo 'Example: fix(server): fix login issue'
#     exit 1
# else
#     echo 'Commit message format is valid.'
# fi

# No commiting to main
if [ "$(git symbolic-ref --short HEAD)" = "main" ]; then
    echo 'error: you are trying to commit to main, which is not allowed.'
    exit 1
fi